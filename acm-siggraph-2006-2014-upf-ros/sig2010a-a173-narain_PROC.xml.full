{
  "uri" : "sig2010a-a173-narain_PROC.xml",
  "url" : "/Users/cbadenes/Documents/OEG/Projects/DrInventor/datasets/acm-siggraph-2006-2014-upf/sig2010a/a173-narain_PROC.xml",
  "source" : {
    "name" : "SIGGRAPH",
    "uri" : "http://drinventor/SIGGRAPH",
    "url" : "http://drinventor/SIGGRAPH",
    "protocol" : "http"
  },
  "metainformation" : {
    "title" : "Free-Flowing Granular Materials with Two-Way Solid Coupling",
    "published" : "2010",
    "format" : "pdf",
    "language" : "en",
    "rights" : "GPLv2",
    "description" : "",
    "creators" : [ {
      "uri" : "http://drinventor/Rahul-Narain",
      "name" : "Rahul",
      "surname" : "Narain"
    }, {
      "uri" : "http://drinventor/Abhinav-Golas",
      "name" : "Abhinav",
      "surname" : "Golas"
    }, {
      "uri" : "http://drinventor/Ming C.-Lin",
      "name" : "Ming C.",
      "surname" : "Lin"
    } ]
  },
  "bagOfWords" : [ "bbd4d672998afb980ad7f2dc6975c64117b1ac524a3d0360205cb34c06b187b3", "oyb", "10.1145", "1866158.1866195", "name", "identification", "possible", "free-flowing", "Granular", "Materials", "Two-Way", "Solid", "coupling", "Rahul", "Narain", "Abhinav", "Golas", "Figure", "explosion", "go", "off", "inside", "sand", "pile", "send", "freely", "splash", "sand", "rigid", "body", "fly", "air", "-lrb-", "run", "less", "than", "20", "seconds", "per", "frame", "single-processor", "pc", "-rrb-", "scenario", "sand", "need", "model", "cohesionless", "granular", "material", "we", "present", "novel", "continuum-based", "model", "enable", "efficient", "simulation", "granular", "material", "we", "approach", "fully", "solve", "internal", "pressure", "frictional", "stress", "granular", "material", "thereby", "allow", "visually", "noticeable", "behavior", "granular", "material", "reproduce", "include", "freely", "disperse", "splash", "without", "cohesion", "global", "coupling", "between", "friction", "pressure", "full", "treatment", "internal", "force", "material", "also", "enable", "two-way", "interaction", "solid", "body", "we", "method", "achieve", "result", "only", "very", "small", "fraction", "computational", "cost", "comparable", "particle-based", "model", "granular", "flow", "cr", "category", "i.", "3.5", "-lsb-", "Computer", "Graphics", "-rsb-", "computational", "geometry", "object", "modeling?physically", "base", "modeling", "i.", "3.7", "-lsb-", "Computer", "Graphics", "-rsb-", "three-dimensional", "graphic", "realism", "animation", "keyword", "sand", "granular", "material", "simulation", "animation", "introduction", "granular", "material", "sand", "powder", "cereal", "grain", "gravel", "commonplace", "physical", "world", "around", "we", "be", "compose", "very", "large", "number", "mesoscopic", "grain", "show", "unique", "physical", "behavior", "unlike", "other", "material", "fluid", "deformable", "body", "which", "have", "be", "well", "study", "computer", "graphic", "particular", "granular", "material", "disperse", "freely", "free", "fall", "flow", "plastically", "under", "force", "yet", "settle", "stable", "pile", "e-mail", "-lcb-", "narain", "gola", "lin", "-rcb-", "@cs", "unc.edu", "ACM", "Reference", "Format", "Narain", "R.", "Golas", "a.", "Lin", "M.", "2010", "free-flowing", "Granular", "Materials", "Two-Way", "Solid", "coupling", "ACM", "Trans", "graph", "29", "Article", "173", "-lrb-", "December", "2010", "-rrb-", "page", "dous", "10.1145", "1866158.1866195", "http://doi.acm.org/10.1145/1866158.1866195", "copyright", "Notice", "permission", "make", "digital", "hard", "copy", "part", "all", "work", "personal", "classroom", "use", "grant", "without", "fee", "provide", "copy", "make", "distribute", "profit", "direct", "commercial", "advantage", "copy", "show", "notice", "fus", "rst", "page", "initial", "screen", "display", "along", "full", "citation", "copyright", "component", "work", "own", "other", "than", "ACM", "must", "honor", "abstract", "credit", "permit", "copy", "otherwise", "republish", "post", "server", "redistribute", "list", "use", "any", "component", "work", "other", "work", "require", "prior", "specific", "permission", "and/or", "fee", "permission", "may", "request", "from", "Publications", "Dept.", "ACM", "Inc.", "Penn", "Plaza", "Suite", "701", "New", "York", "NY", "10121-0701", "fax", "+1", "-lrb-212-rrb-Â 869-0481", "permissions@acm.org", "2010", "ACM", "0730-0301/2010", "12-art173", "10.00", "DOI", "10.1145", "1866158.1866195", "http://doi.acm.org/10.1145/1866158.1866195", "Ming", "C.", "Lin", "physical", "behavior", "material", "arise", "from", "interplay", "contact", "frictional", "force", "between", "thousand", "million", "tiny", "grain", "simulate", "motion", "each", "grain", "computationally", "prohibitive", "large-scale", "scenario", "fine-grained", "material", "like", "sand", "we", "instead", "take", "continuum", "approach", "treat", "granular", "material", "continuous", "fluid", "continuum-based", "approach", "have", "many", "advantage", "include", "efficient", "numerical", "method", "due", "regular", "computational", "domain", "ability", "user", "choose", "resolution", "simulation", "trade-off", "between", "performance", "quality", "order", "capture", "unique", "behavior", "material", "exhibit", "we", "depart", "significantly", "from", "traditional", "fluid", "simulation", "technique", "firstly", "allow", "material", "disperse", "freely", "when", "agitate", "maintain", "its", "volume", "when", "rest", "we", "replace", "exist", "fluid-based", "model?s", "assumption", "incompressibility", "unilateral", "variational", "constraint", "secondly", "unlike", "fluid", "viscosity", "friction", "granular", "material", "can", "counteract", "gravity", "maintain", "stable", "pile", "equilibrium", "require", "solve", "internal", "stress", "global", "fashion", "we", "present", "efficient", "method", "numerical", "problem", "permit", "appropriate", "frictional", "behavior", "solid", "body", "interaction", "granular", "material", "have", "receive", "much", "attention", "field", "geomechanic", "engineering", "computational", "physics", "be", "distinctive", "form", "matter", "exhibit", "behavior", "rather", "different", "from", "ordinary", "solid", "liquid", "gas", "-lsb-", "Behringer", "et", "al.", "1999", "-rsb-", "granular", "material", "show", "surprisingly", "complex", "behavior", "still", "be", "study", "physics", "engineering", "community", "due", "central", "role", "friction", "dissipative", "nature", "inelastic", "contact", "interaction", "granular", "flow", "resist", "analysis", "traditional", "approach", "statistical", "mechanic", "describe", "continuum", "model", "which", "abstract", "over", "individual", "grain", "interaction", "continue", "topic", "active", "research", "visual", "application", "however", "use", "simplify", "continuum", "model", "only", "treat", "more", "common", "phase", "granular", "flow", "can", "still", "give", "very", "convincing", "result", "demonstrate", "Zhu", "Bridson", "-lsb-", "2005", "-rsb-", "who", "model", "sand", "incompressible", "fluid", "add", "frictional", "force", "traditional", "fluid", "simulator", "approach", "rely", "identify", "rigidly", "move", "region", "ma", "terial", "obtain", "stable", "pile", "Lenaerts", "Dutr", "-lsb-", "2009", "-rsb-", "adapt", "method", "setting", "smooth", "particle", "hydrodynamic", "-lrb-", "sph", "-rrb-", "also", "enable", "simulate", "sand-water", "interaction", "setting", "incompressibility", "assumption", "however", "can", "lead", "undesirable", "cohesive", "behavior", "know", "rigidification", "approach", "friction", "support", "two-way", "coupling", "solid", "body", "soil", "mechanic", "continuum-based", "approach", "have", "also", "be", "employ", "study", "large-scale", "phenomenon", "avalanche", "landslide", "-lsb-", "aranson", "tsimr", "2001", "Quecedo", "et", "al.", "2004", "Josserand", "et", "al.", "2004", "-rsb-", "another", "natural", "method", "animate", "granular", "material", "directly", "simulate", "interaction", "between", "individual", "grain", "include", "class", "discrete", "element", "method", "use", "engineering", "application", "-lsb-", "bi?ani", "2004", "-rsb-", "graphic", "Luciani", "et", "al.", "-lsb-", "1995", "-rsb-", "develop", "particle", "system", "model", "granular", "material", "use", "damp", "spring", "force", "Bell", "et", "al.", "-lsb-", "2005", "-rsb-", "use", "molecular", "dynamics", "method", "while", "modeling", "grain", "rigid", "compound", "sphere", "exhibit", "compelling", "behavior", "two-way", "solid", "body", "interaction", "however", "discrete", "method", "incur", "heavy", "computational", "expense", "model", "fine-grained", "material", "due", "sheer", "number", "particle", "must", "resolve", "issue", "address", "part", "Aldu?n", "et", "al.", "-lsb-", "2009", "-rsb-", "who", "propose", "post-processing", "step", "interpolate", "fine", "grain", "over", "coarser", "discrete", "simulation", "we", "briefly", "survey", "some", "other", "approach", "have", "be", "take", "modeling", "granular", "material", "computer", "graphic", "some", "earliest", "work", "use", "particle", "system", "heuristic", "inter-particle", "force", "give", "fluid-like", "sand-like", "behavior", "-lsb-", "Miller", "Pearce", "1989", "Luciani", "et", "al.", "1995", "-rsb-", "sand", "have", "also", "be", "model", "use", "height", "field", "-lsb-", "Li", "Moshell", "1993", "Chanclou", "et", "al.", "1996", "-rsb-", "several", "extension", "have", "be", "propose", "modeling", "footprint", "track", "-lsb-", "Sumner", "et", "al.", "1999", "-rsb-", "use", "multi-valued", "height", "field", "some", "3d", "effect", "-lsb-", "Onoue", "Nishita", "2003", "-rsb-", "combine", "flow", "surface", "layer", "compose", "particle", "-lsb-", "Zhu", "Yang", "2010", "-rsb-", "cellular", "automaton", "can", "use", "interactive", "sand", "manipulation", "-lsb-", "Pla-Castells", "et", "al.", "2006", "-rsb-", "we", "method", "build", "continuum", "approach", "more", "general", "allow", "non-cohesive", "behavior", "globally", "couple", "frictional", "handling", "efficient", "two-way", "interaction", "solid", "characteristic", "allow", "qualitatively", "realistic", "compelling", "result", "similar", "fine-scale", "discrete", "method", "far", "lower", "computation", "time", "significantly", "reduce", "memory", "requirement", "we", "method", "we", "assume", "material?s", "grain", "size", "so", "small", "precise", "motion", "individual", "grain", "unimportant", "therefore", "we", "treat", "granular", "material", "instead", "continuous", "fluid", "flow", "under", "action", "external", "force", "internal", "stress", "internal", "stress", "represent", "contact", "frictional", "force", "between", "individual", "grain", "material", "Computing", "motion", "material", "under", "force", "require", "two", "stage", "first", "determine", "internal", "stress", "give", "current", "state", "material", "second", "integrate", "motion", "material", "under", "influence", "force", "while", "stress", "computation", "most", "efficiently", "compute", "regular", "Eulerian", "grid", "integrate", "motion", "granular", "material", "prove", "best", "suit", "lagrangian", "setting", "we", "therefore", "take", "hybrid", "approach", "inform", "previous", "work", "flip", "method", "-lsb-", "Zhu", "Bridson", "2005", "-rsb-", "where", "eulerian", "representation", "use", "compute", "internal", "force", "while", "advection", "perform", "use", "particle", "note", "simulation", "particle", "do", "represent", "individual", "grain", "rather", "move", "clump", "matter", "which", "act", "sample", "material", "we", "briefly", "describe", "overall", "simulation", "loop", "illustrate", "fig.", "beginning", "time", "step", "state", "material", "project", "eulerian", "setting", "accumulate", "particle", "value", "onto", "grid", "use", "eulerian", "representation", "material?s", "internal", "stress", "interaction", "force", "other", "body", "compute", "continuum", "model", "take", "account", "coupling", "between", "pressure", "friction", "-lrb-", "see", "Fig.", "-rrb-", "computed", "stress", "use", "lagrangian", "representation", "update", "particle", "velocity", "motion", "each", "particle", "integrate", "over", "time", "step", "give", "update", "state", "material", "remainder", "paper", "organize", "follow", "continuum", "model", "describe", "section", "particle-based", "advection", "scheme", "section", "further", "implementation", "detail", "give", "section", "section", "we", "discuss", "result", "we", "method", "several", "example", "scenario", "1.1", "related", "work", "ACM", "transaction", "Graphics", "Vol", "29", "no.", "Article", "173", "publication", "date", "December", "2010", "173:2", "R.", "Narain", "et", "al.", "1.2", "Overview", "Discretize", "Accumulate", "pressure", "Update", "position", "Friction", "Solve", "Apply", "impulse", "Update", "velocity", "figure", "main", "simulation", "loop", "we", "algorithm", "see", "Section", "1.2", "detail", "granular", "material", "continuum", "we", "approach", "have", "much", "common", "traditional", "fluid", "simulation", "however", "behavior", "stress", "granular", "material", "differ", "qualitatively", "from", "pressure", "viscosity", "fluid", "novel", "technique", "require", "treat", "they", "faithfully", "continuum", "model", "one", "characteristic", "property", "granular", "material", "can", "disperse", "freely", "Dry", "grain", "apply", "attractive", "force", "each", "other", "so", "macroscopic", "term", "material", "display", "little", "cohesion", "mean", "unlike", "liquid", "granular", "material", "motion", "may", "have", "clearly", "define", "surface", "all", "consider", "sand", "pile", "transition", "cloud", "grain", "under", "impact", "where", "do", "pile", "surface", "end", "cloud", "begin", "another", "significant", "difference", "effect", "friction", "can", "transmit", "force", "across", "large", "distance", "unlike", "fluid", "viscosity", "continue", "act", "even", "rest", "result", "stable", "pile", "other", "quasi-rigid", "behavior", "indeed", "many", "problem", "encounter", "work", "mirror", "those", "rigid", "body", "dynamics", "transfer", "continuum", "setting", "since", "granular", "material", "essentially", "aggregate", "numerous", "rigid", "body", "contact", "order", "capture", "complex", "behavior", "we", "synthesize", "idea", "from", "both", "field", "computational", "fluid", "dynamics", "rigid-body", "simulation", "together", "derive", "we", "new", "formulation", "ACM", "transaction", "Graphics", "Vol", "29", "no.", "Article", "173", "publication", "date", "December", "2010", "Granular", "Materials", "Two-Way", "Solid", "coupling", "173:3", "Figure", "sand", "trickle", "down", "hourglass", "rate", "flow", "constant", "due", "coupling", "between", "pressure", "friction", "right", "simulation", "particle", "use", "advection", "visualize", "2.1", "fundamental", "from", "continuum", "viewpoint", "we", "represent", "physical", "state", "granular", "material", "through", "its", "mass", "density", "flow", "velocity", "system", "act", "upon", "external", "force", "ext", "internal", "stress", "stress", "symmetric", "tensor", "field", "which", "can", "decompose", "isotropic", "mean", "stress", "-lrb-", "pressure", "-rrb-", "traceless", "deviatoric", "component", "which", "represent", "frictional", "stress", "pi", "equation", "motion", "material", "may", "derive", "from", "conservation", "law", "mass", "momentum", "we", "denote", "lagrangian", "time", "derivative", "d/dt", "-lrb-", "-rrb-", "time", "evolution", "system", "give", "transport", "mass", "??", "-lrb-", "-rrb-", "effect", "force", "dv", "ext", "s.", "Dt", "stress", "response", "frictional", "material", "can", "describe", "term", "plastic", "yielding", "material", "resist", "deformation", "when", "stress", "within", "certain", "yield", "criterion", "begin", "flow", "plastically", "when", "yield", "criterion", "violate", "follow", "previous", "work", "-lsb-", "Zhu", "Bridson", "2005", "-rsb-", "we", "employ", "Drucker-Prager", "yield", "criterion", "its", "computational", "simplicity", "when", "cohesion", "negligible", "case", "most", "dry", "granular", "material", "yield", "criterion", "can", "express", "inequality", "where", "qp", "ij", "Frobenius", "norm", "frictional", "coefficient", "related", "angle", "repose", "2/3", "sin", "we", "use", "impulse-based", "time-stepping", "scheme", "throughout", "we", "simulation", "where", "force", "consider", "act", "instantaneously", "beginning", "each", "time", "step", "let", "density", "velocity", "field", "material", "beginning", "time", "step", "respectively", "time", "step", "length", "we", "may", "define", "intermediate", "velocity", "field", "give", "stress", "component", "-lrb-", "ext", "-rrb-", "velocity", "field", "may", "use", "update", "particle", "velocity", "position", "advection", "step", "we", "make", "two", "simplify", "assumption", "dynamics", "granular", "material", "firstly", "we", "assume", "material", "can", "compress", "beyond", "fix", "critical", "density", "max", "which", "permit", "free", "flow", "can", "think", "density", "stable", "pile", "material", "rest", "-lrb-", "reality", "density", "slightly", "higher", "than", "critical", "grain", "rest", "must", "separate", "little", "move", "past", "each", "other", "effect", "visually", "imperceptible", "-rrb-", "secondly", "when", "max", "grain", "pack", "together", "only", "interact", "via", "intermittent", "collision", "we", "neglect", "effect", "interaction", "under", "assumption", "granular", "material", "have", "maximum", "density", "max", "pressure", "act", "prevent", "any", "further", "compression", "material", "however", "contrast", "traditional", "incompressible", "fluid", "where", "both", "positive", "negative", "flow", "divergence", "always", "nullify", "pressure", "absence", "cohesion", "granular", "material", "imply", "material", "undergo", "diverge", "flow", "experience", "internal", "force", "behavior", "can", "express", "inequality", "density", "material", "more", "generally", "its", "volume", "fraction", "pressure", "max", "similar", "constraint", "recently", "apply", "simulation", "dense", "crowd", "pedestrian", "2d", "plane", "Narain", "et", "al.", "-lsb-", "2009", "-rsb-", "which", "call", "unilateral", "incompressibility", "constraint", "we", "adapt", "same", "numerical", "method", "compute", "corresponding", "pressure", "satisfy", "constraint", "3d", "space", "completeness", "we", "briefly", "describe", "method", "below", "volume", "fraction", "end", "time", "step", "can", "estimate", "discretize", "-lrb-", "-rrb-", "give", "-lrb-", "-rrb-", "+1", "-lrb-", "-rrb-", "+1", "max", "where", "+1", "predict", "volume", "fraction", "when", "pressure", "zero", "pressure", "choose", "so", "constraint", "-lrb-", "-rrb-", "satisfy", "+1", "assume", "inelasticity", "pressure", "must", "only", "just", "maintain", "constraint", "do", "cause", "any", "additional", "bounce", "imply", "complementarity", "-lrb-", "+1", "-rrb-", "when", "active", "-lrb-", "nonzero", "-rrb-", "+1", "must", "equal", "fall", "below", "finally", "absence", "cohesion", "imply", "which", "can", "also", "see", "from", "yield", "condition", "-lrb-", "-rrb-", "itself", "condition", "define", "linear", "complementarity", "problem", "-lrb-", "-rrb-", "where", "10", "max", "11", "+1", "vector", "contain", "pressure", "value", "all", "3d", "grid", "cell", "denote", "finite", "difference", "matrix", "map", "scalar", "field", "vector", "field", "p.", "boundary", "condition", "treat", "use", "standard", "technique", "ghost", "cell", "which", "we", "set", "+1", "prevent", "any", "flow", "across", "domain", "boundary", "because", "positive", "semidefinite", "simply", "kkt", "condition", "minimize", "quadratic", "function", "ACM", "transaction", "Graphics", "Vol", "29", "no.", "Article", "173", "publication", "date", "December", "2010", "Figure", "three", "stable", "pile", "friction", "coefficient", "0.3", "0.5", "0.7", "respectively", "lower", "friction", "lead", "flatter", "pile", "12", "all", "non-negative", "component", "therefore", "pressure", "equivalently", "define", "minimization", "problem", "13", "min", "-lrb-", "-rrb-", "2.2.1", "density", "correction", "numerical", "error", "advection", "can", "cause", "density", "violate", "-lrb-", "-rrb-", "slightly", "beginning", "time", "step", "which", "would", "cause", "solver", "apply", "spurious", "corrective", "pressure", "those", "cell", "lead", "oscillation", "avoid", "issue", "we", "first", "redistribute", "density", "so", "initial", "state", "valid", "imagine", "freezing", "material", "time", "apply", "instantaneous", "displacement", "each", "bit", "material", "move", "we", "choose", "new", "volume", "fraction", "14", "-lrb-", "-rrb-", "satisfy", "-lrb-", "-rrb-", "let", "some", "scalar", "field", "we", "can", "solve", "use", "pressure", "solve", "itself", "substitute", "beginning", "time", "step", "we", "solve", "update", "-lrb-", "14", "-rrb-", "correspondingly", "we", "also", "store", "use", "during", "advection", "2.3", "friction", "frictional", "stress", "symmetric", "trace-free", "rank-2", "tensor", "xx", "xy", "xz", "xy", "yy", "yz", "xz", "yz", "zz", "xx", "yy", "zz", "subject", "yield", "condition", "-lrb-", "-rrb-", "because", "yield", "constraint", "convex", "can", "linearize", "replace", "constraint", "surface", "set", "hyperplane", "tangent", "take", "hyperplane", "orthogonal", "each", "component", "yield", "bind", "constraint", "15", "max", "ij", "max", "-lcb-", "-rcb-", "max", "desire", "more", "hyperplane", "can", "include", "improve", "isotropy", "frictional", "response", "effect", "different", "value", "show", "Figure", "plastic", "flow", "principle", "maximum", "plastic", "dissipation", "-lsb-", "Simo", "Hughes", "1998", "-rsb-", "state", "among", "all", "possible", "stress", "satisfy", "yield", "criterion", "actual", "stress", "which", "maximize", "rate", "dissipation", "kinetic", "energy", "we", "compute", "frictional", "stress", "directly", "apply", "maximum", "dissipation", "principle", "over", "discrete", "time", "step", "automatically", "capture", "interplay", "between", "pressure", "friction", "within", "material", "both", "motion", "rest", "eliminate", "need", "additional", "rigidity", "condition", "stable", "pile", "naturally", "generalize", "interaction", "solid", "body", "maximize", "dissipation", "we", "compute", "frictional", "stress", "require", "minimize", "kinetic", "energy", "system", "however", "from", "numerical", "perspective", "directly", "use", "total", "kinetic", "energy", "result", "poorly", "condition", "system", "due", "division", "definition", "can", "ameliorate", "use", "additional", "weighting", "max", "energy", "16", "dv", "modification", "make", "problem", "far", "more", "efficient", "because", "hence", "only", "ever", "nonzero", "when", "close", "max", "over", "almost", "entire", "support", "so", "only", "small", "amount", "error", "introduce", "energy", "can", "express", "quadratic", "functional", "dv", "max", "17", "s.", "where", "18", "max", "19", "max", "here", "treat", "vector", "compose", "concatenation", "component", "frictional", "stress", "all", "grid", "point", "matrix", "map", "tensor", "field", "vector", "field", "s.", "minimize", "subject", "constraint", "-lrb-", "15", "-rrb-", "determine", "frictional", "stress", "20", "min", "-lrb-", "-rrb-", "max", "ij", "max", "boundary", "condition", "treat", "follow", "physically", "normal", "force", "boundary", "due", "friction", "must", "vanish", "correspond", "diagonal", "component", "ii", "ghost", "cell", "so", "fix", "zero", "tangential", "force", "correspond", "off-diagonal", "component", "edge", "along", "boundary", "associate", "finite", "difference", "stencil", "do", "refer", "cell", "outside", "domain", "all", "so", "boundary", "condition", "need", "specify", "here", "pose", "both", "pressure", "friction", "solve", "minimization", "problem", "two-way", "solid-fluid", "interaction", "-lrb-", "show", "fig.", "-rrb-", "can", "very", "naturally", "handle", "along", "line", "variational", "fluid-solid", "coupling", "-lsb-", "Batty", "et", "al.", "2007", "-rsb-", "solid", "body", "interact", "fluid", "granular", "material", "we", "can", "define", "linear", "operator", "which", "integrate", "stress", "its", "surface", "give", "generalize", "force", "example", "rigid", "body", "we", "can", "represent", "generalize", "force", "6-vector", "component", "force", "follow", "component", "moment", "operator", "scalar", "give", "2.4", "interaction", "solid", "body", "ACM", "transaction", "Graphics", "Vol", "29", "no.", "Article", "173", "publication", "date", "December", "2010", "free-flowing", "Granular", "Materials", "Two-Way", "Solid", "coupling", "173:5", "Figure", "sphere", "mass", "0.3", "10", "unit", "strike", "sand", "surface", "heaviest", "sphere", "denser", "than", "sand", "itself", "yet", "internal", "friction", "allow", "material", "support", "weight", "21", "dv", "while", "tensorial", "stress", "22", "-lrb-", "-rrb-", "dv", "term", "fraction", "volume", "cover", "solid", "body", "under", "give", "material", "stress", "external", "force", "ext", "net", "generalize", "force", "body", "simply", "23", "ext", "s.", "furthermore", "adjoint", "yield", "scalar", "field", "which", "give", "distribution", "normal", "velocity", "time", "differential", "area", "over", "surface", "body", "intuitively", "describe", "how", "space", "occupy", "body", "change", "due", "its", "velocity", "consider", "body", "inertia", "matrix", "initial", "generalize", "velocity", "after", "apply", "impulse", "tf", "move", "update", "velocity", "tm", "F.", "pressure", "coupling", "we", "replace", "volume", "fraction", "constraint", "-lrb-", "-rrb-", "24", "enforce", "constraint", "require", "estimate", "volume", "fraction", "cover", "body", "next", "time", "step", "use", "adjoint", "property", "give", "+1", "25", "+1", "+1", "2.5", "put", "together", "tj", "-lrb-", "25", "-rrb-", "where", "predict", "volume", "fraction", "without", "pressure", "coupling", "thus", "we", "add", "matrix", "??", "+1", "linear", "term", "-lrb-", "10", "-rrb-", "-lrb-", "11", "-rrb-", "respectively", "friction", "solve", "we", "simply", "need", "add", "kinetic", "energy", "rigid", "body", "give", "26", "t", "Figure", "sand", "fall", "series", "paddle", "wheel", "set", "they", "motion", "thus", "we", "add", "matrix", "tj", "linear", "term", "-lrb-", "18", "-rrb-", "-lrb-", "19", "-rrb-", "also", "necessary", "modify", "velocity", "update", "granular", "material", "account", "reduce", "volume", "occupy", "assume", "body", "force", "distribute", "volumetrically", "partially", "occupy", "cell", "velocity", "update", "rule", "-lrb-", "-rrb-", "become", "27", "-lrb-", "-rrb-", "-lrb-", "ext", "-rrb-", "once", "pressure", "frictional", "stress", "compute", "rigid", "body", "can", "update", "apply", "impulse", "tf", "use", "-lrb-", "23", "-rrb-", "advance", "through", "one", "time", "step", "give", "current", "state", "system", "term", "density", "velocity", "pressure", "frictional", "stress", "determine", "minimization", "two", "couple", "quadratic", "program", "-lrb-", "-rrb-", "-lrb-", "-rrb-", "subject", "correspond", "linear", "inequality", "constraint", "problem", "solve", "couple", "minimization", "mirror", "address", "Kaufman", "et", "al.", "-lsb-", "2008", "-rsb-", "who", "treat", "contact", "frictional", "force", "between", "rigid", "body", "same", "way", "solution", "procedure", "use", "staggered", "projection", "each", "minimization", "turn", "extend", "continuous", "case", "we", "consider", "staggered", "projection", "method", "work", "fix", "value", "one", "variable", "say", "find", "through", "-lrb-", "13", "-rrb-", "use", "current", "value", "s.", "result", "fix", "update", "through", "-lrb-", "20", "-rrb-", "pair", "minimization", "form", "one", "iteration", "which", "repeat", "procedure", "solve", "-lrb-", "13", "-rrb-", "-lrb-", "20", "-rrb-", "can", "show", "nonexpansive", "mapping", "which", "couple", "solution", "fixed", "point", "we", "refer", "reader", "supplementary", "document", "proof", "discretized", "setting", "both", "problem", "become", "quadratic", "program", "which", "can", "solve", "efficiently", "we", "describe", "section", "because", "non-expansive", "property", "staggered", "projection", "iteration", "iteration", "process", "guarantee", "diverge", "practice", "we", "have", "always", "observe", "converge", "extremely", "quickly", "after", "internal", "stress", "have", "be", "compute", "remain", "integrate", "-lrb-", "-rrb-", "-lrb-", "-rrb-", "advance", "physical", "state", "material", "next", "time", "step", "describe", "follow", "section", "ACM", "transaction", "Graphics", "Vol", "29", "no.", "Article", "173", "publication", "date", "December", "2010", "173:6", "R.", "Narain", "et", "al.", "particle-based", "advection", "unlike", "traditional", "fluid", "consider", "computer", "graphic", "flow", "granular", "material", "may", "purely", "incompressible", "due", "absence", "cohesion", "consequence", "difficult", "apply", "technique", "base", "semi-lagrangian", "advection", "while", "ensure", "conservation", "mass", "momentum", "furthermore", "granular", "material", "exhibit", "coherent", "surface", "pile", "rest", "may", "transition", "sparse", "cloud", "grain", "very", "dynamic", "event", "splash", "free", "fall", "render", "surface", "tracking", "method", "use", "animate", "liquid", "inapplicable", "we", "therefore", "use", "lagrangian", "approach", "advect", "material", "which", "can", "easily", "handle", "property", "we", "method", "can", "consider", "extension", "fluid-implicit-particle", "-lrb-", "flip", "-rrb-", "method", "-lsb-", "Brackbill", "Ruppel", "1986", "Zhu", "Bridson", "2005", "-rsb-", "Lagrangian", "setting", "granular", "material", "represent", "set", "simulation", "particle", "each", "simulation", "particle", "represent", "single", "grain", "macroscopic", "sample", "material?a", "move", "clump", "matter", "mass", "center", "point", "move", "average", "velocity", "beginning", "time", "step", "continuum", "value", "define", "accumulate", "value", "particle", "near", "each", "grid", "cell", "each", "particle", "treat", "point", "mass", "its", "contribution", "divide", "among", "its", "neighbor", "grid", "node", "use", "standard", "trilinear", "weight", "internal", "stress", "compute", "through", "continuum", "model", "determine", "intermediate", "velocity", "v.", "finally", "advection", "perform", "update", "particle", "use", "velocity", "field", "advection", "step", "we", "update", "each", "particle?s", "position", "base", "grid", "velocity", "first", "displacement", "density", "correction", "-lrb-", "section", "2.2.1", "-rrb-", "apply", "particle", "position", "advance", "use", "velocity", "field", "particle", "velocity", "update", "add", "change", "grid", "value", "from", "previous", "time", "step", "follow", "flip", "method", "3.1", "particle", "shape", "split/merge", "operation", "unlike", "fluid", "like", "water", "which", "practically", "incompressible", "granular", "material", "can", "exhibit", "visibly", "diverge", "flow", "disperse", "mass", "sand", "throw", "air", "present", "difficulty", "traditional", "particle-based", "advection", "technique", "design", "incompressible", "flow", "particle", "spread", "farther", "farther", "from", "each", "other", "simulated", "fluid", "eventually", "separate", "clump", "correspond", "individual", "particle", "instead", "spread", "uniformly", "while", "satisfy", "liquid", "wet", "sand", "which", "exhibit", "cohesion", "grain", "disperse", "cloud", "dry", "sand", "often", "smoothly", "distribute", "ensure", "material", "remain", "faithfully", "sample", "case", "necessary", "somehow", "track", "spreading", "simulation", "particle", "insert", "additional", "particle", "where", "necessary", "we", "do", "simply", "attach", "each", "particle", "shape", "center", "around", "particle", "position", "initially", "spherical", "which", "stretch", "squeeze", "flow", "when", "particle", "become", "too", "large", "too", "small", "split", "two", "merge", "adjacent", "particle", "thus", "automatically", "maintain", "good", "distribution", "particle", "-lrb-", "fig.", "-rrb-", "previous", "work", "incompressible", "sph-based", "fluid", "simulation", "have", "use", "splitting", "merge", "level", "detail", "approach", "accelerate", "simulation", "-lsb-", "Adams", "et", "al.", "2007", "-rsb-", "here", "necessity", "represent", "disperse", "mass", "incompressible", "material", "general", "shape", "particle", "ellipsoid", "which", "we", "represent", "region", "-lrb-", "-rrb-", "-lrb-", "-rrb-", "symmetric", "positive", "definite", "matrix", "semi-axis", "ellipsoid", "give", "eigenvector", "square", "root", "eigenvalue", "first", "order", "ellipsoid", "advect", "through", "velocity", "field", "its", "time", "evolution", "give", "figure", "particle", "distortion", "track", "-lrb-", "leave", "-rrb-", "particle", "can", "remain", "well", "distribute", "material", "during", "diverge", "flow", "track", "shape", "particle", "under", "flow", "-lrb-", "right", "-rrb-", "we", "can", "split", "merge", "they", "appropriately", "maintain", "good", "distribution", "28", "da", "-lrb-", "-rrb-", "-lrb-", "-rrb-", "dt", "where", "-lrb-", "-rrb-", "Jacobian", "velocity", "field", "position", "user-specified", "parameter", "control", "size", "particle", "we", "define", "particle", "valid", "length", "its", "semi-axis", "lie", "within", "range", "-lsb-", "2r", "-rsb-", "we", "have", "find", "set", "one-fourth", "grid", "spacing", "generally", "effective", "bound", "axis", "length", "prevent", "particle", "from", "become", "too", "big", "too", "small", "too", "skinny", "so", "can", "treat", "point", "when", "interpolate", "grid", "value", "split", "merge", "operation", "apply", "particle", "become", "invalid", "operation", "define", "so", "conserve", "mass", "momentum", "center", "mass", "system", "split", "operation", "divide", "particle", "two", "identical", "particle", "along", "longest", "axis", "each", "child", "particle", "have", "half", "axis", "length", "along", "direction", "while", "other", "two", "axis", "remain", "same", "merge", "operation", "replace", "two", "nearby", "particle", "one", "larger", "particle", "center", "center", "mass", "carry", "total", "mass", "momentum", "upon", "merge", "particle", "shape", "new", "particle", "say", "give", "29", "-lrb-", "-rrb-", "-lrb-", "-rrb-", "where", "similarly", "displacement", "old", "particle", "from", "new", "center", "mass", "we", "choose", "rule", "so", "immediately", "merge", "child", "split", "return", "original", "particle", "we", "perform", "split", "merge", "operation", "only", "when", "result", "particle", "-lrb-", "-rrb-", "valid", "practice", "yield", "consistent", "set", "particle", "without", "oscillation", "implementation", "detail", "overview", "all", "step", "we", "method", "show", "Figure", "below", "we", "describe", "some", "detail", "we", "implementation", "ACM", "transaction", "Graphics", "Vol", "29", "no.", "Article", "173", "publication", "date", "December", "2010", "free-flowing", "Granular", "Materials", "Two-Way", "Solid", "coupling", "173:7", "p.", "s.", "each", "time", "step", "Accumulate", "density", "velocity", "onto", "grid", "perform", "density", "correction", "repeat", "until", "convergence", "maximum", "iteration", "-lrb-", "-rrb-", "compute", "friction", "minimize", "-lrb-", "20", "-rrb-", "fix", "-lrb-", "-rrb-", "compute", "pressure", "minimize", "-lrb-", "13", "-rrb-", "fix", "find", "intermediate", "velocity", "through", "-lrb-", "-rrb-", "Update", "solid", "body", "impulse", "tf", "-lrb-", "23", "-rrb-", "Update", "particle", "-lrb-", "-rrb-", "Update", "velocity", "use", "flip", "-lrb-", "-rrb-", "move", "particle", "through", "velocity", "field", "v.", "-lrb-", "-rrb-", "Update", "shape", "use", "-lrb-", "28", "-rrb-", "-lrb-", "-rrb-", "split", "merge", "particle", "Figure", "main", "step", "we", "method", "continuum", "model", "we", "use", "regular", "cartesian", "grid", "which", "physical", "quantity", "store", "stagger", "fashion", "follow", "Goktekin", "et", "al", "-lsb-", "2004", "-rsb-", "Scalars", "diagonal", "component", "store", "cell", "center", "vector", "component", "cell", "face", "off-diagonal", "component", "cell", "edge", "spatial", "derivative", "compute", "through", "finite", "difference", "stability", "we", "choose", "time", "step", "so", "particle", "move", "more", "than", "half", "grid", "cell", "single", "time", "step", "impulse-based", "integration", "scheme", "mean", "force", "only", "act", "particle", "beginning", "time", "step", "forward", "euler", "step", "suffice", "perform", "particle", "advection", "discretized", "setting", "-lrb-", "13", "-rrb-", "-lrb-", "20", "-rrb-", "quadratic", "program", "-lrb-", "qp", "-rrb-", "sparse", "symmetric", "positive", "semidefinite", "matrix", "problem", "can", "solve", "efficiently", "use", "recent", "algorithm", "d?stal", "sch?berl", "-lsb-", "2005", "-rsb-", "which", "we", "extend", "incorporate", "mic", "-lrb-", "-rrb-", "preconditioner", "-lsb-", "bridson", "m?ller", "Fischer", "2007", "-rsb-", "support", "two-sided", "bind", "constraint", "however", "na?ve", "approach", "cause", "friction", "solve", "converge", "slowly", "because", "coupling", "between", "different", "component", "s.", "instead", "minimize", "respect", "one", "component", "time", "-lrb-", "which", "amount", "optimize", "over", "orthogonal", "subspace", "turn", "-rrb-", "approximate", "frictional", "solution", "can", "find", "which", "converge", "much", "more", "rapidly", "because", "projection", "nevertheless", "repeat", "outer", "loop", "correct", "solution", "remain", "fixed", "point", "procedure", "please", "see", "supplementary", "document", "more", "detail", "convergence", "also", "greatly", "accelerate", "warm-start", "solver", "use", "pressure", "friction", "value", "compute", "previous", "time", "step", "initialization", "we", "find", "practice", "perform", "just", "few", "iteration", "staggered", "projection", "suffice", "give", "stable", "convincing", "result", "only", "iteration", "be", "use", "all", "we", "result", "4.1", "multiple", "interact", "material", "we", "method", "can", "easily", "extend", "handle", "multiple", "granular", "material", "different", "property", "interact", "single", "scene", "-lrb-", "fig.", "-rrb-", "account", "material", "vary", "density", "friction", "coefficient", "we", "associate", "each", "simulation", "particle", "its", "own", "value", "max", "pressure", "constraint", "volume", "fraction", "must", "redefine", "because", "max", "vary", "material", "different", "density", "instead", "accumulate", "each", "particle", "grid", "obtain", "computing", "max", "we", "obtain", "directly", "accumulate", "minimum", "volume", "each", "particle", "min", "max", "pressure", "solve", "give", "30", "31", "+1", "Figure", "-lrb-", "black", "-rrb-", "medium", "density", "friction", "-lrb-", "sandy", "-rrb-", "low", "density", "friction", "-lrb-", "white", "-rrb-", "instead", "-lrb-", "10", "-rrb-", "-lrb-", "11", "-rrb-", "here", "treat", "diagonal", "matrix", "friction", "solve", "weighting", "now", "simply", "equal", "lead", "similarly", "replace", "-lrb-", "18", "-rrb-", "-lrb-", "19", "-rrb-", "32", "33", "td", "since", "coupling", "matrix", "section", "2.4", "compute", "independently", "material", "remain", "exactly", "same", "particlebased", "advection", "part", "we", "only", "merge", "two", "particle", "have", "identical", "material", "property", "ensure", "each", "simulation", "particle", "associate", "only", "one", "distinct", "material", "facilitate", "render", "desire", "simulate", "material", "property", "vary", "continuously", "over", "space", "condition", "can", "relax", "result", "we", "have", "apply", "we", "method", "several", "scenario", "show", "many", "characteristic", "behavior", "granular", "material", "include", "stable", "pile", "formation", "freely", "disperse", "cloud", "grain", "two-way", "rigid", "body", "interaction", "absence", "cohesion", "Figure", "several", "rigid", "body", "place", "top", "sand", "pile", "explosion", "go", "off", "inside", "pile", "send", "sand", "body", "air", "we", "model", "explosion", "instantaneous", "outward", "impulse", "apply", "particle", "small", "sphere", "interior", "pile", "incompressible", "fluid", "divergence", "would", "immediately", "nullify", "pressure", "projection", "we", "cohesionless", "pressure", "solve", "allow", "sand", "disperse", "realistic", "manner", "pressure/friction", "interaction", "Figure", "show", "sand", "fall", "hourglass", "friction", "play", "central", "role", "here", "maintain", "constant", "rate", "flow", "sand", "through", "neck", "hourglass", "unlike", "traditional", "liquid", "whose", "rate", "flow", "would", "depend", "height", "liquid", "above", "solid", "coupling", "Figure", "demonstrate", "two-way", "coupling", "between", "rigid", "body", "granular", "material", "note", "accurate", "coupling", "frictional", "stress", "necessary", "material", "able", "support", "weight", "body", "much", "denser", "than", "itself", "friction", "also", "cause", "lighter", "sphere", "roll", "without", "slip", "sand", "surface", "another", "example", "rotate", "paddle", "wheel", "show", "Figure", "multiple", "material", "Figure", "show", "different", "kind", "granular", "material", "collide", "interact", "single", "scene", "differ", "density", "friction", "material", "give", "rise", "different", "interaction", "comparison", "previous", "work", "Figure", "11", "we", "compare", "behavior", "we", "simulator", "result", "Zhu", "Bridson", "-lsb-", "2005", "-rsb-", "due", "incompressibility", "assumption", "approach", "work", "well", "modeling", "cohesive", "material", "like", "wet", "sand", "while", "ours", "behave", "more", "like", "dry", "granular", "material", "zero", "cohesion", "real-world", "comparison", "Figure", "10", "show", "impact", "scenario", "fast-moving", "metal", "sphere", "we", "model", "real", "experiment", "from", "Discovery", "Channel", "viewable", "http://dsc.discovery.com/", "videos/time-warp-deep", "impact.html", "we", "result", "qualitatively", "consistent", "real-world", "behavior", "sand", "scenario", "some", "anisotropy", "visible", "splash", "due", "linearization", "friction", "constraint", "-lrb-", "15", "-rrb-", "can", "avoid", "add", "more", "constraint", "hyperplane", "cost", "higher", "simulation", "time", "render", "granular", "material", "from", "continuum-based", "simulation", "pose", "its", "own", "challenge", "fine", "grain", "render", "must", "sample", "from", "simulation", "temporally", "coherent", "manner", "previous", "method", "either", "simulated", "cohesive", "material", "which", "maintain", "well-defined", "surface", "render", "-lsb-", "Zhu", "Bridson", "2005", "-rsb-", "attach", "grain", "rigidly", "simulation", "particle", "-lsb-", "lenaert", "Dutr", "2009", "-rsb-", "lead", "visible", "clump", "neither", "applicable", "we", "technique", "so", "we", "have", "develop", "heuristic", "approach", "we", "find", "perform", "well", "many", "situation", "we", "render", "sand", "cloud", "point", "produce", "granular", "appearance", "each", "simulation", "particle", "we", "associate", "number", "render", "point", "sample", "within", "particle?s", "ellipsoid", "passively", "advect", "flow", "point", "reassign", "new", "simulation", "particle", "upon", "split", "merge", "event", "resample", "fall", "outside", "parent", "ellipsoid", "we", "also", "reduce", "number", "point", "be", "render", "detect", "connected", "region", "high", "density", "avoid", "sampling", "point", "inside", "they", "illumination", "point", "normal", "take", "gradient", "density", "plus", "per-particle", "random", "jitter", "all", "scene", "be", "render", "use", "Pixar?s", "RenderMan", "performance", "we", "single-threaded", "implementation", "measure", "3.33", "GHz", "Intel", "Core", "i7", "machine", "5.8", "gb", "RAM", "detailed", "performance", "number", "show", "Table", "average", "time", "per", "frame", "spend", "follow", "17", "pressure", "35", "friction", "33", "particle", "update", "remainder", "other", "step", "all", "we", "simulation", "take", "between", "33", "seconds", "per", "frame", "average", "which", "comparable", "performance", "-lsb-", "Zhu", "Bridson", "2005", "-rsb-", "similar", "pc", "simulation", "time", "per", "frame", "proportional", "both", "number", "occupied", "grid", "cell", "speed", "motion", "scene", "due", "adaptive", "timestepping", "comparison", "-lsb-", "Bell", "et", "al.", "2005", "-rsb-", "hourglass", "scenario", "110k", "particle", "rigid", "body", "impact", "-lrb-", "splash", "-rrb-", "187k", "particle", "both", "take", "roughly", "200", "seconds", "per", "frame", "accounting", "scaling", "factor", "number", "particle", "we", "method", "run", "similar", "scene", "hardware", "about", "one", "order", "magnitude", "faster", "ACM", "transaction", "Graphics", "Vol", "29", "no.", "Article", "173", "publication", "date", "December", "2010", "173:8", "R.", "Narain", "et", "al.", "Figure", "10", "1-inch", "metal", "sphere", "hit", "sand", "high", "velocity", "create", "splash", "large", "crater", "Figure", "11", "column", "granular", "material", "simulated", "use", "Zhu", "Bridson?s", "method", "-lsb-", "2005", "-rsb-", "-lrb-", "top", "-rrb-", "we", "method", "-lrb-", "bottom", "-rrb-", "Example", "Grid", "size", "sim/render", "Time", "particle", "frame", "explosion", "-lrb-", "fig.", "-rrb-", "75", "50", "75", "242k", "4.7", "19.5", "hourglass", "-lrb-", "-rrb-", "25", "50", "25", "44k", "2.4", "6.5", "impact", "-lrb-", "-rrb-", "50", "40", "100", "425k", "4.1", "18.3", "Paddles", "-lrb-", "-rrb-", "50", "100", "50", "199k", "2.7", "32.5", "Materials", "-lrb-", "-rrb-", "60", "40", "60", "415k", "4.4", "13.9", "comparison", "-lrb-", "11", "-rrb-", "75", "50", "75", "506k", "4.0", "11.6", "Splash", "-lrb-", "10", "-rrb-", "50", "40", "50", "403k", "5.2", "6.1", "Sim/render", "Time", "Example", "Grid", "size", "particle", "frame", "explosion", "-lrb-", "fig.", "-rrb-", "75", "50", "75", "242k", "4.7", "19.5", "hourglass", "-lrb-", "-rrb-", "25", "50", "25", "44k", "2.4", "6.5", "impact", "-lrb-", "-rrb-", "50", "40", "100", "425k", "4.1", "18.3", "Paddles", "-lrb-", "-rrb-", "50", "100", "50", "199k", "2.7", "32.5", "Materials", "-lrb-", "-rrb-", "60", "40", "60", "415k", "4.4", "13.9", "comparison", "-lrb-", "11", "-rrb-", "75", "50", "75", "506k", "4.0", "11.6", "Splash", "-lrb-", "10", "-rrb-", "50", "40", "50", "403k", "5.2", "6.1", "Table", "Performance", "measurement", "all", "we", "example", "conclusion", "we", "have", "present", "efficient", "method", "simulate", "free-flowing", "dynamic", "granular", "material", "use", "continuum", "model", "we", "method", "support", "very", "general", "diverse", "set", "granular", "behavior", "include", "disperse", "flow", "two-way", "interaction", "solid", "object", "we", "achieve", "through", "novel", "mathematical", "treatment", "granular", "flow", "robustly", "handle", "complex", "interplay", "internal", "stress", "granular", "material", "addition", "we", "develop", "generalization", "particle-in-cell", "method", "maintain", "good", "distribution", "particle", "general", "compressible", "flow", "6.1", "Limitations", "future", "work", "we", "method", "model", "purely", "cohesionless", "behavior", "which", "assumption", "satisfy", "most", "dry", "granular", "material", "however", "certain", "material", "wet", "sand", "soil", "show", "finite", "amount", "cohesion", "which", "prevent", "material", "from", "disperse", "under", "small", "force", "exist", "continuum", "model", "-lsb-", "Zhu", "Bridson", "2005", "Lenaerts", "Dutr", "2009", "-rsb-", "which", "assume", "incompressibility", "can", "model", "material", "extent", "do", "handle", "case", "when", "cohesive", "force", "overcome", "material", "break", "apart", "approach", "can", "faithfully", "model", "granular", "material", "vary", "amount", "cohesion", "remain", "open", "challenge", "currently", "we", "do", "model", "detailed", "effect", "inter-grain", "interaction", "include", "subgrid-scale", "variation", "motion", "interaction", "between", "grain", "widely", "differ", "size", "addition", "model", "subgrid-scale", "interaction", "would", "allow", "simulation", "even", "more", "complex", "scene", "avalanche", "involve", "object", "many", "different", "shape", "size", "approach", "could", "also", "useful", "engineering", "application", "derive", "tractable", "model", "granular", "material", "dynamics", "we", "have", "adopt", "critical", "state", "assumption", "neglect", "inter-particle", "interaction", "collisional", "regime", "lower", "density", "assumption", "allow", "many", "scenario", "interest", "graphic", "application", "simulated", "efficiently", "preclude", "modeling", "more", "counterintuitive", "behavior", "formation", "convection", "layer", "surface", "wave", "upon", "shake", "Brazil", "nut", "reverse", "Brazil", "nut", "effect", "surprising", "phenomenon", "beyond", "scope", "we", "current", "work", "remain", "puzzling", "challenging", "effect", "model", "physics", "mathematics", "community", "finally", "issue", "sampling", "render", "million", "grain", "from", "continuum", "representation", "granular", "material", "interesting", "research", "problem", "itself", "can", "further", "enhance", "visual", "appearance", "we", "key", "contribution", "simulation", "further", "independent", "investigation", "problem", "valuable", "acknowledgment", "work", "support", "part", "Army", "Research", "Office", "National", "Science", "Foundation", "RDECOM", "first", "author", "support", "Intel", "PhD", "fellowship", "ACM", "transaction", "Graphics", "Vol", "29", "no.", "Article", "173", "publication", "date", "December", "2010", "free-flowing", "Granular", "Materials", "Two-Way", "Solid", "coupling", "173:9", "reference", "dam", "B.", "auly", "M.", "EISER", "R.", "uiba", "L.", "J.", "2007", "adaptively", "sample", "particle", "fluid", "SIGGRAPH", "07", "ACM", "SIGGRAPH", "2007", "papers", "ACM", "48", "LDU", "i.", "ena", "a.", "taduy", "M.", "A.", "2009", "simulation", "high-resolution", "granular", "media", "Proc", "Congreso", "Espa", "nol", "de", "Inform?tica", "Gr?fica", "RANSON", "I.", "S.", "simring", "L.", "S.", "2001", "continuum", "description", "avalanche", "granular", "media", "Phys", "Rev.", "64", "-lrb-", "Jul", "-rrb-", "020301", "atty", "C.", "ERTAILS", "F.", "RIDSON", "R.", "2007", "fast", "variational", "framework", "accurate", "solid-fluid", "coupling", "ACM", "Trans", "graph", "26", "100", "ehringer", "R.", "AEGER", "H.", "AGEL", "S.", "1999", "introduction", "focus", "issue", "granular", "material", "chaos", "Interdisciplinary", "Journal", "Nonlinear", "Science", "509", "510", "ell", "N.", "Y.", "ucha", "P.", "J.", "2005", "particle-based", "simulation", "granular", "material", "Proc", "ACM", "SIGGRAPH", "Eurographics", "Symposium", "Computer", "animation", "ACM", "77", "86", "CANI", "N.", "2004", "discrete", "element", "method", "encyclopedia", "Computational", "Mechanics", "E.", "Stein", "R.", "de", "Borst", "T.", "J.", "Hughes", "Eds.", "vol", "Wiley", "ch", "11", "rackbill", "J.", "U.", "uppel", "H.", "M.", "1986", "flip", "method", "adaptively", "zone", "particle-in-cell", "calculation", "fluid", "flow", "two", "dimension", "J.", "Comput", "Phys", "65", "314", "343", "ridson", "R.", "uller", "ischer", "M.", "2007", "fluid", "simulation", "ACM", "SIGGRAPH", "2007", "course", "81", "hanclou", "B.", "UCIANI", "a.", "abibus", "a.", "1996", "physical", "model", "loose", "soil", "dynamically", "mark", "move", "object", "Computer", "Animation", "96", "Proceedings", "27", "35", "OST", "AL", "Z.", "ch", "oberl", "J.", "2005", "minimize", "quadratic", "function", "subject", "bind", "constraint", "rate", "convergence", "finite", "termination", "Comput", "Optim", "appl", "30", "23", "43", "oktekin", "t.", "G.", "ARGTEIL", "A.", "W.", "O?B", "RIEN", "J.", "F.", "2004", "method", "animate", "viscoelastic", "fluid", "ACM", "transaction", "graphic", "-lrb-", "Proc", "ACM", "SIGGRAPH", "2004", "-rrb-", "23", "463", "468", "OSSERAND", "C.", "AGR", "p.-y.", "huillier", "D.", "2004", "stationary", "shear", "flow", "dense", "granular", "material", "tentative", "continuum", "modelling", "european", "Physical", "Journal", "Soft", "Matter", "Biological", "physics", "14", "-lrb-", "06", "-rrb-", "127", "135", "AUFMAN", "D.", "M.", "UEDA", "S.", "AMES", "D.", "L.", "aus", "D.", "K.", "2008", "staggered", "projection", "frictional", "contact", "multibody", "system", "ACM", "transaction", "graphic", "-lrb-", "SIGGRAPH", "Asia", "2008", "-rrb-", "27", "164:1", "164:11", "enaert", "t.", "utr", "P.", "2009", "mix", "fluid", "granular", "material", "Computer", "Graphics", "Forum", "28", "213", "218", "-lrb-", "-rrb-", "X.", "oshell", "J.", "M.", "1993", "model", "soil", "realtime", "dynamic", "model", "soil", "slippage", "manipulation", "SIGGRAPH", "93", "ACM", "361", "368", "ucianus", "a.", "ABIBI", "a.", "anzottus", "E.", "1995", "multiscale", "physical", "model", "granular", "material", "Proceedings", "Graphics", "Interface", "iller", "G.", "earce", "a.", "1989", "globular", "dynamics", "connected", "particle", "system", "animate", "viscous", "fluid", "computer", "graphic", "13", "305", "309", "arain", "R.", "OLAS", "A.", "URTIS", "S.", "M.", "C.", "2009", "aggregate", "dynamics", "dense", "crowd", "simulation", "ACM", "Trans", "graph", "28", "noue", "K.", "ISHITA", "T.", "2003", "virtual", "sandbox", "Pacific", "Conference", "Computer", "Graphics", "application", "IEEE", "Computer", "Society", "252", "LA", "ASTELLS", "M.", "ARC", "ern", "andez", "i.", "art", "NEZ", "R.", "J.", "2006", "interactive", "terrain", "simulation", "force", "distribution", "model", "sand", "pile", "cellular", "automaton", "392", "401", "UECEDO", "M.", "ASTOR", "M.", "ERREROS", "M.", "I.", "erodo", "J.", "A.", "F.", "2004", "numerical", "modelling", "propagation", "fast", "landslide", "use", "finite", "element", "method", "International", "Journal", "Numerical", "method", "Engineering", "59", "755", "794", "imo", "J.", "UGHES", "T.", "1998", "computational", "inelasticity", "Springer", "umner", "R.", "W.", "O?B", "RIEN", "J.", "F.", "odgin", "J.", "K.", "1999", "animate", "sand", "mud", "snow", "Computer", "Graphics", "Forum", "18", "17", "26", "hu", "Y.", "RIDSON", "R.", "2005", "animate", "sand", "fluid", "ACM", "SIGGRAPH", "2005", "Papers", "ACM", "965", "972", "hu", "B.", "ang", "X.", "2010", "animate", "sand", "surface", "flow", "eurographic", "2010", "short", "Papers", "ACM", "transaction", "Graphics", "Vol", "29", "no.", "Article", "173", "publication", "date", "December", "2010" ],
  "content" : "\n  \n    bbd4d672998afb980ad7f2dc6975c64117b1ac524a3d0360205cb34c06b187b3\n    oyb\n    10.1145/1866158.1866195\n    Name identification was not possible. \n  \n  \n    \n      \n        Free-Flowing Granular Materials with Two-Way Solid Coupling\n      \n      Rahul Narain Abhinav Golas\n      \n        \n        Figure 1: An explosion goes off inside a sand pile, sending freely splashing sand and rigid bodies flying in the air (running at less than 20 seconds per frame on a single-processor PC). In such a scenario, sand needs to be modeled as a cohesionless granular material.\n      \n      We present a novel continuum-based model that enables efficient simulation of granular materials. Our approach fully solves the internal pressure and frictional stresses in a granular material, thereby allows visually noticeable behaviors of granular materials to be reproduced, including freely dispersing splashes without cohesion, and a global coupling between friction and pressure. The full treatment of internal forces in the material also enables two-way interaction with solid bodies. Our method achieves these results at only a very small fraction of computational costs of the comparable particle-based models for granular flows. CR Categories: I.3.5 [Computer Graphics]: Computational Geometry and Object Modeling?Physically based modeling; I.3.7 [Computer Graphics]: Three-Dimensional Graphics and Realism? Animation Keywords: sand, granular materials, simulation, animation\n    \n    \n      \n        1 Introduction\n      \n      Granular materials such as sand, powders, cereal grains, and gravel are commonplace in the physical world around us. Being composed of very large numbers of mesoscopic grains, they show unique physical behavior that is unlike other materials such as fluids and deformable bodies, which have been well studied in computer graphics. In particular, granular materials disperse freely in free fall, flow plastically under forcing, and yet settle in stable piles.\n      ? E-mail: {narain,golas,lin}@cs.unc.edu\n      \n        ACM Reference Format\n      \n      Narain, R., Golas, A., Lin, M. 2010. Free-Flowing Granular Materials with Two-Way Solid Coupling. ACM Trans. Graph. 29, 6, Article 173 (December 2010), 9 pages. DOI = 10.1145/1866158.1866195 http://doi.acm.org/10.1145/1866158.1866195.\n      \n        Copyright Notice\n      \n      Permission to make digital or hard copies of part or all of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or direct commercial advantage and that copies show this notice on the fi rst page or initial screen of a display along with the full citation. Copyrights for components of this work owned by others than ACM must be honored. Abstracting with credit is permitted. To copy otherwise, to republish, to post on servers, to redistribute to lists, or to use any component of this work in other works requires prior specific permission and/or a fee. Permissions may be requested from Publications Dept., ACM, Inc., 2 Penn Plaza, Suite 701, New York, NY 10121-0701, fax +1 (212) 869-0481, or permissions@acm.org . ? 2010 ACM 0730-0301/2010/12-ART173 $10.00 DOI 10.1145/1866158.1866195 http://doi.acm.org/10.1145/1866158.1866195\n      Ming C. Lin\n      The physical behavior of such materials arises from the interplay of contact and frictional forces between thousands to millions of tiny grains. Simulating the motion of each such grain is computationally prohibitive for large-scale scenarios or fine-grained materials like sand. We instead take a continuum approach, treating a granular material as a continuous fluid. Continuum-based approaches have many advantages, including efficient numerical methods due to a regular computational domain, and the ability for the user to choose the resolution of the simulation as a trade-off between performance and quality.  In order to capture the unique behaviors that such materials exhibit, we depart significantly from traditional fluid simulation techniques. Firstly, to allow the material to disperse freely when agitated but maintain its volume when at rest, we replace the existing fluid-based model?s assumption of incompressibility with a unilateral variational constraint. Secondly, unlike fluid viscosity, friction in granular materials can counteract gravity to maintain stable piles in equilibrium. This requires solving for the internal stresses in a global fashion. We present an efficient method for this numerical problem, permitting appropriate frictional behavior and solid body interaction. Granular materials have received much attention in the fields of geomechanics, engineering, and computational physics. Being ?a distinctive form of matter that exhibits behavior rather different from that of ordinary solids, liquids, or gases? [Behringer et al. 1999], granular materials show surprisingly complex behavior that is still being studied in the physics and engineering communities. Due to the central role of friction and the dissipative nature of inelastic contact interactions, granular flow resists analysis by traditional approaches of statistical mechanics, and describing it by a continuum model which abstracts over individual grain interactions continues to be a topic of active research. For visual applications, however, the use of a simplified continuum model that only treats the more common phases of granular flow can still give very convincing results. This was demonstrated by Zhu and Bridson [2005], who modeled sand as an incompressible fluid by adding frictional forces to a traditional fluid simulator. Their approach relies on identifying rigidly moving regions of ma- terial to obtain stable piles. Lenaerts and Dutr? [2009] adapted this method to the setting of smoothed particle hydrodynamics (SPH), and also enabled simulating sand-water interaction in this setting. The incompressibility assumption, however, can lead to undesirable cohesive behavior, and it is not known if the rigidification approach for friction supports two-way coupling with solid bodies. In soil mechanics, continuum-based approaches have also been employed to study large-scale phenomena such as avalanches and landslides [Aranson and Tsimring 2001; Quecedo et al. 2004; Josserand et al. 2004]. Another natural method for animating granular materials is to directly simulate the interactions between individual grains. This includes the class of discrete element methods used in engineering applications [Bi?ani? 2004]. In graphics, Luciani et al. [1995] developed a particle system model for granular materials using damped spring forces. Bell et al. [2005] used a molecular dynamics method while modeling grains as rigid compounds of spheres, exhibiting compelling behavior with two-way solid body interaction. However, discrete methods incur a heavy computational expense to model fine-grained materials due to the sheer number of particles that must be resolved. This issue was addressed in part by Aldu?n et al. [2009], who proposed a post-processing step that interpolates fine grains over a coarser discrete simulation. We briefly survey some other approaches that have been taken for modeling granular materials in computer graphics. Some of the earliest work used particle systems with heuristic inter-particle forces to give fluid-like or sand-like behavior [Miller and Pearce 1989; Luciani et al. 1995]. Sand has also been modeled using height fields [Li and Moshell 1993; Chanclou et al. 1996], and several extensions have been proposed for modeling footprints and tracks [Sumner et al. 1999], using multi-valued height fields for some 3D effects [Onoue and Nishita 2003], and combining with a flowing surface layer composed of particles [Zhu and Yang 2010]. Cellular automata can be used for interactive sand manipulation [Pla-Castells et al. 2006]. Our method builds on the continuum approach, and is more general, allowing non-cohesive behavior, globally coupled frictional handling, and efficient two-way interaction with solids. These characteristics allow qualitatively realistic, compelling results similar to fine-scale discrete methods at a far lower computation time and significantly reduced memory requirements. In our method, we assume that the material?s grain size is so small that the precise motion of individual grains is unimportant. Therefore, we treat the granular material instead as a continuous fluid flowing under the action of external forces and internal stresses. The internal stresses represent the contact and frictional forces between individual grains in the material. Computing the motion of the material under these forces requires two stages: first, to determine the internal stresses given the current state of the material, and second, to integrate the motion of the material under the influence of these forces. While stress computation is most efficiently computed on a regular Eulerian grid, integrating the motion of a granular material proves to be best suited to a Lagrangian setting. We therefore take a hybrid approach, informed by previous work such as the FLIP method [Zhu and Bridson 2005], where an Eulerian representation is used to compute internal forces, while advection is performed using particles. Note that these simulation particles do not represent individual grains, but rather moving ?clumps? of matter which act as samples of the material. We briefly describe the overall simulation loop, illustrated in Fig. 2 . At the beginning of a time step, the state of the material is projected to the Eulerian setting by accumulating particle values onto the grid. Using the Eulerian representation, the material?s internal stresses and interaction forces with other bodies are computed by the continuum model, taking into account the coupling between pressure and friction (see Fig. 3 ). The computed stresses are used by the Lagrangian representation to update the particle velocities. The motion of each particle is then integrated over the time step, giving the updated state of the material. The remainder of the paper is organized as follows. The continuum model is described in Section 2, and the particle-based advection scheme in Section 3. Further implementation details are given in Section 4. In Section 5, we discuss the results of our method on several example scenarios.\n      1.1 Related work\n      ACM Transactions on Graphics, Vol. 29, No. 6, Article 173, Publication date: December 2010.\n      173:2\n      ?\n      R. Narain et al.\n      1.2 Overview\n      Discretize Accumulate\n      \n        \n        \n      \n      Pressure Update positions Friction Solve Apply impulse Update velocity\n      \n        \n        \n        Figure 2: The main simulation loop of our algorithm. See Section 1.2 for details.\n      \n      \n        2 Granular material as a continuum\n        Our approach has much in common with traditional fluid simulation. However, the behavior of stresses in a granular material differs qualitatively from pressure and viscosity in a fluid, and novel techniques are required to treat them faithfully in a continuum model. One characteristic property of granular materials is that they can disperse freely. Dry grains apply no attractive forces on each other, so in macroscopic terms the material displays little cohesion. This means that unlike a liquid, a granular material in motion may not have a clearly defined surface at all! Consider a sand pile transitioning to a cloud of grains under impact: where does the pile surface end and the cloud begin? Another significant difference is the effect of friction. It can transmit forces across large distances, and unlike fluid viscosity, it continues to act even at rest, resulting in stable piles and other quasi-rigid behaviors. Indeed, many of the problems encountered in this work mirror those of rigid body dynamics transferred to a continuum setting, since granular materials are essentially aggregates of numerous rigid bodies in contact. In order to capture their complex behavior, we synthesize ideas from both the fields of computational fluid dynamics and rigid-body simulation together to derive our new formulation.\n        ACM Transactions on Graphics, Vol. 29, No. 6, Article 173, Publication date: December 2010.\n        Granular Materials with Two-Way Solid Coupling\n        ?\n        173:3\n        \n          \n          Figure 3: Sand trickles down an hourglass.\n        \n        The rate of flow is constant due to the coupling between pressure and friction. On the right, the simulation particles used for advection are visualized.\n        2.1 Fundamentals\n        From a continuum viewpoint, we represent the physical state of a granular material through its mass density ? and flow velocity v. The system is acted upon by external forces f ext and internal stress ?. The stress ? is a symmetric tensor field which can be decomposed into an isotropic mean stress (a ?pressure?) p and a traceless deviatoric component s, which represents frictional stresses.\n        \n          1\n          ? = ?pI + s.\n        \n        The equations of motion of the material may be derived from the conservation laws for mass and momentum. If we denote the Lagrangian time derivative by D/Dt = ?/?t + (v ? ), the time evolution of the system is given by the transport of mass,\n        \n          2\n          ?? + ? (?v) = 0, ?t\n        \n        and the effect of forces,\n        \n          3\n          Dv ? = f ext ? p + ? s. Dt\n        \n        The stress response of frictional materials can be described in terms of plastic yielding: the material resists deformation when the stress is within a certain yield criterion, and begins to flow plastically when the yield criterion is violated. Following previous work [Zhu and Bridson 2005], we employ the Drucker-Prager yield criterion for its computational simplicity. When the cohesion is negligible, as is the case for most dry granular materials, the yield criterion can be expressed by the inequality\n        \n          4\n          ? s F ? 3?p\n        \n        where s F = qP s 2 ij is the Frobenius norm of s, and ? is the frictional coefficient. This is related to the angle of repose ? by ? = p 2/3 sin ?. We use an impulse-based time-stepping scheme throughout our simulation, where forces are considered to act instantaneously at the beginning of each time step. Let the density and velocity field of the material at the beginning of time step n be ? n and v n respectively. For a time step of length ?t, we may define the intermediate velocity field v for given stress components p and s as\n        \n          5\n          v = v n + ?t ? n (f ext ? p + ? s) .\n        \n        This velocity field may be used to update the particle velocities and positions in the advection step.  We make two simplifying assumptions to the dynamics of granular materials. Firstly, we assume that the material cannot be compressed beyond a fixed critical density ? max which permits free flow. This can be thought of as the density of a stable pile of material at rest. (In reality, this density is slightly higher than critical, as grains at rest must separate a little to move past each other, but this effect is visually imperceptible.) Secondly, when ? < ? max , grains are not packed together and only interact via intermittent collisions, and we neglect the effect of these interactions. Under these assumptions, the granular material has a maximum density ? max , and the pressure p acts to prevent any further compression of the material. However, in contrast to traditional incompressible fluids, where both positive and negative flow divergence are always nullified by the pressure, an absence of cohesion in granular material implies that a material undergoing diverging flow experiences no internal forces. This behavior can be expressed as an inequality on the density of the material, or more generally on its ?volume fraction? ?,\n        Pressure\n        \n          6\n          ? ? = ? 1. ? max\n        \n        A similar constraint was recently applied to simulation of dense crowds of pedestrians on a 2D plane by Narain et al. [2009], which they called the unilateral incompressibility constraint. We adapt the same numerical method for computing the corresponding pressure p to satisfy the constraint in 3D space. For completeness, we briefly describe this method below. The volume fraction at the end of a time step ?t can be estimated by discretizing (2) with v = v. This gives\n        (7)\n        \n          8\n          ? n+1 = ? n ? ?t ? (? n v) = ? n+1 | p=0 + ?t 2 2 p, ? max\n        \n        where ? n+1 | p=0 is the predicted volume fraction when pressure is zero. The pressure p is chosen so that the constraint (6) is satisfied for ? n+1 . Assuming inelasticity, the pressure must be such that it only just maintains the constraint, but does not cause any additional ?bounce?. This implies a complementarity\n        \n          9\n          p(1 ? ? n+1 ) = 0\n        \n        That is, when p is active (nonzero), ? n+1 must equal 1, not fall below it. Finally, the absence of cohesion implies that p ? 0, which can also be seen from the yield condition (4) itself. These conditions define a linear complementarity problem\n        A 1 p + b 1 ? 0, p ? 0, T p (A 1 p + b 1 ) = 0, where\n        \n          10\n          ?t 2 T A 1 = D 1 D 1 , ? max\n        \n        \n          11\n          b 1 = 1 ? ? n+1 | p=0 ,\n        \n        and p is a vector containing the pressure values at all 3D grid cells. D 1 denotes the finite difference matrix mapping a scalar field p to  the vector field p. Boundary conditions are treated using the standard technique of ghost cells, on which we set ? n+1 | p=0 = 1 to prevent any flow across domain boundaries. Because A 1 is positive semidefinite, these are simply the KKT conditions for minimizing a quadratic function\n        ACM Transactions on Graphics, Vol. 29, No. 6, Article 173, Publication date: December 2010.\n        \n          \n          Figure 4: Three stable piles with friction coefficients ? = 0.3, 0.5, and 0.7, respectively. Lower friction leads to flatter piles.\n        \n        \n          12\n          1 T T F = p A 1 p + b 1 p, 2\n        \n        for p with all non-negative components. Therefore, the pressure p is equivalently defined by the minimization problem\n        \n          13\n          min F (p) : p ? 0.\n        \n        \n          2.2.1 Density correction\n          Numerical error in advection can cause the density to violate (6) slightly at the beginning of a time step, which would cause the solver to apply spurious corrective pressure at those cells and lead to oscillations. To avoid this issue, we first redistribute the density so the initial state is valid. Imagine freezing the material in time and applying an instantaneous displacement ?x such that each bit of material at x is moved to x + ?x. We choose ?x such that the new volume fraction\n          \n            14\n            ? n ? ? n ? ? (? n ?x)\n          \n          satisfies (6). Letting ?x = ? y/? n for some scalar field y, we can solve this using the pressure solve itself, substituting ?x for v and 1 for ?t. At the beginning of the time step, we solve this and update ? n with (14) and ? n correspondingly. We also store ?x for use during advection.\n          2.3 Friction The frictional stress s is a symmetric, trace-free, rank-2 tensor, 2 s xx s xy s xz 3 s = 4 s xy s yy s yz 5 , s xz s yz s zz s xx + s yy + s zz = 0,\n          subject to the yield condition (4). Because the yield constraint is convex, it can be linearized by replacing the constraint surface with a set of hyperplanes tangent to it. Taking the hyperplanes orthogonal to each component of s yields bound constraints\n          \n            15\n            ?s max ? s ij ? s max\n          \n          for i, j ? {x, y, z}, and with s max = ?p. If desired, more hyperplanes can be included to improve the isotropy of the frictional response. The effect of different values of ? is shown in Figure 4 . For plastic flow, the principle of maximum plastic dissipation [Simo and Hughes 1998] states that among all possible stresses satisfying the yield criterion, the actual stress is that which maximizes the rate of dissipation of kinetic energy. We compute the frictional stress by directly applying the maximum dissipation principle over discrete time steps. This automatically captures the interplay between pressure and friction within the material both in motion and at rest, eliminates the need for an additional rigidity condition for stable piles, and naturally generalizes to interaction with solid bodies. To maximize dissipation, we compute the frictional stress by requiring that it minimize the kinetic energy of the system. However, from a numerical perspective, directly using the total kinetic energy results in a poorly conditioned system due to the division by ? n in the definition of v. This can be ameliorated by using an additional weighting w = ? n /? max on the energy:\n          \n            16\n            1 Z n 2 E = w? v dV 2\n          \n          This modification makes the problem far more efficient, and because p and hence s are only ever nonzero when ? n is close to ? max , w is 1 over almost the entire support of s so only a small amount of error is introduced. The energy can be expressed as a quadratic functional E = 1 Z ? n v| s=0 + ?t ? s 2 dV 2? max\n          \n            17\n            1 T T = E| s=0 + s A 2 s + b 2 s. 2\n          \n          where\n          \n            18\n            ?t 2 T A 2 = D 2 D 2 , ? max\n          \n          \n            19\n            ?t T n b 2 = D 2 ? v| s=0 . ? max\n          \n          Here s is treated as the vector composed of the concatenation of the components of frictional stress at all grid points, and D 2 is the matrix mapping a tensor field s to the vector field ? s. Minimizing E subject to the constraints (15) determines the frictional stress:\n          \n            20\n            min E(s) : ?s max ? s ij ? s max .\n          \n          Boundary conditions are treated as follows. Physically, the normal force at the boundary due to friction must vanish. This corresponds to the diagonal components s ii on the ghost cells, so these are fixed at zero. The tangential force corresponds to the off-diagonal components on edges along the boundary; the associated finite difference stencil does not refer to cells outside the domain at all, so no boundary conditions need to be specified here.  By posing both the pressure and friction solves as minimization problems, two-way solid-fluid interaction (as shown in Fig. 5 ) can be very naturally handled along the lines of variational fluid-solid coupling [Batty et al. 2007]. For a solid body interacting with a fluid or granular material, we can define a linear operator J which integrates stresses on its surface to give generalized forces. For example, for rigid bodies, we can represent generalized forces as 6-vectors with 3 components of force followed by 3 components of moment. The J operator for scalars then is given by\n          2.4 Interaction with solid bodies\n          ACM Transactions on Graphics, Vol. 29, No. 6, Article 173, Publication date: December 2010.\n          Free-Flowing Granular Materials with Two-Way Solid Coupling\n          ?\n          173:5\n          \n            \n            Figure 5: Spheres of masses m = 0.3, 1, 3, and 10 units strike a sand surface. The heaviest spheres are denser than the sand itself, yet internal friction allows the material to support their weight.\n          \n          \n            21\n            Z ? p ? J 1 p = p ? x ? s dV,\n          \n          while that for tensorial stresses is\n          \n            22\n            Z ? ? s ? J 2 s = ( ? s) ? x ? s dV,\n          \n          in terms of the fraction of volume ? s covered by the solid body. Under given material stresses p and s and external forces F ext , the net generalized force on the body is simply\n          \n            23\n            F = F ext ? J 1 p + J 2 s.\n          \n          Furthermore, the adjoint J 1 T yields a scalar field J T 1 V which gives the distribution of normal velocity times differential area over the surface of the body; intuitively, this describes how the space occupied by the body changes due to its velocity. Consider a body with inertia matrix M and initial generalized velocity V n . After applying the impulse ?tF, it moves with the updated velocity V  ? = V n + ?tM ?1 F. For the pressure coupling, we replace the volume fraction constraint (6) with\n          \n            24\n            ? + ? s ? 1.\n          \n          Enforcing this constraint requires estimating the volume fraction covered by the body at the next time step. Using the adjoint property of J 1 , this is given by\n          n+1 n T s s 1\n          \n            25\n            n+1 s | p=0 ? 2 1 T M ?1\n          \n          n+1\n        \n        \n          2.5 Putting it together ? = ? + ?tJ V  ? = ? ?t J J 1 p, (25) |\n          where ? s p=0 is the predicted volume fraction without pressure coupling. Thus we add ?t 2 J T 1 M ?1 J 1 to the matrix A 1 , and ?? n+1 s | p=0 to the linear term b 1 in (10) and (11) respectively. In the friction solve, we simply need to add the kinetic energy of the rigid body to E. This is given by\n          \n            26\n            E s = V  ? T M V  ? = E s | s=0 + 1 ?t 2 s T J 2 T M ?1 J 2 s + ?ts T J 2 T V|  ? s=0 . 2\n          \n          \n            \n            Figure 6: Sand falls on a series of paddle wheels, setting them in motion.\n          \n          Thus, we add ?t 2 J 2 T M ?1 J 2 to the matrix A 2 and ?tJ T 2 V|  ? s=0 to the linear term b 2 in (18) and (19). It is also necessary to modify the velocity updates of the granular material to account for the reduced volume occupied by it. Assuming that the body forces are distributed volumetrically in a partially occupied cell, the velocity update rule (5) becomes\n          \n            27\n            v = v n + ?t ? n (1 ? ? s ) (f ext ? p + ? s) .\n          \n          Once the pressure and frictional stresses are computed, the rigid body can be updated by applying an impulse ?tF using (23) and advancing it through one time step.  Given the current state of the system in terms of density ? and velocity v, the pressure p and frictional stress s are determined by minimization of two coupled quadratic programs F (p) and E(s), subject to corresponding linear inequality constraints. The problem of solving these coupled minimizations mirrors that addressed by Kaufman et al. [2008], who treated the contact and frictional forces between rigid bodies in the same way. This solution procedure, using staggered projections on each minimization in turn, extends to the continuous case we consider. The staggered projection method works by fixing the value of one variable, say s, and finding p through (13) using the current value of s. Then, the resulting p is fixed and s is updated through (20). This pair of minimizations forms one iteration, which is repeated. This procedure of solving (13) and (20) can be shown to be a nonexpansive mapping, of which the coupled solution is a fixed point; we refer the reader to the supplementary document for the proof. In the discretized setting, both problems become quadratic programs which can be solved efficiently, as we describe in Section 4. Because of the non-expansive property of staggered projection iterations, the iteration process is guaranteed not to diverge, and in practice we have always observed it to converge extremely quickly. After the internal stresses p and s have been computed, it remains to integrate (2) and (3) to advance the physical state of the material to the next time step. This is described in the following section.\n          ACM Transactions on Graphics, Vol. 29, No. 6, Article 173, Publication date: December 2010.\n          173:6\n          ?\n          R. Narain et al.\n        \n      \n      \n        3 Particle-based advection\n        Unlike traditional fluids considered in computer graphics, the flow of a granular material may not be purely incompressible due to the absence of cohesion. As a consequence, it is difficult to apply techniques based on semi-Lagrangian advection while ensuring the conservation of mass and momentum. Furthermore, a granular material that exhibits a coherent surface in a pile at rest may transition into a sparse cloud of grains in very dynamic events such as splashes or free fall, rendering surface tracking methods used for animating liquids inapplicable. We therefore use a Lagrangian approach for advecting the material, which can easily handle these properties. Our method can be considered as an extension of the fluid-implicit-particle (FLIP) method [Brackbill and Ruppel 1986; Zhu and Bridson 2005]. In the Lagrangian setting, the granular material is represented as a set of simulation particles. Each simulation particle represents not a single grain but a macroscopic sample of the material?a moving ?clump? of matter with mass m i centered at a point x i and moving with average velocity v i . At the beginning of a time step, the continuum values of ? n and v n are defined by accumulating the values of particles near each grid cell. Each particle is treated as a point mass, and its contribution is divided among its neighboring 8 grid nodes using standard trilinear weights. The internal stresses are then computed through the continuum model to determine the intermediate velocity v. Finally, advection is performed by updating the particles using this velocity field. In the advection step, we update each particle?s position based on the grid velocity. First the displacement ?x for density correction (Section 2.2.1) is applied, then particle positions are advanced using the velocity field. Particle velocities are updated by adding the change in grid values from the previous time step, following the FLIP method.\n        \n          3.1 Particle shapes and split/merge operations\n          Unlike fluids like water which are practically incompressible, granular materials can exhibit visibly diverging flow, such as a dispersing mass of sand thrown into the air. This presents a difficulty for traditional particle-based advection techniques designed for incompressible flow: particles spread farther and farther from each other, and the simulated fluid eventually separates into clumps corresponding to individual particles instead of spreading uniformly. While this is satisfying for liquids, or for wet sand which exhibits cohesion, grains in a dispersing cloud of dry sand are often smoothly distributed. To ensure that the material remains faithfully sampled in such cases, it is necessary to somehow track the spreading of simulation particles, and insert additional particles where necessary. We do this simply by attaching to each particle a shape centered around the particle position, initially spherical, which is stretched  and squeezed by the flow. When the particle becomes too large or too small, it is split into two or merged with an adjacent particle, thus automatically maintaining a good distribution of particles ( Fig. 7 ). Previous work in incompressible SPH-based fluid simulation has used splitting and merging as a level of detail approach to accelerate simulation [Adams et al. 2007], but here it is a necessity for representing a dispersing mass of not incompressible material. In general, the shape of a particle is an ellipsoid, which we represent as the region (x ? x i ) T A ?1 i (x ? x i ) ? 1 for a symmetric positive definite matrix A i . The semi-axes of the ellipsoid are given by the eigenvectors and square roots of eigenvalues of A i . To first order, as this ellipsoid is advected through the velocity field v, its time evolution is given by\n          \n            \n            Figure 7: If particle distortion is not tracked (left), particles cannot remain well distributed in the material during diverging flow. By tracking the shape of particles under the flow (right), we can split and merge them appropriately to maintain a good distribution.\n          \n          \n            28\n            dA i T = A i J v (x i ) + J v (x i )A i dt\n          \n          where J v (x i ) is the Jacobian of the velocity field at position x i . A user-specified parameter r controls the size of particles. We define a particle ? as valid if the lengths of its semi-axes lie within the range [ ? 1 r, 2r]. We have found that setting r to one-fourth the 2 grid spacing is generally effective. The bounds on the axis lengths prevent particles from becoming too big, too small, or too skinny, so that they can be treated as points when interpolating grid values. Split and merge operations are applied to particles that become invalid. These operations are defined so that they conserve the mass, momentum, and center of mass of the system. A split operation divides a particle into two identical particles along the longest axis. Each child particle has half the axis length along this direction, while the other two axes remain the same. A merge operation replaces two nearby particles with one larger particle centered at their center of mass, carrying their total mass and momentum. Upon merging particles i and j, the shape of the new particle, say k, is given by\n          \n            29\n            T T m k A k = m i (A i + ?x i ?x i ) + m j (A j + ?x j ?x j ),\n          \n          where ?x i = x i ?x k , and similarly ?x j , are the displacements of the old particles from the new center of mass. We chose this rule so that immediately merging the children of a split returns the original particle. We perform split and merge operations only when the resulting particle(s) are valid. In practice, this yields a consistent set of particles without oscillations.\n        \n      \n      \n        4 Implementation details\n        An overview of all the steps of our method is shown in Figure 8 . Below we describe some details of our implementation.\n        ACM Transactions on Graphics, Vol. 29, No. 6, Article 173, Publication date: December 2010.\n        Free-Flowing Granular Materials with Two-Way Solid Coupling\n        ?\n        173:7\n        p. s.\n        \n          \n        \n        For each time step: 1. Accumulate density ? n and velocity v n onto grid. 2. Perform density correction on ? n . 3. Repeat until convergence or maximum iterations: (a) Compute friction s by minimizing (20) for fixed (b) Compute pressure p by minimizing (13) for fixed 4. Find intermediate velocity v through (5). 5. Update solid bodies with an impulse ?tF (23). 6. Update particles: (a) Update velocities using FLIP. (b) Move particles through the velocity field v. (c) Update shapes using (28). (d) Split and merge particles.\n        \n          Figure 8: The main steps of our method.\n        \n        For the continuum model, we use a regular Cartesian grid on which physical quantities are stored in a ?staggered? fashion following Goktekin et al [2004]. Scalars ? and p and diagonal components of s are stored at cell centers, vector components of v at cell faces, and off-diagonal components of s at cell edges. Spatial derivatives are computed through finite differences. For stability, we choose time steps so that no particle moves more than half of a grid cell in a single time step. As the impulse-based integration scheme means that forces only act on particles at the beginning of a time step, a forward Euler step suffices to perform particle advection. In the discretized setting, (13) and (20) are quadratic programs (QPs) with sparse, symmetric, positive semidefinite matrices. These problems can be solved efficiently using the recent algorithm of D?stal and Sch?berl [2005], which we extended to incorporate an MIC(0) preconditioner [Bridson and M?ller-Fischer 2007] and support two-sided bound constraints. However, a na?ve approach causes the friction solve to converge slowly, because of the coupling between different components of s. By instead minimizing with respect to one component of s at a time (which amounts to optimizing over orthogonal subspaces in turn), an approximate frictional solution can be found which converges much more rapidly. Because the projections are nevertheless repeated in an outer loop, the correct solution remains the fixed point of the procedure. Please see the supplementary document for more details. Convergence is also greatly accelerated by warm-starting the solver using the pressure and friction values computed at the previous time step as initialization. We found that in practice, performing just a few iterations of staggered projections sufficed to give stable and convincing results; only 2 iterations were used in all our results.\n        \n          4.1 Multiple interacting materials\n          Our method can easily be extended to handle multiple granular materials with different properties interacting in a single scene ( Fig. 9 ). To account for materials of varying densities and friction coefficients, we associate each simulation particle i with its own values of ? max,i and ? i . For the pressure constraint, the volume fraction ? must be redefined because ? max will vary for materials of different densities. Instead of accumulating m i of each particle on the grid to obtain ? and computing ? = ?/? max , we obtain ? directly by accumulating the minimum volume of each particle V min,i = m i /? max,i . The pressure solve is then given by\n          \n            30\n            2 T ? n A 1 = ?t D 1 ? n D 1 ,\n          \n          \n            31\n            b 1 = 1 ? ? n+1 | p=0 ,\n          \n          \n            Figure 9:\n          \n          (black), medium density and friction (sandy), low density and friction (white).\n          instead of (10) and (11). ? n /? n here is treated as a diagonal matrix. In the friction solve, the weighting w now simply equals ?. This leads similarly to replacing (18) and (19) with\n          \n            32\n            2 T ? n A 2 = ?t D 2 ? n D 2 ,\n          \n          \n            33\n            T n b 2 = ?tD 2 ? v| s=0 .\n          \n          Since the coupling matrices of Section 2.4 are computed independently of the material, they remain exactly the same. In the particlebased advection part, we only merge two particles if they have identical material properties. This ensures that each simulation particle is associated with only one distinct material, and facilitates rendering. If it is desired to simulate materials with properties that vary continuously over space, this condition can be relaxed.\n        \n      \n      \n        5 Results\n        We have applied our method to several scenarios, showing many characteristic behaviors of granular materials including stable pile formation, freely dispersing clouds of grains, and two-way rigid body interaction. Absence of cohesion: In Figure 1 , several rigid bodies are placed on top of a sand pile, and an explosion goes off inside the pile, sending the sand and the bodies into the air. We modeled the explosion as an instantaneous outward impulse applied to particles in a small sphere in the interior of the pile. In an incompressible fluid, this divergence would be immediately nullified by the pressure projection, but our cohesionless pressure solve allows the sand to disperse in a realistic manner. Pressure/friction interaction: Figure 3 shows sand falling in an hourglass. Friction plays a central role here, as it maintains a constant rate of flow of sand through the neck of the hourglass, unlike a traditional liquid whose rate of flow would depend on the height of the liquid above it. Solid coupling: Figure 5 demonstrates two-way coupling between rigid bodies and granular material. Note that an accurate coupling of frictional stress is necessary for the material to be able to support the weight of bodies much denser than itself. Friction also causes the lighter spheres roll without slipping on the sand surface. Another example with rotating paddle wheels is shown in Figure 6 . Multiple materials: Figure 9 shows different kinds of granular materials colliding and interacting in a single scene. The differing densities and friction of the materials give rise to different interactions. Comparison with previous work: In Figure 11 , we compare the behavior of our simulator with the results of Zhu and Bridson [2005]. Due to their incompressibility assumption, their approach works well for modeling cohesive materials like wet sand, while ours behaves more like a dry granular material with zero cohesion. Real-world comparison: Figure 10 shows an impact scenario with a fast-moving metal sphere. We modeled this on a real experiment from the Discovery Channel, viewable at http://dsc.discovery.com/ videos/time-warp-deep-impact.html. Our result is qualitatively consistent with the real-world behavior of sand in this scenario. Some anisotropy visible in the splash is due to the linearization of the friction constraint (15). This can be avoided by adding more constraint hyperplanes, at the cost of higher simulation time. Rendering granular materials from a continuum-based simulation poses its own challenges, as fine grains for rendering must be sampled from the simulation in a temporally coherent manner. Previous methods either simulated a cohesive material which maintained a well-defined surface for rendering [Zhu and Bridson 2005], or attached grains rigidly to simulation particles [Lenaerts and Dutr? 2009] leading to visible clumps. Neither of these is applicable to our technique, so we have developed a heuristic approach that we found to perform well for many situations. We render sand as a cloud of points, producing a granular appearance. To each simulation particle, we associate a number of render points sampled within the particle?s ellipsoid, that are passively advected with the flow. Points are reassigned to new simulation particles upon split and merge events, and resampled if they fall outside their parent ellipsoid. We also reduce the number of points being rendered by detecting connected regions of high density and avoiding sampling points inside them. For illumination, the point normal is taken to be the gradient of the density plus a per-particle random jitter. All scenes were rendered using Pixar?s RenderMan R . The performance of our single-threaded implementation was measured on a 3.33 GHz Intel Core i7 machine with 5.8 GB of RAM. The detailed performance numbers are shown in Table 1 . On average, the time per frame was spent as follows: 17% pressure, 35% friction, 33% particle update, and the remainder in other steps. All of our simulations took between 6 and 33 seconds per frame on average, which is comparable to the performance of [Zhu and Bridson 2005] on similar PCs. The simulation time per frame is proportional to both the number of occupied grid cells and the speed of motion in the scene due to adaptive timestepping. In comparison to [Bell et al. 2005], their hourglass scenario with 110k particles and rigid body impact (?splash?) with 187k particles both take roughly 200 seconds per frame. Accounting for the scaling factor in the number of particles, our method running on the similar scenes and hardware is about one order of magnitude faster.\n        ACM Transactions on Graphics, Vol. 29, No. 6, Article 173, Publication date: December 2010.\n        173:8\n        ?\n        R. Narain et al.\n        \n          \n          Figure 10: A 1-inch metal sphere hits sand at high velocity, creating a splash and a large crater.\n        \n        \n          \n          Figure 11: A column of granular material is simulated using Zhu and Bridson?s method [2005] (top) and our method (bottom).\n        \n        \n          \n            \n              \n                \n                   Example\n                   Grid size\n                   Sim/render\n                   Time/\n                \n              \n              \n                \n                  \n                  \n                   particles\n                   frame\n                \n                \n                   Explosion (Fig. 1)\n                   75 ? 50 ? 75\n                   242k / 4.7M\n                   19.5 s\n                \n                \n                   Hourglass (3)\n                   25 ? 50 ? 25\n                   44k / 2.4M\n                   6.5 s\n                \n                \n                   Impacts (5)\n                   50 ? 40 ? 100\n                   425k / 4.1M\n                   18.3 s\n                \n                \n                   Paddles (6)\n                   50 ? 100 ? 50\n                   199k / 2.7M\n                   32.5 s\n                \n                \n                   Materials (9)\n                   60 ? 40 ? 60\n                   415k / 4.4M\n                   13.9 s\n                \n                \n                   Comparison (11)\n                   75 ? 50 ? 75\n                   506k / 4.0M\n                   11.6 s\n                \n                \n                   Splash (10)\n                   50 ? 40 ? 50\n                   403k / 5.2M\n                   6.1 s\n                \n              \n            \n          \n          Sim/render Time/ Example Grid size particles frame Explosion ( Fig. 1 ) 75 ? 50 ? 75 242k / 4.7M 19.5 s Hourglass (3) 25 ? 50 ? 25 44k / 2.4M 6.5 s Impacts (5) 50 ? 40 ? 100 425k / 4.1M 18.3 s Paddles (6) 50 ? 100 ? 50 199k / 2.7M 32.5 s Materials (9) 60 ? 40 ? 60 415k / 4.4M 13.9 s Comparison (11) 75 ? 50 ? 75 506k / 4.0M 11.6 s Splash (10) 50 ? 40 ? 50 403k / 5.2M 6.1 s\n          Table 1: Performance measurements for all of our examples.\n        \n      \n      \n        6 Conclusion\n        We have presented an efficient method for simulating free-flowing, dynamic granular materials using a continuum model. Our method supports a very general, diverse set of granular behaviors, including dispersing flow and two-way interaction with solid objects. We achieved this through a novel mathematical treatment of granular flow that robustly handles the complex interplay of internal stresses in the granular material. In addition, we developed a generalization of the particle-in-cell method that maintains a good distribution of particles in general compressible flows.\n        \n          6.1 Limitations and future work\n          Our method models purely cohesionless behavior, which is an assumption satisfied by most dry granular materials. However, certain materials such as wet sand and soil show a finite amount of cohesion, which prevents the material from dispersing under small forces. Existing continuum models [Zhu and Bridson 2005; Lenaerts and Dutr? 2009] which assume incompressibility can model such materials to an extent, but do not handle cases when  cohesive forces are overcome and the material breaks apart. An approach that can faithfully model granular materials with varying amounts of cohesion remains an open challenge. Currently, we do not model the detailed effects of inter-grain interaction. These include subgrid-scale variations in motion, and interactions between grains of widely differing sizes. The addition of a model for such subgrid-scale interactions would allow for the simulation of even more complex scenes such as avalanches involving objects of many different shapes and sizes. Such an approach could also be useful in engineering applications. To derive a tractable model for granular material dynamics, we have adopted a critical state assumption and neglected inter-particle interactions in the collisional regime of lower density. These assumptions allow many scenarios of interest to graphics applications to be simulated efficiently, but preclude modeling the more counterintuitive behaviors such as formation of convection layers and surface waves upon shaking, and the Brazil nut and reverse Brazil nut effects. These surprising phenomena are beyond the scope of our current work, and remain as puzzling, challenging effects to model for the physics and mathematics communities. Finally, the issue of sampling and rendering millions of grains from a continuum representation of granular material is an interesting research problem in itself, and can further enhance the visual appearance of our key contribution on simulation. Further independent investigation of this problem is valuable. Acknowledgments: This work is supported in part by the Army Research Office, National Science Foundation, and RDECOM. The first author was supported by an Intel PhD fellowship.\n          ACM Transactions on Graphics, Vol. 29, No. 6, Article 173, Publication date: December 2010.\n          Free-Flowing Granular Materials with Two-Way Solid Coupling\n          ?\n          173:9\n        \n      \n      \n        References\n        \n          A DAMS , B., P AULY , M., K EISER , R., AND G UIBAS , L. J. 2007. Adaptively sampled particle fluids. In SIGGRAPH ?07: ACM SIGGRAPH 2007 papers, ACM, 48.\n          A LDU AN  ? , I., T ENA , A., AND O TADUY , M. A. 2009. Simulation of high-resolution granular media. In Proc. of Congreso Espa nol de Inform?tica Gr?fica.\n          A RANSON , I. S., AND T SIMRING , L. S. 2001. Continuum description of avalanches in granular media. Phys. Rev. E 64, 2 (Jul), 020301.\n          B ATTY , C., B ERTAILS , F., AND B RIDSON , R. 2007. A fast variational framework for accurate solid-fluid coupling. ACM Trans. Graph. 26, 3, 100.\n          B EHRINGER , R., J AEGER , H., AND N AGEL , S. 1999. Introduction to the focus issue on granular materials. Chaos: An Interdisciplinary Journal of Nonlinear Science 9, 3, 509?510.\n          B ELL , N., Y U , Y., AND M UCHA , P. J. 2005. Particle-based simulation of granular materials. In Proc. ACM SIGGRAPH / Eurographics Symposium on Computer animation, ACM, 77?86.\n          B I CANI  ? ? , N. 2004. Discrete element methods. In Encyclopedia of Computational Mechanics, E. Stein, R. de Borst, and T. J. Hughes, Eds., vol. 1. Wiley, ch. 11.\n          B RACKBILL , J. U., AND R UPPEL , H. M. 1986. Flip: A method for adaptively zoned, particle-in-cell calculations of fluid flows in two dimensions. J. Comput. Phys. 65, 2, 314?343.\n          B RIDSON , R., AND M ULLER  ? -F ISCHER , M. 2007. Fluid simulation. In ACM SIGGRAPH 2007 courses, 1?81.\n          C HANCLOU , B., L UCIANI , A., AND H ABIBI , A. 1996. Physical models of loose soils dynamically marked by a moving object. In Computer Animation ?96 Proceedings, 27?35.\n          D OST AL  ? , Z., AND S CH OBERL  ? , J. 2005. Minimizing quadratic functions subject to bound constraints with the rate of convergence and finite termination. Comput. Optim. Appl. 30, 1, 23? 43.\n          G OKTEKIN , T. G., B ARGTEIL , A. W., AND O?B RIEN , J. F. 2004. A method for animating viscoelastic fluids. ACM Transactions on Graphics (Proc. of ACM SIGGRAPH 2004) 23, 3, 463?468.\n          J OSSERAND , C., L AGR ? E , P.-Y., AND L HUILLIER , D. 2004. Stationary shear flows of dense granular materials: a tentative continuum modelling. The European Physical Journal E: Soft Matter and Biological Physics 14 (06), 127?135.\n          K AUFMAN , D. M., S UEDA , S., J AMES , D. L., AND P AI , D. K. 2008. Staggered projections for frictional contact in multibody systems. ACM Transactions on Graphics (SIGGRAPH Asia 2008) 27, 5, 164:1?164:11.\n          L ENAERTS , T., AND D UTR ? , P. 2009. Mixing fluids and granular materials. Computer Graphics Forum 28, 213?218(6).\n          L I , X., AND M OSHELL , J. M. 1993. Modeling soil: realtime dynamic models for soil slippage and manipulation. In SIGGRAPH ?93, ACM, 361?368.\n          L UCIANI , A., H ABIBI , A., AND M ANZOTTI , E. 1995. A multiscale physical model of granular materials. In Proceedings of Graphics Interface.\n          M ILLER , G., AND P EARCE , A. 1989. Globular dynamics: A connected particle system for animating viscous fluids. Computers and Graphics 13, 3, 305?309.\n          N ARAIN , R., G OLAS , A., C URTIS , S., AND L IN , M. C. 2009. Aggregate dynamics for dense crowd simulation. ACM Trans. Graph. 28, 5, 1?8.\n          O NOUE , K., AND N ISHITA , T. 2003. Virtual sandbox. In Pacific Conference on Computer Graphics and Applications, IEEE Computer Society, 252.\n          P LA -C ASTELLS , M., G ARC ? A -F ERN ANDEZ  ? , I., AND M ART ? NEZ , R. J. 2006. Interactive terrain simulation and force distribution models in sand piles. In Cellular Automata. 392?401.\n          Q UECEDO , M., P ASTOR , M., H ERREROS , M. I., AND M ERODO , J. A. F. 2004. Numerical modelling of the propagation of fast landslides using the finite element method. International Journal for Numerical Methods in Engineering 59, 6, 755?794.\n          S IMO , J., AND H UGHES , T. 1998. Computational Inelasticity. Springer.\n          S UMNER , R. W., O?B RIEN , J. F., AND H ODGINS , J. K. 1999. Animating sand, mud, and snow. Computer Graphics Forum 18, 1, 17?26.\n          Z HU , Y., AND B RIDSON , R. 2005. Animating sand as a fluid. In ACM SIGGRAPH 2005 Papers, ACM, 965?972.\n          Z HU , B., AND Y ANG , X. 2010. Animating sand as a surface flow. In Eurographics 2010, Short Papers.\n        \n        ACM Transactions on Graphics, Vol. 29, No. 6, Article 173, Publication date: December 2010.\n      \n    \n  ",
  "resources" : [ ]
}