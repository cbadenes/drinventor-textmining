{
  "uri" : "sig2012-a51-lehtinen_PROC.xml",
  "url" : "/Users/cbadenes/Documents/OEG/Projects/DrInventor/datasets/acm-siggraph-2006-2014-upf/sig2012/a51-lehtinen_PROC.xml",
  "source" : {
    "name" : "SIGGRAPH",
    "uri" : "http://drinventor/SIGGRAPH",
    "url" : "http://drinventor/SIGGRAPH",
    "protocol" : "http"
  },
  "metainformation" : {
    "title" : "Reconstructing the Indirect Light Field for Global Illumination",
    "published" : "2012",
    "format" : "pdf",
    "language" : "en",
    "rights" : "GPLv2",
    "description" : "",
    "creators" : [ {
      "uri" : "http://drinventor/Jaakko-Lehtinen",
      "name" : "Jaakko",
      "surname" : "Lehtinen"
    }, {
      "uri" : "http://drinventor/Timo-Aila",
      "name" : "Timo",
      "surname" : "Aila"
    }, {
      "uri" : "http://drinventor/Samuli-Laine",
      "name" : "Samuli",
      "surname" : "Laine"
    }, {
      "uri" : "http://drinventor/Fr?do-Durand",
      "name" : "Fr?do",
      "surname" : "Durand"
    } ]
  },
  "bagOfWords" : [ "40e3bfa5bb2f263e2695e0ae37dbae257d17037c4139f0c8e1b7b016f085870b", "p2c", "10.1145", "2185520.2185547", "name", "identification", "possible", "original", "pdf", "find", "image-based/possible", "ocr", "document", "output", "quality", "may", "degrade", "reconstruct", "indirect", "light", "field", "global", "illumination", "Jaakko", "Lehtinen", "NVIDIA", "Research", "Timo", "Aila", "NVIDIA", "Research", "Stochastic", "technique", "render", "indirect", "illumination", "suffer", "from", "noise", "due", "variance", "integrand", "paper", "we", "describe", "general", "reconstruction", "technique", "exploit", "anisotropy", "light", "field", "permit", "efficient", "reuse", "input", "sample", "between", "pixel", "world-space", "location", "multiply", "effective", "sampling", "rate", "large", "factor", "we", "technique", "introduce", "visibility-aware", "anisotropic", "reconstruction", "indirect", "illumination", "ambient", "occlusion", "glossy", "reflection", "operate", "point", "sample", "without", "knowledge", "scene", "can", "thus", "see", "advanced", "image", "filter", "we", "result", "show", "dramatic", "improvement", "image", "quality", "while", "use", "very", "sparse", "input", "sampling", "keyword", "light", "field", "reconstruction", "indirect", "illumination", "ambient", "occlusion", "defocus", "motion", "blur", "Links", "dl", "pdf", "EB", "ODE", "introduction", "1.1", "related", "work", "when", "generate", "digital", "image", "simulate", "light", "transport", "each", "pixel", "compute", "integral", "multidimensional", "radiance", "function", "whose", "dimension", "range", "over", "image", "xy", "lens", "-lrb-", "depth", "field", "-rrb-", "time", "-lrb-", "motion", "blur", "-rrb-", "incident", "angle", "-lrb-", "indirect", "illumination", "glossy", "reflection", "-rrb-", "light", "source", "-lrb-", "area", "lighting", "-rrb-", "integral", "typically", "compute", "use", "Monte", "Carlo", "sampling", "evaluate", "indirect", "illumination", "entail", "sampling", "radiance", "over", "hemisphere", "each", "visible", "point", "notoriously", "prone", "noise", "due", "high", "variance", "integrand", "cause", "visibility", "texture", "illumination", "we", "seek", "generate", "high-quality", "image", "feature", "glossy", "reflection", "indirect", "illumination", "intelligently", "reuse", "sample", "draw", "stochastic", "renderer", "only", "few", "sample", "per", "pixel", "we", "cast", "problem", "reconstruct", "indirect", "light", "field", "shade", "point", "base", "sample", "record", "during", "initial", "coarse", "sampling", "step", "reconstructed", "light", "field", "use", "standard", "brdf", "sampling", "step", "generate", "final", "image", "we", "assume", "proper", "importance", "sampling", "apply", "require", "control", "over", "how", "sample", "generate", "throughout", "paper", "we", "assume", "direct", "illumination", "compute", "use", "other", "technique", "we", "build", "recent", "work", "have", "provide", "solid", "understanding", "local", "anisotropy", "exhibit", "temporal", "light", "field", "-lsb-", "Durand", "et", "al.", "2005", "Ramamoorthi", "et", "al.", "2007", "Egan", "et", "al.", "2009", "Soler", "et", "al.", "2009", "Egan", "et", "al.", "2011b", "-rsb-", "while", "previous", "sampling", "scheme", "anisotropic", "reconstruction", "filter", "can", "capture", "essence", "ACM", "Reference", "Format", "Lehtinen", "J.", "Aila", "T.", "Laine", "S.", "Durand", "F.", "2012", "reconstruct", "indirect", "light", "field", "global", "illumination", "ACM", "Trans", "graph", "31", "Article", "51", "-lrb-", "July", "2012", "-rrb-", "10", "page", "dous", "10.1145", "2185520.2185547", "http://doi.acm.org/10.1145/2185520.2185547", "copyright", "Notice", "permission", "make", "digital", "hard", "copy", "part", "all", "work", "personal", "classroom", "use", "grant", "without", "fee", "provide", "copy", "make", "distribute", "profit", "direct", "commercial", "advantage", "copy", "show", "notice", "fus", "rst", "page", "initial", "screen", "display", "along", "full", "citation", "copyright", "component", "work", "own", "other", "than", "ACM", "must", "honor", "abstract", "credit", "permit", "copy", "otherwise", "republish", "post", "server", "redistribute", "list", "use", "any", "component", "work", "other", "work", "require", "prior", "specific", "permission", "and/or", "fee", "permission", "may", "request", "from", "Publications", "Dept.", "ACM", "Inc.", "Penn", "Plaza", "Suite", "701", "New", "York", "NY", "10121-0701", "fax", "+1", "-lrb-212-rrb-Â 869-0481", "permissions@acm.org", "2012", "ACM", "0730-0301/2012", "08-art51", "15.00", "DOI", "10.1145", "2185520.2185547", "http://doi.acm.org/10.1145/2185520.2185547", "Samuli", "Laine", "NVIDIA", "Research", "Fr?do", "Durand", "MIT", "CSAIL", "Input", "-lrb-", "spp", "-rrb-", "we", "reconstruction", "path", "trace", "-lrb-", "512", "spp", "-rrb-", "figure", "we", "demonstrate", "even", "very", "noisy", "sparse", "sampling", "can", "contain", "surprisingly", "much", "information", "about", "light", "transport", "visibility", "scene", "example", "diffuse", "indirect", "illumination", "reconstruct", "from", "input", "sample", "per", "pixel", "integrand", "better", "than", "naive", "point", "sampling", "situation", "motion", "blur", "depth", "field", "area", "lighting", "case", "general", "indirect", "illumination", "remain", "unsolved", "due", "complex", "visibility", "highly", "irregular", "input", "sampling", "glossy", "material", "we", "contribute", "method", "adapt", "sampling", "rate", "nonuniform", "sparse", "uncontrolled", "input", "both", "space", "angle", "spatio-angular", "anisotropic", "reconstruction", "method", "filter", "radiance", "from", "sparse", "sample", "robust", "method", "reasoning", "about", "occlusion", "base", "only", "input", "ray", "contrast", "large", "body", "previous", "work", "aim", "reduce", "noise", "global", "illumination", "we", "do", "utilize", "scene", "geometry", "reconstruction", "pass", "give", "we", "crucial", "advantage", "performance", "only", "weakly", "dependent", "scene", "sense", "we", "algorithm", "can", "see", "advanced", "image", "filter", "we", "algorithm", "produce", "megapixel", "image", "glossy", "reflection", "global", "illumination", "ambient", "occlusion", "few", "minute", "result", "dramatically", "higher", "quality", "than", "possible", "use", "earlier", "reconstruction", "method", "comparable", "use", "hundred", "path", "per", "pixel", "-lrb-", "figure", "-rrb-", "both", "visually", "term", "psnr", "anisotropic", "reconstruction", "image", "synthesis", "involve", "integrate", "high-dimensional", "function", "across", "image", "auxiliary", "dimension", "-lrb-", "time", "lens", "incident", "angle", "etc.", "-rrb-", "body", "recent", "work", "concentrate", "anisotropy", "i.e.", "fact", "signal", "often", "vary", "slowly", "along", "certain", "non-axis-aligned", "subspace", "fourier", "analysis", "elegantly", "reveal", "signal", "locally", "effectively", "lower", "dimension", "case", "-lsb-", "Durand", "et", "al.", "2005", "Egan", "et", "al.", "2009", "-rsb-", "mean", "sample", "draw", "one", "pixel", "tell", "we", "something", "about", "integrand", "other", "pixel", "well", "which", "enable", "reconstruction", "better", "image", "from", "same", "sample", "recent", "trend", "anisotropic", "reconstruction", "can", "trace", "back", "multidimensional", "adaptive", "sampling", "reconstruction", "-lrb-", "mda", "-rrb-", "algorithm", "Hachisuka", "et", "al.", "-lsb-", "2008", "-rsb-", "while", "numerous", "earlier", "technique", "have", "address", "generation", "sample", "accord", "expect", "variance", "integrand", "-lrb-", "importance", "sampling", "adaptive", "sampling", "method", "-rrb-", "Hachisuka", "et", "al.", "concentrate", "example", "4d", "integrand", "over", "image", "lens", "correspond", "diffuse", "fronto-parallel", "planar", "object", "out", "focus", "actually", "only", "two-dimensional", "ACM", "transaction", "Graphics", "Vol", "31", "no.", "Article", "51", "publication", "date", "July", "2012", "51:2", "J.", "Lehtinen", "et", "al.", "reconstruction", "author", "measure", "local", "anisotropy", "from", "sample", "use", "structure", "tensor", "use", "locally", "warp", "distance", "metric", "use", "reconstruct", "integrand", "use", "highdimensional", "k-nearest-neighbor", "search", "-lrb-", "k-nn", "-rrb-", "can", "yield", "significant", "benefit", "unfortunately", "noise", "texture", "may", "confuse", "anisotropy", "estimator", "Egan", "et", "al.", "-lsb-", "2009", "-rsb-", "analyze", "anisotropy", "spacetime", "integrand", "motion", "blur", "from", "first", "principle", "through", "fourier", "analysis", "use", "prediction", "local", "spectrum", "drive", "adaptive", "sampling", "sheared", "filter", "allow", "sharing", "sample", "between", "pixel", "adapt", "predict", "spectrum", "similar", "analysis", "algorithm", "be", "present", "soft", "shadow", "directional", "occlusion", "same", "author", "-lsb-", "Egan", "et", "al.", "2011b", "Egan", "et", "al.", "2011a", "-rsb-", "while", "analysis", "successful", "drive", "adaptive", "sampling", "sheared", "reconstruction", "filter", "less", "efficient", "when", "direction", "anisotropy", "change", "either", "continuously", "discontinuously", "across", "image", "issue", "evident", "e.g.", "occlusion", "discontinuity", "force", "fallback", "QMC", "sampling", "issue", "address", "Lehtinen", "et", "al.", "-lsb-", "2011", "-rsb-", "whose", "algorithm", "account", "both", "individual", "anisotropy", "information", "each", "sample", "discontinuity", "due", "visibility", "produce", "high-quality", "result", "simultaneous", "motion", "blur", "depth", "field", "area", "lighting", "goal", "present", "work", "extend", "approach", "more", "challenging", "unstructured", "case", "indirect", "illumination", "sample-based", "algorithm", "several", "technique", "e.g.", "anisotropic", "diffusion", "-lsb-", "McCool", "1999", "-rsb-", "-lrb-", "cascade", "-rrb-", "cross-bilateral", "filter", "-lrb-", "-rrb-", "-lsb-", "Dammertz", "et", "al.", "2010", "-rsb-", "post-process", "sample", "pixel", "generate", "initial", "render", "pass", "reduce", "noise", "Sen", "Darabi", "-lsb-", "2012", "-rsb-", "improve", "quality", "cross-bilateral", "filter", "compute", "weight", "adaptively", "each", "pixel", "base", "apparent", "dependency", "between", "domain", "variable", "scene", "feature", "sample", "color", "while", "method", "can", "example", "detect", "sample", "some", "pixel", "heavily", "affect", "time", "do", "know", "magnitude", "direction", "motion", "Overbeck", "et", "al.", "-lsb-", "2009", "-rsb-", "Rousselle", "et", "al.", "-lsb-", "2011", "-rsb-", "describe", "method", "maintain", "basis-representation", "image", "adaptively", "request", "more", "sample", "from", "renderer", "area", "exhibit", "high", "variance", "shade", "reuse", "several", "algorithm", "reuse", "shade", "result", "radiance", "irradiance", "while", "determine", "visibility", "actual", "scene", "-lsb-", "Ward", "et", "al.", "1988", "Bala", "et", "al.", "1999", "Bekaert", "et", "al.", "2002", "Gassenbauer", "et", "al.", "2009", "-rsb-", "sampling", "often", "adaptive", "drive", "error", "heuristic", "contrast", "we", "do", "adapt", "sampling", "instead", "post-process", "sample", "give", "we", "separate", "renderer", "run", "lightor", "scene-dependent", "preprocessing", "stage", "do", "require", "scene", "resident", "reconstruction", "phase", "make", "we", "algorithm", "much", "less", "intrusive", "original", "renderer", "geometric", "resampling", "we", "method", "reasoning", "about", "occlusion", "base", "sample", "from", "initial", "sampling", "have", "also", "connection", "ray", "trace", "point-based", "geometry", "-lsb-", "schaufler", "Wann", "Jensen", "2000", "Christensen", "2008", "Ritschel", "et", "al.", "2009", "-rsb-", "algorithm", "convert", "scene", "point-based", "representation", "preprocess", "compute", "solution", "use", "representation", "contrast", "we", "obtain", "sparse", "set", "path", "segment", "from", "renderer", "-lrb-", "which", "use", "whatever", "representation", "internally", "-rrb-", "treat", "segment", "sample", "indirect", "light", "field", "upsample", "solution", "accounting", "angular", "effect", "gloss", "photon", "vpl", "some", "method", "generate", "cloud", "point", "light", "-lrb-", "call", "photon", "virtual", "point", "light", "vpl", "-rrb-", "represent", "entire", "indirect", "light", "field", "-lsb-", "Wann", "Jensen", "1996", "Keller", "1997", "Walter", "et", "al.", "2005", "-rsb-", "can", "see", "resampling", "tegrand", "form", "more", "amenable", "final", "gathering", "original", "scene", "still", "necessary", "visibility", "determination", "primary", "hit", "secondary", "hit", "primary", "ray", "camera", "secondary", "ray", "reconstruction", "ray", "angular", "support", "-lrb-", "correspond", "bandwidth", "-rrb-", "figure", "Input", "datum", "consist", "primary", "secondary", "hit", "point", "corresponding", "surface", "normal", "radiance", "along", "secondary", "ray", "angular", "bandwidth", "estimate", "reflectance", "function", "secondary", "hit", "reconstruction", "indirect", "light", "field", "we", "seek", "render", "high-quality", "global", "illumination", "while", "only", "trace", "small", "number", "ray", "across", "hemisphere", "each", "visible", "point", "we", "reuse", "ray", "across", "many", "pixel", "reconstruct", "each", "visible", "point", "upsampled", "version", "incoming", "light", "field", "reuse", "facilitate", "anisotropy", "exhibit", "incident", "light", "field", "-lsb-", "Durand", "et", "al.", "2005", "-rsb-", "provide", "we", "can", "quantify", "visibility", "angular", "effect", "radiance", "leave", "point", "along", "ray", "provide", "information", "about", "radiance", "carry", "other", "nearby", "ray", "entire", "paper", "we", "disregard", "direct", "illumination", "assume", "compute", "separately", "algorithm", "overview", "first", "pass", "we", "use", "standard", "path", "tracer", "only", "draw", "few", "sample", "per", "pixel", "typically", "16", "we", "store", "ray", "cast", "from", "visible", "point", "spatial", "hierarchy", "index", "hit", "point", "-lrb-", "section", "2.1", "-rrb-", "each", "ray", "sample", "indirect", "light", "field", "after", "we", "compute", "each", "input", "sample", "spatial", "radius", "influence", "determine", "how", "far", "contribute", "light", "field", "reconstruction", "adapt", "density", "input", "sample", "both", "space", "angle", "-lrb-", "section", "2.2", "-rrb-", "we", "describe", "modify", "k-nn", "technique", "adapt", "density", "while", "account", "tradeoff", "between", "space", "angle", "determine", "brdf", "gloss", "furthermore", "we", "need", "treat", "visibility", "carefully", "avoid", "fattening", "small", "feature", "silhouette", "when", "perform", "reconstruction", "we", "introduce", "important", "step", "shrink", "sample", "violate", "visibility", "input", "ray", "-lrb-", "section", "2.3", "-rrb-", "second", "pass", "we", "evaluate", "shade", "equation", "each", "visible", "point", "use", "high-sampling-rate", "reconstruction", "incoming", "hemisphere", "key", "operation", "reconstruction", "4d", "incoming", "light", "field", "along", "give", "ray", "we", "find", "all", "input", "ray", "whose", "spatial", "radius", "overlap", "ray", "group", "they", "apparent", "surface", "use", "visibility", "heuristic", "-lrb-", "section", "2.3.2", "-rrb-", "handle", "two", "dimension", "light", "field", "we", "reconstruct", "radiance", "from", "remain", "sample", "closest", "angle", "order", "handle", "remain", "two", "dimension", "-lrb-", "section", "2.4", "-rrb-", "2.1", "input", "output", "radiance", "from", "point", "towards", "camera", "compute", "-lrb-", "-rrb-", "-lrb-", "-rrb-", "-lrb-", "-rrb-", "cos", "ACM", "transaction", "Graphics", "Vol", "31", "no.", "Article", "51", "publication", "date", "July", "2012", "reconstruct", "indirect", "light", "field", "global", "illumination", "51:3", "where", "-lrb-", "-rrb-", "light", "field", "incident", "from", "direction", "-lrb-", "-rrb-", "reflectance", "function", "-lrb-", "we", "disregard", "transmittance", "simplicity", "-rrb-", "integral", "take", "over", "positive", "hemisphere", "around", "normal", "first", "pass", "compute", "store", "sample", "-lrb-", "-rrb-", "use", "path", "tracer", "each", "input", "sample", "correspond", "secondary", "ray", "consist", "tuple", "where", "radiance", "origin", "hit", "point", "secondary", "ray", "corresponding", "normal", "motion", "vector", "number", "-lcb-", "-rcb-", "image", "lens", "time", "coordinate", "incident", "direction", "which", "-lrb-", "-rrb-", "sample", "support", "angular", "variation", "outgoing", "illumination", "glossy", "surface", "we", "also", "store", "measure", "angular", "bandwidth", "determine", "from", "outgoing", "slice", "brdf", "hit", "point", "we", "use", "unnormalized", "spherical", "von", "mises-fisher", "distribution", "-lcb-", "-rcb-", "-lcb-", "-rcb-", "-lrb-", "-rrb-", "exp", "-lrb-", "-lrb-", "-rrb-", "-rrb-", "store", "its", "concentration", "parameter", "particular", "diffuse", "surface", "increase", "gloss", "-lrb-", "section", "2.5", "-rrb-", "together", "input", "consist", "irregular", "set", "ray", "segment", "coarsely", "sample", "indirect", "light", "field", "-lrb-", "figure", "-rrb-", "give", "sample", "record", "first", "pass", "second", "pass", "evaluate", "out", "-lrb-", "-rrb-", "econstruct", "-lrb-", "-rrb-", "-lrb-", "-rrb-", "cos", "each", "primary", "hit", "input", "sample", "total", "number", "reconstruction", "ray", "per", "pixel", "thus", "where", "number", "primary", "hit", "per", "pixel", "function", "econstruct", "-lrb-", "-rrb-", "perform", "upsampling", "incident", "light", "field", "base", "input", "sample", "assumption", "we", "assume", "proper", "importance", "sampling", "apply", "input", "stage", "guarantee", "distribution", "ray", "generate", "during", "final", "image", "reconstruction", "similar", "input", "because", "we", "can", "hope", "recover", "feature", "present", "input", "we", "make", "assumption", "input", "sample", "faithfully", "represent", "true", "indirect", "light", "field", "i.e.", "capture", "its", "frequency", "content", "density", "input", "sample", "complex", "function", "scene", "its", "material", "sampler", "use", "original", "renderer", "we", "do", "reason", "about", "priori", "instead", "discover", "local", "sampling", "rate", "modify", "k-nearest-neighbor", "search", "-lrb-", "section", "2.2", "-rrb-", "we", "discuss", "possible", "noise", "radiance", "value", "section", "we", "employ", "standard", "light", "field", "parameterization", "where", "ray", "encode", "intersection", "two", "plane", "st", "plane", "uv", "plane", "unit", "distance", "from", "former", "we", "use", "variant", "where", "uv", "coordinate", "measure", "relative", "st", "coordinate", "-lsb-", "Chai", "et", "al.", "2000", "Durand", "et", "al.", "2005", "-rsb-", "essentially", "form", "linearized", "angle", "we", "seek", "reconstruct", "ray", "within", "arbitrary", "location", "direction", "scene", "we", "internally", "store", "ray", "segment", "use", "3d", "hit", "point", "dynamically", "reparameterize", "light", "field", "around", "we", "reconstruction", "ray", "-lsb-", "Isaksen", "et", "al.", "2000", "-rsb-", "glossy", "surface", "narrow", "Figure", "shape", "reconstruction", "filter", "local", "parameterization", "around", "sample", "-lrb-", "show", "blue", "-rrb-", "we", "use", "known", "angular", "bandwidth", "drive", "modify", "k-nearest-neighbor", "search", "where", "each", "sample", "find", "kth", "sample", "fall", "within", "acceptable", "angular", "limit", "result", "spatially", "narrow", "sample", "diffuse", "surface", "-lrb-", "left", "-rrb-", "wide", "sample", "glossy", "surface", "-lrb-", "right", "-rrb-", "2.2", "sample", "rate", "spatial", "angular", "distribution", "input", "sample", "determine", "scene", "geometry", "reflectance", "function", "primary", "hit", "input", "renderer", "perform", "importance", "sampling", "accord", "they", "order", "perform", "meaningful", "reconstruction", "we", "have", "adapt", "sampling", "rate", "both", "space", "angle", "we", "input", "carry", "information", "about", "angular", "variation", "form", "bandwidth", "estimate", "remain", "balance", "known", "angular", "support", "spatial", "support", "specifically", "diffuse", "surface", "where", "outgoing", "radiance", "do", "vary", "over", "angle", "radiance", "input", "sample", "can", "reuse", "any", "reconstruction", "ray", "pass", "near", "sample", "space", "matter", "how", "far", "angle", "provide", "visibility", "account", "glossy", "surface", "where", "radiance", "vary", "over", "angle", "we", "might", "need", "go", "further", "space", "find", "input", "sample", "whose", "direction", "better", "match", "reconstruction", "ray", "along", "line", "previous", "point-based", "rendering", "algorithm", "we", "treat", "input", "sample", "circular", "disk", "-lrb-", "splat", "-rrb-", "3d", "individual", "tangent", "plane", "we", "determine", "size", "analyze", "local", "sample", "density", "set", "spatial", "support", "sample", "we", "search", "its", "kth", "nearest", "neighbor", "space", "around", "its", "secondary", "hit", "point", "only", "consider", "sample", "whose", "direction", "fall", "close", "enough", "angle", "threshold", "determine", "from", "require", "-lrb-", "-rrb-", "0.5", "illustrate", "effect", "first", "consider", "almost", "diffuse", "surface", "radiance", "vary", "slowly", "over", "outgoing", "direction", "almost", "constant", "angle", "-lrb-", "angular", "bandwidth", "low", "consequently", "small", "-rrb-", "search", "simplify", "regular", "k-nn", "space", "consequently", "spatial", "support", "small", "-lrb-", "figure", "leave", "-rrb-", "more", "glossy", "surface", "angular", "bandwidth", "higher", "cause", "k-nn", "search", "disregard", "spatially", "close-by", "sample", "favor", "those", "closer", "angle", "consequently", "support", "wider", "space", "-lrb-", "figure", "right", "-rrb-", "we", "use", "metric", "penalize", "movement", "direction", "normal", "encourage", "search", "support", "favor", "sample", "lie", "locally", "flat", "region", "specifically", "we", "use", "Mahalanobis", "distance", "squash", "distance", "along", "normal", "each", "splat", "factor", "-lrb-", "we", "use", "-rrb-", "implement", "simply", "compute", "euclidean", "length", "-lrb-", "-rrb-", "-lrb-", "-rrb-", "-lrb-", "-lrb-", "-rrb-", "-rrb-", "where", "normal", "2.3", "visibility", "addition", "spatial", "filter", "circular", "splat", "use", "resolve", "visibility", "when", "perform", "reconstruction", "we", "need", "gather", "all", "input", "sample", "whose", "spatial", "support", "intersect", "reconstruction", "ray", "reminiscent", "previous", "point-based", "rendering", "algo", "ACM", "transaction", "Graphics", "Vol", "31", "no.", "Article", "51", "publication", "date", "July", "2012", "51:4", "J.", "Lehtinen", "et", "al.", "without", "shrink", "after", "shrink", "ground", "truth", "figure", "we", "need", "shrink", "some", "sample", "so", "representation", "remain", "faithful", "original", "sampling", "closeup", "ambient", "occlusion", "iguel", "show", "fully", "Figure", "rithm", "-lsb-", "schaufler", "Wann", "Jensen", "2000", "-rsb-", "accelerate", "we", "organize", "secondary", "hit", "point", "-lcb-", "-rcb-", "motion", "bound", "volume", "hierarchy", "-lsb-", "glassner", "1988", "-rsb-", "use", "streaming", "algorithm", "Kontkanen", "et", "al.", "-lsb-", "2011", "-rsb-", "during", "reconstruction", "hierarchy", "use", "standard", "fashion", "walk", "bvh", "intersect", "reconstruction", "ray", "splat", "intersected", "leaf", "node", "2.3.1", "ensure", "consistent", "visibility", "order", "we", "reconstruction", "accurate", "visibility", "function", "induce", "splat", "should", "resemble", "true", "occlusion", "scene", "however", "precede", "k-nn", "procedure", "do", "guarantee", "consistency", "original", "sampling", "small", "geometric", "feature", "-lrb-", "e.g.", "leave", "plant", "-rrb-", "might", "only", "hit", "few", "input", "sample", "when", "get", "enlarged", "k-nn", "procedure", "some", "ray", "present", "input", "might", "erroneously", "intersect", "they", "force", "representation", "consistent", "input", "we", "observe", "input", "ray", "carry", "exact", "information", "about", "point-wise", "visibility", "scene", "we", "know", "certainty", "ray", "from", "terminate", "without", "be", "block", "between", "inspire", "we", "retrace", "all", "input", "ray", "use", "bvh", "shrink", "splat", "intersect", "ray", "should", "finally", "bound", "box", "bvh", "node", "recompute", "accommodate", "new", "size", "conclude", "preprocessing", "input", "sample", "result", "splat", "faithfully", "represent", "visibility", "determine", "original", "secondary", "ray", "while", "adapt", "local", "density", "cause", "spurious", "occlusion", "cf.", "figure", "2.3.2", "Resolving", "Occlusion", "treat", "splat", "simple", "opaque", "occluder", "lead", "unacceptable", "result", "more", "sophisticated", "technique", "require", "determine", "which", "splat", "part", "same", "surface", "-lsb-", "Zwicker", "et", "al.", "2001", "-rsb-", "allow", "filter", "between", "sample", "when", "reconstruct", "radiance", "reconstruction", "ray", "we", "first", "traverse", "bvh", "collect", "all", "input", "sample", "whose", "spatial", "support", "overlap", "reconstruction", "ray", "once", "have", "be", "find", "sample", "sort", "accord", "distance", "from", "ray", "origin", "group", "apparent", "surface", "group", "proceeds", "greedily", "add", "next", "sample", "open", "surface", "long", "do", "conflict", "any", "sample", "already", "surface", "term", "visibility", "when", "visibility", "conflict", "detect", "-lrb-", "see", "below", "-rrb-", "new", "surface", "start", "note", "operation", "entirely", "local", "do", "make", "use", "sample", "whose", "support", "intersect", "reconstruction", "ray", "detect", "visibility", "conflict", "we", "generalize", "heuristic", "Lehtinen", "et", "al.", "-lsb-", "2011", "-rsb-", "detect", "crossing", "trajectory", "light", "field", "defocus", "motion", "blur", "geometric", "interpretation", "test", "two", "sample", "belong", "different", "surface", "event", "line", "define", "line", "go", "through", "scene", "point", "correspond", "sample", "intersect", "lens", "however", "when", "reconstruct", "incident", "light", "field", "surface", "concept", "lens", "meaningless", "addition", "we", "ray", "originate", "from", "terminate", "arbitrary", "3d", "point", "scene", "we", "visibility", "heuristic", "work", "consider", "positive", "halfspace", "i.e.", "point", "where", "-lrb-", "-rrb-", "define", "hit", "point", "normal", "each", "input", "sample", "visibility", "conflict", "detect", "compute", "intersection", "st", "plane", "event", "line", "form", "connect", "two", "endpoint", "intersection", "point", "lie", "within", "positive", "halfspace", "both", "sample", "conflict", "declare", "cf.", "Figure", "approach", "detect", "conflict", "when", "two", "surface", "top", "each", "other", "allow", "blending", "sample", "come", "from", "same", "locally", "flat", "convex", "concave", "surface", "visibility", "conflict", "st", "uv", "event", "event", "line", "line", "ray", "sample", "sample", "origin", "sample", "Figure", "determine", "visibility", "consistency", "reconstruction", "ray", "-lrb-", "purple", "-rrb-", "leave", "event", "line", "draw", "through", "hit", "point", "sample", "intersect", "local", "st", "plane", "-lrb-", "white", "circle", "-rrb-", "outside", "region", "space", "where", "both", "sample", "face", "forward", "consequently", "mutual", "visibility", "determine", "consistent", "sample", "belong", "same", "apparent", "surface", "right", "event", "line", "intersect", "lens", "positive", "half-space", "both", "sample", "sample", "determine", "belong", "different", "surface", "2.4", "4d", "reconstruction", "once", "visibility", "heuristic", "have", "be", "evaluate", "sample", "group", "apparent", "surface", "sample", "nearest", "apparent", "surface", "input", "ray", "whose", "hit", "point", "determine", "visible", "from", "origin", "reconstruction", "ray", "now", "remain", "reconstruct", "radiance", "base", "location", "direction", "require", "adapt", "anisotropy", "bandwidth", "light", "field", "around", "reconstruction", "ray", "consider", "situation", "where", "reconstruction", "ray", "intersect", "spatial", "support", "three", "sample", "-lrb-", "figure", "leave", "-rrb-", "local", "two-plane", "parameterization", "stuv", "construct", "around", "reconstruction", "ray", "reconstruction", "ray", "correspond", "point", "origin", "-lrb-", "figure", "middle", "-rrb-", "each", "input", "ray", "correspond", "single", "point", "each", "input", "sample", "set", "all", "ray", "intersect", "spatial", "support", "form", "set", "planar", "boundary", "-lrb-", "figure", "middle", "-rrb-", "clearly", "reconstruction", "ray", "belong", "set", "diffuse", "surface", "where", "angular", "bandwidth", "zero", "reconstruction", "simple", "we", "evaluate", "spatial", "filter", "-lrb-", "tent", "we", "implementation", "-rrb-", "intersection", "reconstruction", "ray", "splat", "take", "weighted", "average", "among", "all", "sample", "local", "coordinate", "system", "center", "each", "sample", "-lrb-", "figure", "leave", "-rrb-", "correspond", "separable", "4d", "filter", "product", "tent", "space", "constant", "angle", "-lrb-", "correspond", "zero", "angular", "bandwidth", "-rrb-", "reparameterization", "stuv", "coordinate", "around", "reconstruction", "ray", "shears", "filter", "anisotropic", "shape", "show", "-lrb-", "Figure", "middle", "-rrb-", "radiance", "leave", "glossy", "surface", "vary", "over", "outgoing", "angle", "we", "need", "account", "reuse", "sample", "whose", "direction", "similar", "we", "reconstruction", "ray", "non-zero", "angular", "bandwidth", "glossy", "sample", "lead", "wider", "spatial", "support", "result", "bandwidth-aware", "k-nn", "search", "local", "coordinate", "system", "orient", "each", "sample", "visible", "narrower", "angular", "filter", "wider", "space", "-lrb-", "figure", "right", "-rrb-", "when", "filter", "transform", "stuv", "coordinate", "system", "we", "obtain", "anisotropic", "shape", "orient", "similarly", "diffuse", "filter", "-lrb-", "figure", "right", "-rrb-", "we", "perform", "reconstruction", "evaluate", "transform", "filter", "stuv", "origin", "pick", "sample", "whose", "filter", "have", "largest", "magnitude", "can", "see", "anisotropic", "nearest", "neighbor", "filter", "we", "use", "nearest", "neighbor", "glossy", "surface", "mitigate", "effect", "highly", "non-uniform", "angular", "distribution", "we", "input", "sample", "use", "linear", "angular", "filter", "noticeably", "shift", "reconstruction", "towards", "denser", "sampling", "which", "visible", "final", "image", "shift", "highlight", "angular", "shift", "result", "spatial", "shift", "after", "propagation", "necessary", "diffuse", "reflectance", "where", "outgoing", "angle", "play", "role", "discussion", "we", "filter", "scheme", "account", "both", "spatial", "angular", "bandwidth", "outgoing", "light", "field", "input", "sample", "spatial", "angular", "dimension", "balance", "k-nn", "algorithm", "use", "determine", "spatial", "support", "sample", "effect", "curvature", "anisotropy", "incident", "light", "field", "-lrb-", "instance", "near-field", "illumination", "-rrb-", "sample", "point", "play", "role", "how", "space", "angle", "interact", "outgoing", "light", "field", "potentially", "cause", "additional", "shears", "-lsb-", "Durand", "et", "al.", "2005", "-rsb-", "we", "sample", "lie", "actual", "curved", "surface", "we", "input", "whole", "contain", "effect", "we", "input", "do", "carry", "information", "about", "curvature", "property", "incident", "light", "field", "reconstruction", "filter", "individual", "sample", "can", "account", "additional", "shears", "regardless", "we", "treatment", "allow", "faithful", "reconstruction", "glossy", "surface", "reflect", "off", "other", "glossy", "surface", "demonstrate", "result", "when", "reconstruction", "ray", "point", "towards", "fronto-parallel", "surface", "uniform", "angular", "sampling", "we", "reconstruction", "procedure", "correspond", "perform", "nearest", "neighbor", "space", "have", "be", "warped", "use", "Mahalanobis", "distance", "align", "anisotropy", "light", "field", "render", "isocontour", "filter", "locally", "isotropic", "ACM", "transaction", "Graphics", "Vol", "31", "no.", "Article", "51", "publication", "date", "July", "2012", "reconstruct", "indirect", "light", "field", "global", "illumination", "51:5", "sample", "sample", "rec", "ray", "reconstruction", "ray", "sample", "st", "uv", "sample", "ray", "primal", "domain", "Diffuse", "surface", "anisotropic", "narrow", "spatial", "filter", "figure", "4d", "reconstruction", "from", "visible", "sample", "leave", "reconstruction", "ray", "-lrb-", "purple", "-rrb-", "intersect", "three", "sample", "middle", "sample", "lie", "diffuse", "surface", "angular", "bandwidth", "zero", "sample", "filter", "evaluate", "spatial", "tent", "filter", "intersection", "ray", "splat", "right", "glossy", "surface", "-lrb-", "see", "text", "-rrb-", "2.5", "implementation", "detail", "we", "prototype", "implementation", "we", "support", "Torrance-Sparrow", "BRDF", "model", "Blinn", "microfacet", "distribution", "-lrb-", "metal", "material", "pbrt", "-rrb-", "take", "1/r", "where", "roughness", "parameter", "Blinn", "distribution", "-lsb-", "pharr", "Humphreys", "2010", "-rsb-", "formulum", "choose", "empirically", "since", "pbrt", "treat", "geometric", "primitive", "two-sided", "we", "need", "do", "same", "when", "reconstruction", "ray", "hit", "back-facing", "splat", "contribute", "visibility", "similarly", "front-facing", "splat", "however", "back-facing", "splat", "contribute", "radiance", "only", "all", "splat", "first", "surface", "back-facing", "otherwise", "radiance", "contribution", "ignore", "rare", "occasion", "reconstruction", "ray", "may", "hit", "surface", "consist", "only", "one", "two", "sample", "although", "k-nn", "search", "try", "guarantee", "never", "happen", "subsequent", "shrinking", "may", "affect", "result", "happen", "instance", "inside", "dense", "foliage", "where", "individual", "leaf", "may", "hit", "only", "one", "input", "sample", "avoid", "over-estimate", "occlusion", "we", "empirically", "reduce", "splat", "size", "single-sample", "surface", "two-sample", "sur2", "face", "when", "undersampling", "detect", "treatment", "affect", "less", "than", "reconstruction", "ray", "we", "scene", "reconstruction", "result", "particularly", "sensitive", "choice", "we", "use", "12", "all", "example", "paper", "glossy", "surface", "-lrb-", "anisotropic", "angular", "filter", "wider", "space", "-rrb-", "test", "result", "we", "have", "implement", "we", "algorithm", "standalone", "library", "take", "buffer", "sample", "input", "modify", "pbrt", "-lsb-", "pharr", "Humphreys", "2010", "-rsb-", "generate", "input", "we", "have", "produce", "both", "multicore", "CPU", "GPU", "implementation", "reconstruction", "algorithm", "we", "test", "platform", "3.2", "GHz", "quad", "core", "Intel", "Core", "i7", "NVIDIA", "GTX480", "all", "result", "image", "be", "render", "1280", "720", "-lrb-", "720p", "-rrb-", "section", "we", "first", "test", "reconstruction", "indirect", "illumination", "diffuse", "scene", "follow", "glossy", "reflection", "we", "perform", "more", "target", "test", "demonstrate", "we", "occlusion", "heuristic", "allow", "faithful", "reproduction", "visibility", "we", "use", "ambient", "occlusion", "test", "case", "because", "its", "quality", "directly", "determine", "accuracy", "visibility", "finally", "we", "show", "result", "defocus", "motion", "blur", "we", "focus", "quality", "reconstructed", "image", "postpone", "discussion", "about", "scalability", "memory", "consumption", "extension", "Section", "we", "compare", "we", "result", "method", "similarly", "we", "reconstruct", "image", "base", "small", "number", "fat", "sample", "-lsb-", "Lehtinen", "et", "al.", "2011", "Dammertz", "et", "al.", "2010", "Sen", "Darabi", "2012", "-rsb-", "auxiliary", "material", "contain", "all", "uncompressed", "image", "show", "refer", "section", "3.1", "indirect", "illumination", "Diffuse", "Scenes", "we", "reconstruct", "multi-bounce", "diffuse", "global", "illumination", "iguel", "light", "area", "light", "source", "-lrb-", "figure", "-rrb-", "input", "contain", "sample", "per", "pixel", "-lrb-", "leftmost", "inset", "-rrb-", "we", "reconstruct", "incident", "light", "field", "over", "hemisphere", "visible", "point", "integrate", "produce", "result", "-lrb-", "third", "inset", "from", "left", "-rrb-", "per", "equation", "we", "pay", "special", "attention", "fact", "radiance", "input", "sample", "contain", "noise", "due", "multiple", "bounce", "render", "path", "tracer", "we", "reconstruction", "more", "true", "ground", "truth", "-lrb-", "second", "left", "-rrb-", "than", "comparison", "method", "a-trous", "wavelet", "-lsb-", "Dammertz", "et", "al.", "2010", "-rsb-", "-lrb-", "fourth", "inset", "from", "leave", "-rrb-", "random", "parameter", "filter", "-lrb-", "rpf", "last", "one", "right", "-rrb-", "-lsb-", "Sen", "Darabi", "2012", "-rsb-", "we", "use", "both", "comparison", "method", "reconstruct", "incident", "irradiance", "i.e.", "before", "multiplication", "texture", "render", "spp", "input", "pbrt", "take", "36.6", "we", "reconstruction", "256", "reconstruction", "ray", "per", "pixel", "GPU", "take", "189.5", "s.", "preprocessing", "include", "build", "bvh", "size", "sample", "use", "k-nn", "shrink", "sample", "use", "input", "ray", "take", "9.5", "rest", "spend", "reconstruction", "ray", "considerably", "more", "efficient", "than", "render", "similar-quality", "512", "spp", "image", "pbrt", "which", "take", "3910.5", "18x", "longer", "than", "combine", "input", "reconstruction", "we", "256", "spp", "result", "exhibit", "significantly", "less", "noise", "than", "pbrt?s", "256", "spp", "rendering", "thanks", "we", "spatial", "filter", "sample", "Notice", "we", "ability", "perform", "image", "antialiasing", "limit", "number", "primary", "hit", "input", "sample", "supplemental", "video", "contain", "short", "animation", "render", "from", "input", "sample", "per", "pixel", "use", "512", "reconstruction", "ray", "per", "pixel", "each", "frame", "process", "isolation", "temporal", "filter", "any", "kind", "employ", "result", "demonstrate", "temporal", "stability", "we", "reconstruction", "even", "from", "severely", "noisy", "input", "comparison", "method", "A-Trous", "iterative", "approximation", "cross-bilateral", "filter", "twist", "when", "spatial", "support", "widen", "between", "iteration", "range", "filter", "tighten", "allow", "application", "very", "large", "spatial", "filter", "without", "disproportionate", "blur", "original", "implementation", "use", "three", "range", "filter", "color", "normal", "world-space", "position", "since", "we", "input", "very", "noisy", "we", "do", "wish", "clamp", "input", "sample", "energy", "we", "choose", "use", "color", "range", "filter", "-lrb-", "use", "give", "worse", "result", "-rrb-", "while", "quality", "leave", "some", "room", "improvement", "a-trous", "filter", "efficient", "we", "CPU", "implementation", "take", "58", "scene", "since", "reference", "implementation", "random", "parameter", "filter", "-lrb-", "rpf", "-rrb-", "available", "we", "reimplement", "follow", "author", "detailed", "guideline", "-lsb-", "Sen", "Darabi", "2011", "-rsb-", "rpf", "sophisticated", "cross-bilateral", "filter", "automatically", "tune", "weight", "each", "feature", "each", "pixel", "base", "mutual", "information", "between", "domain", "variable", "scene", "feature", "-lrb-", "position", "normal", "texture", "etc.", "-rrb-", "radiance", "input", "sample", "almost", "identical", "ours", "unfortunately", "original", "formulation", "rpf", "make", "heavy", "use", "color", "channel", "range", "filter", "require", "special", "treatment", "bright", "sample", "-lrb-", "hdr", "clamp", "-rrb-", "which", "essentially", "discard", "high-energy", "spike", "lose", "significant", "amount", "energy", "up", "50", "we", "test", "we", "modify", "algorithm", "reinsert", "lose", "energy", "evenly", "all", "sample", "within", "pixel", "we", "reasonably", "tune", "CPU", "implementation", "filter", "image", "2895", "roughly", "line", "result", "we", "estimate", "10x", "possible", "speedup", "from", "GPU", "port", "we", "use", "parameter", "recommend", "author", "guideline", "ACM", "transaction", "Graphics", "Vol", "31", "no.", "Article", "51", "publication", "date", "July", "2012", "51:6", "J.", "Lehtinen", "et", "al.", "3.2", "glossy", "reflection", "figure", "show", "onkey", "ead", "scene", "three", "statuette", "decrease", "gloss", "glossy", "ground", "plane", "scene", "light", "single-bounce", "indirect", "illumination", "from", "distant", "point", "light", "source", "-lrb-", "direct", "illumination", "show", "-rrb-", "consequently", "input", "sample", "noise-free", "input", "contain", "sample", "per", "pixel", "we", "result", "compute", "use", "512", "reconstruction", "ray", "per", "pixel", "a-trous", "rpf", "result", "show", "below", "we", "notice", "result", "a-trous", "roughness", "0.01", "0.05", "0.25", "statuette", "0.01", "ground", "plane", "could", "significantly", "improve", "introduce", "additional", "range", "filter", "over", "normal", "secondary", "hit", "which", "conveniently", "present", "we", "datum", "we", "present", "extension", "we", "comparison", "result", "addition", "original", "algorithm", "we", "result", "significantly", "closer", "grind", "truth", "than", "either", "comparison", "method", "both", "visually", "term", "psnr", "-lrb-", "38.6", "db", "vs.", "31", "33db", "-rrb-", "full-size", "image", "provide", "auxiliary", "material", "closer", "inspection", "particular", "we", "reconstruct", "position", "sharpness", "reflection", "faithfully", "thanks", "4d", "treatment", "input", "sample", "account", "both", "space", "angle", "Figure", "10", "demonstrate", "importance", "accounting", "angular", "effect", "while", "comparison", "method", "produce", "smooth", "result", "reflection", "have", "shift", "noticeably", "sharp", "should", "note", "unlike", "comparison", "method", "we", "use", "render", "system", "-lrb-", "pbrt", "-rrb-", "evaluate", "brdf", "final", "bounce", "towards", "eye", "per", "equation", "while", "closely", "match", "ground", "truth", "we", "algorithm", "currently", "2.6", "slower", "scene", "than", "reference", "method", "mainly", "due", "extreme", "geometric", "simplicity", "scene", "which", "play", "we", "disadvantage", "because", "we", "algorithm", "scale", "weakly", "scene", "complexity", "-lrb-", "section", "-rrb-", "we", "spatial", "hierarchy", "do", "currently", "include", "angular", "subdivision", "-lsb-", "Arvo", "Kirk", "1987", "-rsb-", "we", "may", "therefore", "process", "redundant", "splat", "glossy", "surface", "where", "spatial", "support", "larger", "-lrb-", "section", "2.2", "-rrb-", "another", "possible", "improvement", "discuss", "section", "regardless", "result", "demonstrate", "information", "require", "reconstruct", "high-quality", "reflection", "present", "sparse", "input", "we", "algorithm", "correctly", "extract", "produce", "high-quality", "result", "3.3", "ambient", "occlusion", "we", "algorithm", "can", "easily", "use", "render", "ambient", "occlusion", "bypass", "radiance", "filter", "threshold", "distance", "closest", "apparent", "surface", "find", "Figure", "show", "we", "ambient", "occlusion", "reconstruction", "iguel", "although", "scene", "contain", "fine", "geometric", "feature", "groove", "vegetation", "we", "reconstruction", "from", "only", "input", "sample", "per", "pixel", "very", "close", "agreement", "ground", "truth", "compute", "use", "2048", "sample", "per", "pixel", "case", "image", "antialiasing", "particularly", "limit", "since", "input", "contain", "only", "primary", "hit", "per", "pixel", "GPU", "execution", "time", "145", "seconds", "256", "reconstruction", "ray", "per", "pixel", "720p", "contrast", "ambient", "occlusion", "technique", "Egan", "et", "al.", "-lsb-", "2011a", "-rsb-", "we", "do", "resort", "brute", "force", "Monte", "Carlo", "sampling", "original", "scene", "all", "3.4", "Motion", "Defocus", "finally", "we", "demonstrate", "generality", "we", "reconstruction", "apply", "motion", "blur", "defocus", "-lrb-", "figure", "11", "-rrb-", "specifically", "instead", "secondary", "ray", "we", "now", "store", "primary", "ray", "cast", "from", "lens", "reconstruct", "incident", "temporal", "light", "field", "different", "point", "lens", "instead", "indirect", "lighting", "scene", "point", "we", "use", "utterfly", "dataset", "from", "Lehtinen", "et", "al.", "-lsb-", "2011", "-rsb-", "compare", "against", "publicly", "available", "implementation", "we", "result", "slightly", "more", "accurate", "approx", "db", "term", "pnsr", "image", "available", "supplemental", "material", "we", "better", "result", "explain", "we", "better", "adaptation", "input", "sampling", "rate", "use", "worst-case", "radius", "derive", "from", "dispersion", "sampling", "pattern", "which", "tend", "blur", "in-focus", "geometry", "slightly", "may", "still", "result", "lack", "support", "region", "temporal", "light", "field", "contain", "feature", "visible", "from", "only", "small", "fraction", "lens", "shutter", "interval", "contrast", "we", "k-nn", "approach", "adapt", "local", "sampling", "density", "lead", "sharp", "result", "well", "ACM", "transaction", "Graphics", "Vol", "31", "no.", "Article", "51", "publication", "date", "July", "2012", "reconstruct", "indirect", "light", "field", "global", "illumination", "51:7", "pbrt", "-lrb-", "512", "spp", "-rrb-", "input", "-lrb-", "spp", "-rrb-", "pbrt", "-lrb-", "512", "spp", "-rrb-", "figure", "Diffuse", "global", "illumination", "iguel", "only", "indirect", "illumination", "show", "we", "result", "upsample", "spp", "incident", "light", "field", "use", "256", "reconstruction", "ray", "per", "pixel", "supplemental", "material", "contain", "full", "image", "input", "-lrb-", "spp", "-rrb-", "we", "reconstruction", "figure", "we", "reconstruction", "ambient", "occlusion", "from", "input", "sample", "per", "pixel", "compare", "2048", "spp", "ground", "truth", "from", "PBRT", "we", "reconstruction", "a-trous", "rpf", "ground", "truth", "-lrb-", "2048", "spp", "-rrb-", "ACM", "transaction", "Graphics", "Vol", "31", "no.", "Article", "51", "publication", "date", "July", "2012", "51:8", "J.", "Lehtinen", "et", "al.", "ground", "truth", "-lrb-", "8192", "spp", "from", "pbrt", "-rrb-", "input", "spp", "-lrb-", "20.3", "db", "-rrb-", "we", "-lrb-", "38.6", "db", "-rrb-", "diff", "x2", "a-trous", "-lrb-", "31.5", "db", "-rrb-", "diff", "x2", "a-trous", "secondary", "normal", "-lrb-", "32.3", "db", "-rrb-", "diff", "x2", "rpf", "-lrb-", "32.1", "db", "-rrb-", "diff", "x2", "figure", "glossy", "reflectance", "closeup", "show", "difference", "from", "ground", "truth", "-lrb-", "multiply", "-rrb-", "we", "result", "upsample", "incident", "light", "field", "from", "512", "sample", "per", "pixel", "full", "uncompressed", "image", "provide", "auxiliary", "material", "sample", "area", "better", "support", "lower", "sampling", "density", "area", "demonstrate", "Figure", "12", "we", "reconstruction", "take", "4x", "longer", "than", "algorithm", "Lehtinen", "et", "al.", "primarily", "because", "use", "specialize", "2d", "hierarchy", "post-perspective", "space", "essentially", "tailor", "datum", "structure", "known", "distribution", "reconstruction", "ray", "-lrb-", "all", "originate", "from", "lens", "-rrb-", "we", "focus", "reconstruct", "incident", "light", "field", "arbitrary", "point", "scene", "we", "use", "true", "3d", "hierarchy", "we", "result", "angular", "bandwidth", "figure", "10", "disregard", "angular", "effect", "effectively", "treat", "all", "surface", "hit", "secondary", "ray", "diffuse", "have", "large", "negative", "impact", "result", "Figure", "11", "Motion", "blur", "depth", "field", "render", "use", "we", "algorithm", "use", "sample", "per", "pixel", "input", "please", "refer", "supplemental", "material", "image", "show", "input", "datum", "ground", "truth", "discussion", "scalability", "memory", "consumption", "execution", "time", "we", "algorithm", "scale", "linearly", "number", "reconstruction", "ray", "only", "very", "weakly", "affect", "structure", "scene", "number", "input", "sample", "example", "increase", "number", "input", "sample", "from", "iguel", "increase", "execution", "time", "only", "about", "40", "also", "iguel", "take", "only", "80", "longer", "reconstruct", "than", "ornell", "same", "parameter", "even", "though", "original", "model", "contain", "about", "order", "magnitude", "more", "geometry", "have", "much", "more", "challenging", "structure", "-lrb-", "foliage", "vs.", "straight", "wall", "-rrb-", "memory", "consumption", "almost", "completely", "determine", "number", "input", "sample", "each", "sample", "consist", "30", "floating-point", "number", "total", "up", "1gb", "720p", "input", "sample", "per", "pixel", "independent", "scene", "structure", "addition", "bvh", "consume", "about", "80mb", "parameter", "again", "almost", "independently", "scene", "structure", "all", "other", "memory", "usage", "negligible", "recursive", "filter", "very", "low", "input", "sampling", "rate", "artifact", "can", "appear", "near", "corner", "when", "we", "integrate", "over", "hemisphere", "large", "fraction", "reconstruction", "ray", "may", "hit", "same", "few", "sample", "sample", "noisy", "reconstructed", "image", "can", "suffer", "from", "structured", "artifact", "demonstrate", "Figure", "13", "example", "ornell", "render", "up", "eight-bounce", "indirect", "illumination", "from", "point", "light", "1024", "1024", "only", "one", "sample", "per", "pixel", "multiple", "bounce", "lead", "noise", "sample", "radiance", "we", "implement", "experimental", "step", "reduce", "variance", "perform", "quick", "reconstruction", "incident", "lighting", "secondary", "hit", "replace", "secondary", "hit", "radiance", "ACM", "transaction", "Graphics", "Vol", "31", "no.", "Article", "51", "publication", "date", "July", "2012", "reconstruct", "indirect", "light", "field", "global", "illumination", "51:9", "we", "reconstruction", "-lsb-", "Lehtinen", "et", "al.", "2011", "-rsb-", "Figure", "12", "close-up", "pinhole", "reconstruction", "from", "utter", "fly", "Lehtinen", "et", "al.", "-lsb-", "2011", "-rsb-", "do", "adapt", "local", "density", "input", "sample", "fail", "reconstruct", "marked", "region", "we", "novel", "visibility", "heuristic", "reproduce", "correct", "visibility", "reconstructed", "value", "before", "reconstruct", "incident", "lighting", "primary", "hit", "scene", "perform", "step", "16", "reconstruction", "ray", "add", "less", "than", "10", "execution", "time", "almost", "completely", "remove", "artifact", "result", "we", "reconstruction", "match", "ground", "truth", "closely", "accurately", "preserve", "boundary", "indirect", "shadow", "image", "antialiasing", "still", "miss", "because", "we", "have", "only", "one", "primary", "ray", "per", "pixel", "Notice", "black", "border", "near", "corner", "present", "ground", "truth", "pbrt", "render", "well", "glossy", "gi", "noisy", "sample", "should", "possible", "generalize", "recursive", "filter", "more", "reliable", "handling", "highly", "specular", "surface", "extreme", "clearly", "very", "useful", "reconstruct", "incident", "radiance", "onto", "mirror", "from", "sparse", "sample", "instead", "would", "make", "more", "sense", "reconstruct", "next", "path", "segment", "remove", "noise", "surface", "see", "mirror", "since", "we", "reconstruction", "work", "3d", "should", "possible", "extend", "walk", "forward", "path", "segment", "adaptively", "base", "angular", "bandwidth", "reflectance", "function", "information", "content", "we", "find", "interesting", "even", "very", "sparse", "input", "sampling", "can", "contain", "nearly", "all", "relevant", "information", "about", "visibility", "light", "transport", "particularly", "diffuse", "scene", "example", "diffuse", "ornell", "one", "input", "path", "per", "pixel", "allow", "essentially", "perfect", "reconstruction", "indirect", "illumination", "even", "much", "more", "complex", "iguel", "four", "sample", "per", "pixel", "yield", "very", "good", "reconstruction", "multi-layer", "material", "most", "realistic", "material", "model", "build", "from", "multiple", "layer", "would", "interesting", "extend", "we", "work", "reconstruct", "layer", "independently", "example", "varnished", "wood", "consist", "almost-diffuse", "base", "layer", "specular", "top", "layer", "two", "mixed", "accord", "fresnel", "term", "treat", "two", "layer", "separately", "would", "allow", "very", "broad", "reuse", "sample", "from", "base", "layer", "while", "glossy", "top", "layer", "could", "only", "use", "from", "narrow", "set", "direction", "overall", "would", "allow", "broader", "reuse", "than", "collapse", "layer", "beforehand", "select", "maximum", "bandwidth", "sample", "sheared", "filter", "contrast", "sheared", "reconstruction", "-lrb-", "temporal", "-rrb-", "light", "field", "-lsb-", "Egan", "et", "al.", "2009", "Egan", "et", "al.", "2011b", "-rsb-", "where", "reconstruction", "integration", "combine", "single", "large", "filter", "we", "perform", "integration", "over", "incident", "angle", "numerically", "allow", "we", "reason", "about", "anisotropy", "each", "input", "sample", "individually", "input", "-lrb-", "spp", "-rrb-", "ground", "truth", "-lrb-", "2048", "spp", "-rrb-", "we", "without", "recursive", "step", "we", "recursive", "step", "figure", "13", "multi-bounce", "indirect", "illumination", "Cornell", "box", "reconstruct", "from", "spp", "input", "recursive", "filter", "remove", "artifact", "corner", "prevent", "clean", "frequency", "analysis", "due", "non-translationinvariant", "nature", "we", "reconstruction", "filter", "however", "simple", "uniformly", "sample", "planar", "scenario", "we", "filter", "reduce", "earlier", "linear", "sheared", "formulation", "failure", "case", "propose", "algorithm", "can", "fail", "scene", "contain", "higher-frequency", "shading", "visibility", "than", "what", "input", "sampling", "rate", "can", "capture", "example", "sparse", "sampling", "hair", "probably", "suffice", "accurately", "describe", "its", "visibility", "shading", "case", "result", "reconstruction", "consistent", "input", "sampling", "may", "faithful", "original", "scene", "foliage", "we", "diffuse", "result", "example", "difficult", "visibility", "handle", "gracefully", "low", "sampling", "rate", "also", "distribution", "input", "ray", "which", "drive", "reflectance", "primary", "hit", "may", "insufficient", "capture", "very", "high-frequency", "angular", "effect", "-lrb-", "e.g.", "mirror", "-rrb-", "secondary", "hit", "would", "lead", "slight", "blur", "reconstructed", "light", "field", "Specialized", "hierarchy", "we", "bandwidth-aware", "k-nn", "produce", "hierarchy", "serve", "two", "purpose", "use", "resolve", "visibility", "also", "guarantee", "we", "find", "nearby", "splat", "similar", "angular", "support", "alternative", "design", "would", "have", "separate", "hierarchy", "two", "task", "design", "visibility", "hierarchy", "would", "ignore", "angular", "bandwidth", "implement", "shrink", "step", "second", "hierarchy", "would", "take", "bandwidth", "account", "omit", "shrink", "slightly", "more", "complicated", "approach", "could", "improve", "execution", "speed", "case", "very", "glossy", "material", "ACM", "transaction", "Graphics", "Vol", "31", "no.", "Article", "51", "publication", "date", "July", "2012", "51:10", "J.", "Lehtinen", "et", "al.", "acknowledgement", "we", "thank", "Guillermo", "Lleal", "Laguna", "San", "Miguel", "scene", "Fr?do", "Durand", "support", "National", "Science", "Foundation", "reference", "rvo", "J.", "IRK", "D.", "1987", "fast", "ray", "trace", "ray", "classification", "Computer", "Graphics", "-lrb-", "Proc", "ACM", "SIGGRAPH", "87", "-rrb-", "21", "55", "64", "alum", "K.", "ORSEY", "J.", "eller", "S.", "1999", "radiance", "interpolant", "accelerate", "bounded-error", "ray", "trace", "ACM", "Trans", "graph", "18", "213", "256", "ekaert", "P.", "BERT", "M.", "ALTON", "J.", "2002", "accelerate", "path", "trace", "re-use", "path", "Proc", "Eurographics", "Workshop", "Rendering", "2002", "125", "134", "haus", "j.-x.", "ong", "X.", "HAN", "S.-C.", "hum", "h.-y", "2000", "plenoptic", "sampling", "Proc", "ACM", "SIGGRAPH", "2000", "307", "318", "hristensen", "P.", "2008", "point-based", "approximate", "color", "bleeding", "Pixar", "Technical", "Memo", "08", "01", "ammertz", "H.", "ewtz", "D.", "ANIKA", "J.", "ENSCH", "H.", "P.", "A.", "2010", "edge-avoiding", "a-trous", "wavelet", "transform", "fast", "global", "illumination", "filter", "Proc", "high", "Performance", "Graphics", "2010", "67", "75", "urand", "F.", "OLZSCHUCH", "N.", "oler", "C.", "HAN", "E.", "ILLION", "F.", "X.", "2005", "frequency", "analysis", "light", "transport", "ACM", "Trans", "graph", "24", "1115", "1126", "GAN", "K.", "seng", "Y.", "OLZSCHUCH", "N.", "URAND", "F.", "AMAMOORTHI", "R.", "2009", "frequency", "analysis", "shear", "reconstruction", "render", "motion", "blur", "ACM", "Trans", "graph", "28", "93:1", "93:13", "GAN", "K.", "URAND", "F.", "AMAMOORTHI", "R.", "2011", "Practical", "filter", "efficient", "ray-traced", "directional", "occlusion", "ACM", "Trans", "graph", "30", "180:1", "180:10", "GAN", "K.", "ECHT", "F.", "URAND", "F.", "AMAMOORTHI", "R.", "2011", "frequency", "analysis", "shear", "filter", "shadow", "light", "field", "complex", "occluder", "ACM", "Trans", "graph", "30", "9:1", "9:13", "assenbauer", "V.", "RIV", "ANEK", "J.", "OUATOUCH", "K.", "2009", "spatial", "directional", "radiance", "caching", "Computer", "Graphics", "Forum", "28", "1189", "1198", "lassner", "a.", "1988", "Spacetime", "ray", "trace", "animation", "IEEE", "Computer", "Graphics", "application", "60", "70", "achisuka", "T.", "AROSZ", "W.", "EISTROFFER", "R.", "P.", "ALE", "K.", "UMPHREYS", "G.", "WICKER", "M.", "ENSEN", "H.", "W.", "2008", "multidimensional", "adaptive", "sampling", "reconstruction", "ray", "trace", "ACM", "Trans", "graph", "27", "33:1", "33:10", "saksen", "a.", "ILLAN", "L.", "ORTLER", "S.", "J.", "2000", "dynamically", "reparameterize", "light", "field", "Proc", "ACM", "SIGGRAPH", "2000", "297", "306", "ELLER", "A.", "1997", "instant", "radiosity", "Proc", "ACM", "SIGGRAPH", "97", "49", "56", "ONTKANEN", "J.", "abellion", "E.", "VERBECK", "R.", "2011", "coherent", "out-of-core", "point-based", "global", "illumination", "Computer", "Graphics", "Forum", "30", "1353", "1360", "ehtinen", "J.", "ILA", "T.", "HEN", "J.", "AINE", "S.", "URAND", "F.", "2011", "temporal", "light", "field", "reconstruction", "render", "distribution", "effect", "ACM", "Trans", "graph", "30", "55:1", "55:12", "ool", "M.", "D.", "1999", "anisotropic", "diffusion", "Monte", "Carlo", "noise", "reduction", "ACM", "Trans", "graph", "18", "171", "194", "VERBECK", "R.", "ONNER", "C.", "AMAMOORTHI", "R.", "2009", "adaptive", "wavelet", "rendering", "ACM", "Trans", "graph", "28", "140:1", "140:12", "harr", "m.", "umphrey", "G.", "2010", "physically", "base", "rendering", "2nd", "ed", "Morgan", "Kaufmann", "amamoorthus", "R.", "AHAJAN", "D.", "ELHUMEUR", "P.", "2007", "first-order", "analysis", "lighting", "shade", "shadow", "ACM", "Trans", "graph", "26", "2:1", "2:21", "itschel", "T.", "NGELHARDT", "T.", "ROSCH", "T.", "eidel", "h.-p.", "AUTZ", "J.", "ACHSBACHER", "C.", "2009", "micro-render", "scalable", "parallel", "final", "gathering", "ACM", "Trans", "graph", "28", "132:1", "132:8", "ousselle", "F.", "NAUS", "C.", "wicker", "M.", "2011", "adaptive", "sampling", "reconstruction", "use", "greedy", "error", "minimization", "ACM", "Trans", "graph", "30", "159:1", "159:12", "chaufler", "G.", "ANN", "ENSEN", "H.", "2000", "Ray", "trace", "point", "sample", "geometry", "Proc", "Eurographics", "Workshop", "Rendering", "2000", "319", "328", "en", "P.", "ARABI", "S.", "2011", "implementation", "random", "parameter", "filter", "Tech", "Rep.", "EECE-TR-11-0004", "University", "New", "Mexico", "en", "P.", "ARABI", "S.", "2012", "filter", "noise", "from", "random", "parameter", "monte", "carlo", "render", "ACM", "Trans", "Graph.", "appear", "oler", "C.", "ubr", "K.", "URAND", "F.", "OLZSCHUCH", "N.", "ILLION", "F.", "2009", "fourier", "depth", "field", "ACM", "Trans", "graph", "28", "18:1", "18:12", "ALTER", "B.", "ernandez", "S.", "rbree", "a.", "alum", "K.", "ONIKIAN", "M.", "REENBERG", "D.", "P.", "2005", "Lightcuts", "scalable", "approach", "illumination", "ACM", "Trans", "graph", "24", "1098", "1107", "ANN", "ENSEN", "H.", "1996", "global", "illumination", "use", "photon", "map", "Proc", "Eurographics", "Workshop", "Rendering", "96", "21", "30", "ARD", "G.", "J.", "UBINSTEIN", "F.", "M.", "lear", "R.", "D.", "1988", "ray", "trace", "solution", "diffuse", "interreflection", "Computer", "Graphics", "-lrb-", "Proc", "ACM", "SIGGRAPH", "88", "-rrb-", "85", "92", "wicker", "M.", "fister", "H.", "VAN", "AAR", "J.", "ross", "M.", "2001", "surface", "splatting", "Proc", "ACM", "SIGGRAPH", "2001", "371", "378", "ACM", "transaction", "Graphics", "Vol", "31", "no.", "Article", "51", "publication", "date", "July", "2012" ],
  "content" : "\n  \n    40e3bfa5bb2f263e2695e0ae37dbae257d17037c4139f0c8e1b7b016f085870b\n    p2c\n    10.1145/2185520.2185547\n    Name identification was not possible. \n    Original PDF was found to be an image-based/possible OCR document. Output quality may be degraded.\n  \n  \n    \n      \n        Reconstructing the Indirect Light Field for Global Illumination\n      \n      Jaakko Lehtinen NVIDIA Research\n      Timo Aila NVIDIA Research\n      Stochastic techniques for rendering indirect illumination suffer from noise due to the variance in the integrand. In this paper, we describe a general reconstruction technique that exploits anisotropy in the light field and permits efficient reuse of input samples between pixels or world-space locations, multiplying the effective sampling rate by a large factor. Our technique introduces visibility-aware anisotropic reconstruction to indirect illumination, ambient occlusion and glossy reflections. It operates on point samples without knowledge of the scene, and can thus be seen as an advanced image filter. Our results show dramatic improvement in image quality while using very sparse input samplings. Keywords: light field, reconstruction, indirect illumination, ambient occlusion, defocus, motion blur\n      Links: DL PDF W EB C ODE\n    \n    \n      \n        1 Introduction\n        \n          1.1 Related Work\n        \n      \n      When generating digital images by simulating light transport, each pixel is computed as an integral of a multidimensional radiance function whose dimensions range over image xy, the lens (depth of field), time (motion blur), incident angle (indirect illumination and glossy reflection), and light source (area lighting). Such integrals are typically computed using Monte Carlo sampling. Evaluating the indirect illumination entails sampling the radiance over the hemisphere at each visible point, and is notoriously prone to noise due to the high variance of the integrand caused by visibility, texture, and illumination. We seek to generate high-quality images featuring glossy reflections and indirect illumination by intelligently reusing the samples drawn by a stochastic renderer at only a few samples per pixel. We cast the problem as that of reconstructing an indirect light field at shading points, based on samples recorded during an initial coarse sampling step. The reconstructed light field is then used in a standard BRDF sampling step to generate the final image. We assume proper importance sampling is applied, but require no control over how the samples are generated. Throughout the paper, we assume direct illumination is computed using other techniques. We build on recent work that has provided a solid understanding of the local anisotropies exhibited by the temporal light field [Durand et al. 2005; Ramamoorthi et al. 2007; Egan et al. 2009; Soler et al. 2009; Egan et al. 2011b]. But while previous sampling schemes and anisotropic reconstruction filters can capture the essence of the\n      ACM Reference Format Lehtinen, J., Aila, T., Laine, S., Durand, F. 2012. Reconstructing the Indirect Light Field for Global Illumination. ACM Trans. Graph. 31 4, Article 51 (July 2012), 10 pages. DOI = 10.1145/2185520.2185547 http://doi.acm.org/10.1145/2185520.2185547.\n      Copyright Notice Permission to make digital or hard copies of part or all of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or direct commercial advantage and that copies show this notice on the fi rst page or initial screen of a display along with the full citation. Copyrights for components of this work owned by others than ACM must be honored. Abstracting with credit is permitted. To copy otherwise, to republish, to post on servers, to redistribute to lists, or to use any component of this work in other works requires prior specific permission and/or a fee. Permissions may be requested from Publications Dept., ACM, Inc., 2 Penn Plaza, Suite 701, New York, NY 10121-0701, fax +1 (212) 869-0481, or permissions@acm.org . ? 2012 ACM 0730-0301/2012/08-ART51 $15.00 DOI 10.1145/2185520.2185547 http://doi.acm.org/10.1145/2185520.2185547\n      \n        \n      \n      Samuli Laine NVIDIA Research\n      Fr?do Durand MIT CSAIL\n      Input (8 spp) Our reconstruction Path tracing (512 spp)\n      \n        Figure 1: We demonstrate that even very noisy and sparse samplings can contain surprisingly much information about light transport and visibility in the scene. In this example, diffuse indirect illumination was reconstructed from 8 input samples per pixel.\n      \n      integrand better than naive point sampling in situations such as motion blur, depth of field, and area lighting, the case for general indirect illumination remains unsolved due to complex visibility, highly irregular input sampling, and glossy materials. We contribute a method for adapting to the sampling rate of nonuniform, sparse, uncontrolled input in both space and angle, a spatio-angular anisotropic reconstruction method for filtering radiance from the sparse samples, and a robust method for reasoning about occlusion based on only the input rays. In contrast to a large body of previous work aiming to reduce noise in global illumination, we do not utilize the scene geometry in the reconstruction pass. This gives us the crucial advantage that performance is only weakly dependent on the scene. In this sense, our algorithm can be seen as an advanced image filter. Our algorithm produces megapixel images with glossy reflection, global illumination, and ambient occlusion in a few minutes. The results are of dramatically higher quality than was possible using earlier reconstruction methods, and comparable to using hundreds of paths per pixel ( Figure 1 ) both visually and in terms of PSNR.\n      Anisotropic reconstruction Image synthesis involves integrating a high-dimensional function across the image and auxiliary dimensions (time, lens, incident angle, etc.). A body of recent work concentrates on anisotropy, i.e., the fact that the signal often varies slowly along certain non-axis-aligned subspaces. Fourier analysis elegantly reveals that the signal is locally effectively of a lower dimension 1 in these cases [Durand et al. 2005; Egan et al. 2009]. This means that samples drawn at one pixel tell us something about the integrand at other pixels as well, which enables reconstruction of better images from the same samples. The recent trend in anisotropic reconstruction can be traced back to the Multidimensional Adaptive Sampling and Reconstruction (MDAS) algorithm of Hachisuka et al. [2008]. While numerous earlier techniques had addressed the generation of samples according to the expected variance in the integrand (importance sampling and adaptive sampling methods), Hachisuka et al. concentrated on\n      1 For example, the 4D integrand over the image and the lens that corresponds to a diffuse fronto-parallel planar object that is out of focus is actually only two-dimensional.\n      ACM Transactions on Graphics, Vol. 31, No. 4, Article 51, Publication Date: July 2012\n      51:2\n      ?\n      J. Lehtinen et al.\n      reconstruction. The authors measure the local anisotropy from the samples using a structure tensor, and use it for locally warping the distance metric used for reconstructing the integrand using a highdimensional k-nearest-neighbor search (k-NN). This can yield significant benefits, but unfortunately, noise and texture may confuse the anisotropy estimator. Egan et al. [2009] analyzed the anisotropy in the spacetime integrand of motion blur from first principles through Fourier analysis, and used predictions of the local spectra for driving adaptive sampling. A sheared filter that allows sharing of samples between pixels was then adapted to the predicted spectra. Similar analysis and algorithms were presented for soft shadows and directional occlusion by the same authors [Egan et al. 2011b; Egan et al. 2011a]. While the analysis is successful in driving adaptive sampling, the sheared reconstruction filter is less efficient when the direction of anisotropy changes, either continuously or discontinuously, across the image. This issue is evident, e.g., in occlusion discontinuities, and force a fallback to QMC sampling. These issues are addressed by Lehtinen et al. [2011], whose algorithm accounts for both the individual anisotropy information of each sample and discontinuities due to visibility, producing high-quality results for simultaneous motion blur, depth of field, and area lighting. The goal of the present work is to extend this approach to the more challenging and unstructured case of indirect illumination.  Sample-based algorithms Several techniques, e.g., anisotropic diffusion [McCool 1999] or a (cascade of) cross-bilateral filter(s) [Dammertz et al. 2010], post-process the samples or pixels generated in an initial rendering pass to reduce noise. Sen and Darabi [2012] improve the quality of cross-bilateral filters by computing the weights adaptively for each pixel based on apparent dependencies between domain variables, scene features, and sample colors. While their method can, for example, detect that samples in some pixels are heavily affected by time, it does not know the magnitude or direction of the motion. Overbeck et al. [2009] and Rousselle et al. [2011] describe methods that maintain a basis-representation of the image and adaptively request more samples from the renderer to the areas that exhibit high variance. Shading reuse Several algorithms reuse shading results, radiance or irradiance, while determining visibility with the actual scene [Ward et al. 1988; Bala et al. 1999; Bekaert et al. 2002; Gassenbauer et al. 2009]. Sampling is often adaptive and driven by an error heuristic. In contrast, we do not adapt the sampling but instead post-process the samples given to us by a separate renderer, run no lightor scene-dependent preprocessing stages, and do not require the scene to be resident in the reconstruction phase. This makes our algorithm much less intrusive for the original renderer. Geometric resampling Our method for reasoning about occlusion based on samples from the initial sampling has also connections to ray tracing point-based geometry [Schaufler and Wann Jensen 2000; Christensen 2008; Ritschel et al. 2009]. These algorithms convert the scene to a point-based representation as a preprocess, and then compute the solution using that representation. In contrast, we obtain a sparse set of path segments from a renderer (which uses whatever representation internally), treat the segments as samples of the indirect light field, and upsample the solution accounting for angular effects of gloss. Photons and VPLs Some methods generate a cloud of point lights (called photons or virtual point lights or VPLs) that represents the entire indirect light field [Wann Jensen 1996; Keller 1997; Walter et al. 2005]. They can be seen as a resampling of the in- tegrand to a form more amenable to final gathering. The original scene is still necessary for visibility determination.\n      primary hit secondary hit primary ray camera secondary ray reconstruction ray angular support (corresponds to bandwidth)\n      \n        Figure 2: Input data consists of primary and secondary hit points with corresponding surface normals, the radiance along the secondary rays, and an angular bandwidth estimate of the reflectance function at the secondary hits.\n      \n      \n        2 Reconstruction of Indirect Light Field\n        We seek to render high-quality global illumination while only tracing a small number of rays across the hemisphere at each visible point. We reuse these rays across many pixels to reconstruct, at each visible point, an upsampled version of the incoming light field. The reuse is facilitated by the anisotropy exhibited by the incident light field [Durand et al. 2005]: provided we can quantify visibility and angular effects, radiance leaving a point along a ray provides information about radiance carried by other, nearby rays. For the entire paper, we disregard direct illumination, and assume it to be computed separately.  Algorithm overview In a first pass, we use a standard path tracer, but only draw few samples per pixel, typically 4?16. We store the rays cast from the visible points into a spatial hierarchy, indexed by their hit point (Section 2.1). Each ray is a sample of the indirect light field. After this, we compute, for each input sample, a spatial radius of influence that determines how far it will contribute to light field reconstructions, adapting to the density of input samples in both space and angle (Section 2.2). We describe a modified k-NN technique that adapts to the density while accounting for tradeoffs between space and angle as determined by BRDF gloss. Furthermore, we need to treat visibility carefully to avoid the ?fattening? of small features and silhouettes when performing reconstruction. We introduce an important step that shrinks the samples if they violate the visibility of input rays (Section 2.3). In the second pass, we evaluate the shading equation at each visible point using a high-sampling-rate reconstruction of the incoming hemisphere. The key operation is a reconstruction of the 4D incoming light field along a given ray. For this, we find all input rays whose spatial radius overlaps the ray and group them into apparent surfaces using a visibility heuristic (Section 2.3.2). This handles two dimensions of the light field. We then reconstruct radiance from the remaining samples closest in angle in order to handle the remaining two dimensions (Section 2.4).\n      \n      \n        2.1 Input and Output\n        The radiance L from point p towards the camera c is computed by\n        \n          1\n          1 L(p ? c) = L in (p ? ?) f r (p, ? ? ? c ) cos ? d?, ?\n        \n        ACM Transactions on Graphics, Vol. 31, No. 4, Article 51, Publication Date: July 2012\n        Reconstructing the Indirect Light Field for Global Illumination\n        ?\n        51:3\n        where L in (p ? ?) is the light field incident to p from direction ?, f r (p, ? ? ? c ) is the reflectance function (we disregard transmittance for simplicity), and the integral is taken over the positive hemisphere around the normal of p. The first pass computes and stores samples of L in (p ? ?) using a path tracer. Each input sample s i corresponds to a secondary ray, and consists of the tuple  where L is radiance, o and h are the origin and hit point of the secondary ray, n o,h and v o,h are their corresponding normals and motion vectors. The numbers {x, y, u, v, t, ?} are the image, lens, and time coordinates, and the incident direction in which L(o ? ?) was sampled. To support angular variation of outgoing illumination on glossy surfaces, we also store a measure of the angular bandwidth determined from the outgoing slice of the BRDF at the hit point. We use an unnormalized spherical von Mises-Fisher distribution\n        s : {x, y, u, v, t, ?} ? {L, o, h, n o , n h , v o , v h , ?},\n        \n          2\n          A i (?) = exp(? i (? i ? ?) ? ? i )\n        \n        and store ?, its concentration parameter. In particular, ? = 0 for a diffuse surface and increases with gloss (Section 2.5). Together, the input consists of an irregular set of ray segments that coarsely samples the indirect light field ( Figure 2 ). Given the samples recorded in the first pass, the second pass evaluates\n        \n          3\n          L out (p ? c) ? N 1 1 R ECONSTRUCT (p, ? j ) f r (p, ? j ? ? c ) cos ? ? N j=1\n        \n        for each primary hit in the input samples, with N 1. The total number of reconstruction rays per pixel is thus N ? n, where n is the number of primary hits per pixel. The function R ECONSTRUCT (p, ?) performs the upsampling of the incident light field based on the input samples.  Assumptions We assume that proper importance sampling is applied in the input stage. This guarantees that the distribution of rays generated during the final image reconstruction is similar to that in the input. Because we cannot hope to recover features not present in the input, we make the assumption that the input samples faithfully represent the true indirect light field, i.e., that they capture its frequency content. As the density of the input samples is a complex function of the scene, its materials, and the sampler used in the original renderer, we do not reason about it a priori, but instead discover the local sampling rate by a modified k-nearest-neighbors search (Section 2.2). We discuss possible noise in the radiance values L in Section 4. We employ a standard light field parameterization, where rays are encoded by their intersections with two planes: an st plane, and an uv plane at unit distance from the former. We use the variant where uv coordinates are measured relative to the st coordinates [Chai et al. 2000; Durand et al. 2005] and essentially form a linearized angle. As we seek to reconstruct rays within arbitrary locations and directions in the scene, we internally store the ray segments using their 3D hit point, and dynamically reparameterize the light field around our reconstruction rays [Isaksen et al. 2000].\n        u\n        Glossy surface u Narrow s s\n        \n          \n          Figure 3: Shapes of reconstruction filters in a local parameterization around the samples (shown in blue). We use the known angular bandwidth to drive a modified k-nearest-neighbors search, where each sample finds the kth sample that falls within acceptable angular limits. This results in spatially narrow samples on diffuse surfaces (left), and wide samples on glossy surfaces (right).\n        \n      \n      \n        2.2 Sampling Rate\n        The spatial and angular distribution of the input samples is determined by the scene geometry and the reflectance functions of the primary hits, as the input renderer performs importance sampling according to them. In order to perform meaningful reconstructions, we have to adapt to this sampling rate in both space and angle. As our input carries information about the angular variation in form of the bandwidth estimate, it remains to balance the known angular support with the spatial support. Specifically, for diffuse surfaces, where outgoing radiance does not vary over angle, the radiance of the input sample can be reused for any reconstruction ray that passes near the sample in space, no matter how far in angle, provided visibility is accounted for. For glossy surfaces, where radiance varies over angle, we might need to go further in space to find an input sample whose direction better matches that of the reconstruction ray. Along the lines of previous point-based rendering algorithms, we treat the input samples as circular disks (splats) in 3D on their individual tangent planes. We determine their size by analyzing the local sample density. To set the spatial support w i for sample s i , we search for its kth nearest neighbor in space around its secondary hit point h i , but only considering samples s j whose direction ? j falls close enough to ? i . The angle threshold is determined from ? i by requiring A i (? j ) ? 0.5. To illustrate the effect, first consider an almost diffuse surface. As the radiance varies slowly over outgoing direction, A i is almost constant in angle (angular bandwidth is low and consequently ? is small), and the search simplifies to a regular k-NN in space. Consequently, the spatial support will be small ( Figure 3 , left). On a more glossy surface, the angular bandwidth is higher, causing the k-NN search to disregard spatially close-by samples in favor of those closer in angle. Consequently, the support will be wider in space ( Figure 3 , right). We use a metric that penalizes movement in the direction of the normal to encourage the search for support to favor samples lying on locally flat regions. Specifically, we use a Mahalanobis distance that squashes the distance along the normal of each splat by a factor of ? (we use ? = 3). This is implemented simply as computing the Euclidean length of (p ? q) + (? ? 1)((p ? q) ? n)n, where n is the normal.\n      \n      \n        2.3 Visibility\n        In addition to spatial filtering, the circular splats are used for resolving visibility. When performing reconstruction, we need to gather all input samples whose spatial support is intersected by the reconstruction ray, reminiscent of previous point-based rendering algo-\n        ACM Transactions on Graphics, Vol. 31, No. 4, Article 51, Publication Date: July 2012\n        51:4\n        ?\n        J. Lehtinen et al.\n        Without shrink After shrink Ground truth\n        \n          Figure 4: We need to shrink some samples so that the representation remains faithful to the original sampling. This is a closeup of ambient occlusion in S AN M IGUEL , shown fully in Figure 8 .\n        \n        rithms [Schaufler and Wann Jensen 2000]. To accelerate this, we organize the secondary hit points {h i } into a motion bounding volume hierarchy [Glassner 1988] using the streaming algorithm of Kontkanen et al. [2011]. During reconstruction, the hierarchy is used in a standard fashion by walking the BVH and intersecting the reconstruction ray with the splats in the intersected leaf nodes.\n        \n          2.3.1 Ensuring Consistent Visibility\n          \n            \n          \n          In order for our reconstructions to be accurate, the visibility function induced by the splats should resemble true occlusion in the scene. However, the preceding k-NN procedure does not guarantee consistency with the original sampling. Small geometric features (e.g. leaves of a plant) might only be hit by few input samples, and when these get enlarged by the k-NN procedure, some rays present in the input might erroneously intersect them. To force the representation to be consistent with the input, we observe that the input rays carry exact information about point-wise visibility in the scene: we know, with certainty, that a ray from o i terminated at h i without being blocked in between. Inspired by this, we retrace all the input rays using the BVH and shrink splats that intersect rays they should not. Finally, the bounding boxes of the BVH nodes are recomputed to accommodate the new sizes. This concludes the preprocessing of the input samples. The resulting splats faithfully represent the visibility as determined by the original secondary rays, while adapting to their local density and causing no spurious occlusions, cf. Figure 4 .\n        \n        \n          2.3.2 Resolving Occlusion\n          Treating the splats as simple opaque occluders leads to unacceptable results, and more sophisticated techniques are required for determining which splats are part of the same surface [Zwicker et al. 2001] to allow filtering between samples. When reconstructing the radiance for a reconstruction ray, we first traverse the BVH and collect all input samples whose spatial support overlaps the reconstruction ray. Once these have been found, the samples are sorted according to distance from the ray origin, and then grouped into apparent surfaces. The grouping proceeds greedily by adding the next sample to the open surface as long as it does not conflict with any of the samples already in the surface in terms of visibility. When a visibility conflict is detected (see below), a new surface is started. Note that the operation is entirely local: it does not make use of samples whose supports are not intersected by the reconstruction ray. To detect visibility conflicts, we generalize the heuristic of Lehtinen et al. [2011] that detects crossings of trajectories in the light field for defocus and motion blur. A geometric interpretation of their test is that two samples belong to different surfaces if an event  line, defined as the line that goes through the scene points corresponding to the samples, intersects the lens. However, when reconstructing the incident light field on the surfaces, the concept of lens is meaningless. In addition, our rays originate from and terminate at arbitrary 3D points in the scene. Our visibility heuristic works by considering the positive halfspaces, i.e., points x where (x ? h) ? n h > 0, defined by the hit point and normal of each input sample. Visibility conflicts are detected by computing the intersection of the st plane and the event line formed by connecting the two endpoints h i and h j . If the intersection point lies within the positive halfspaces of both samples, a conflict is declared, cf. Figure 5 . This approach detects a conflict when two surfaces that are on top of each other, but allows blending of samples that come from the same locally flat, convex, or concave surface.\n          Visibility Conflict st uv\n          +-\n          event ++ event line line 2 ray sample 2 sample 1 origin sample 1\n          \n            Figure 5: Determining visibility consistency for a reconstruction ray (purple). Left: The event line drawn through the hit points of samples 1 and 2 intersects the local st plane (white circle) outside the region of space where both samples face forward. Consequently their mutual visibility is determined to be consistent and the samples belong to the same apparent surface. Right: The event line intersects the lens in the positive half-space of both samples. The samples are determined to belong to different surfaces.\n          \n        \n      \n      \n        2.4 4D Reconstruction\n        Once the visibility heuristic has been evaluated and the samples grouped into apparent surfaces, the samples in the nearest apparent surface are input rays whose hit points are determined to be visible from the origin of the reconstruction ray. It now remains to reconstruct the radiance based on their locations and directions. This requires adapting to the anisotropy and bandwidth of the light field around the reconstruction ray. Consider a situation where a reconstruction ray intersects the spatial supports of three samples ( Figure 6 , left). In a local two-plane parameterization stuv constructed around the reconstruction ray, the reconstruction ray corresponds to a point at the origin ( Figure 6 , middle), and each input ray corresponds to a single point. For each input sample, the set of all rays that intersect the spatial support forms a set with planar boundaries ( Figure 6 , middle). Clearly, the reconstruction ray belongs to this set. For a diffuse surface, where angular bandwidth is zero, reconstruction is simple: we evaluate a spatial filter (tent in our implementation) at the intersection of the reconstruction ray and the splat, and take a weighted average among all samples. In a local coordinate system centered at each sample ( Figure 3 , left), this corresponds to a separable 4D filter that is the product of a tent in space and a constant in angle (corresponding to the zero angular bandwidth), and reparameterization to the stuv coordinates around the reconstruction ray shears this filter into the anisotropic shape shown ( Figure 6 , middle). Radiance leaving glossy surfaces varies over outgoing angle, and we need to account for it by reusing samples whose direction is similar to that of our reconstruction ray. The non-zero angular bandwidth of glossy samples leads to a wider spatial support as a result of the bandwidth-aware k-NN search. In a local coordinate system oriented with each sample, this is visible as a narrower angular filter that is wider in space ( Figure 3 , right). When this filter is transformed into the stuv coordinate system, we obtain anisotropic shapes oriented similarly to the diffuse filters ( Figure 6 , right). We perform reconstruction by evaluating the transformed filters at the stuv origin, and picking the sample whose filter has the largest magnitude. This can be seen as an anisotropic nearest neighbor filter. We use nearest neighbor for glossy surfaces to mitigate the effects of the highly non-uniform angular distribution of our input samples. Using a linear angular filter noticeably shifts the reconstruction towards the denser sampling, which is visible in the final image as shifting highlights: angular shifting results in spatial shifts after propagation. This is not necessary for diffuse reflectance where outgoing angle plays no role. Discussion Our filtering scheme accounts for both spatial and angular bandwidth of the outgoing light field at the input samples. The spatial and angular dimensions are balanced by the k-NN algorithm used for determining the spatial supports for the samples. Effects such as curvature and the anisotropy of the incident light field (for instance, near-field illumination) at the sample points play a role in how space and angle interact in the outgoing light field, potentially causing additional shears [Durand et al. 2005]. As our samples lie on the actual curved surfaces, our input as a whole contains these effects. But as our input does not carry information about the curvature and the properties of the incident light field, the reconstruction filters of the individual samples cannot account for the additional shears. Regardless, our treatment allows faithful reconstruction of glossy surfaces reflecting off other glossy surfaces. This is demonstrated in the results. When the reconstruction ray points towards a fronto-parallel surface with uniform angular sampling, our reconstruction procedure corresponds to performing nearest neighbor in space that has been warped using a Mahalanobis distance aligned with the anisotropy of the light field ? this renders the isocontours of the filters locally isotropic.\n        ACM Transactions on Graphics, Vol. 31, No. 4, Article 51, Publication Date: July 2012\n        Reconstructing the Indirect Light Field for Global Illumination\n        ?\n        51:5\n        sample 1 u u sample 2 rec. ray reconstruction ray s s sample 3 st uv sample ray Primal domain Diffuse surface anisotropic narrow spatial filter\n        \n          Figure 6: 4D reconstruction from visible samples. Left: The reconstruction ray (purple) intersects three samples. Middle: If the samples lie on a diffuse surface, their angular bandwidth is zero. The samples are filtered by evaluating a spatial tent filter at the intersection of the ray with the splat. Right: Glossy surface (see text).\n        \n      \n      \n        2.5 Implementation Details\n        In our prototype implementation, we support the Torrance-Sparrow BRDF model with the Blinn microfacet distribution (the ?Metal? material in PBRT), and take ? = 4 1/r where r is the roughness parameter of the Blinn distribution [Pharr and Humphreys 2010]. The formula is chosen empirically.  Since PBRT treats geometric primitives as two-sided, we need to do the same. When a reconstruction ray hits a back-facing splat, it contributes to visibility similarly to front-facing splats. However, back-facing splats contribute to radiance only if all splats of the first surface are back-facing, otherwise their radiance contribution is ignored. In rare occasions, a reconstruction ray may hit a surface that consists of only one or two samples. Although the k-NN search tries to guarantee that this never happens, the subsequent shrinking may affect the result. This happens, for instance, inside dense foliage where individual leaves may be hit by only one input sample. To avoid over-estimating the occlusion, we empirically reduce the splat size by 1 for single-sample surfaces and by 1 for two-sample sur2 3 faces when such undersampling is detected. This treatment affects less than 1% of the reconstruction rays in our scenes. The reconstruction results are not particularly sensitive to the choice of k, and we use k = 12 in all examples of this paper.\n        u u u u s s s s Glossy surface (anisotropic angular filter wider in space)\n      \n      \n        3 Test Results\n        We have implemented our algorithm as a standalone library that takes a buffer of samples as input, and modified PBRT [Pharr and Humphreys 2010] to generate the input. We have produced both a multicore CPU and a GPU implementation of the reconstruction algorithm, and our test platform is a 3.2GHz quad core Intel Core i7 and NVIDIA GTX480. All result images were rendered at 1280?720 (720p). In this section, we first test reconstruction of indirect illumination in diffuse scenes, followed by glossy reflections. We then perform more targeted tests and demonstrate that our occlusion heuristic allows faithful reproduction of visibility. We use ambient occlusion as a test case because its quality is directly determined by the accuracy of visibility. Finally, we show results for defocus and motion blur. We focus on the quality of the reconstructed images, and postpone discussion about scalability, memory consumption, and extensions to Section 4. We compare our results to methods that, similarly to us, reconstruct the image based on a small number of ?fat? samples [Lehtinen et al. 2011; Dammertz et al. 2010; Sen and Darabi 2012]. The auxiliary material contains all of the uncompressed images that are shown or referred to in this section.\n      \n      \n        3.1 Indirect Illumination in Diffuse Scenes\n        We reconstruct multi-bounce diffuse global illumination in S AN M IGUEL lit with an area light source ( Figure 7 ). The input contains 8 samples per pixel (leftmost inset). We reconstruct the incident light field over the hemisphere at visible points, and integrate to produce the result (third inset from the left), as per Equation 3. We pay no special attention to the fact that the radiances L of the input samples contain noise due to the multiple bounces rendered by the path tracer. Our reconstruction is more true to ground truth (second left) than the comparison methods, A-Trous wavelets [Dammertz et al. 2010] (fourth inset from left) and random parameter filtering (RPF, last one on right) [Sen and Darabi 2012]. We use both comparison methods for reconstructing incident irradiance, i.e., before multiplication by texture. Rendering the 8 spp input with PBRT takes 36.6s. Our reconstruction with 256 reconstruction rays per pixel on the GPU takes 189.5s. Of this, preprocessing, including building the BVH, sizing the samples using k-NN, and shrinking the samples using the input rays takes 9.5s. The rest is spent on reconstruction rays. This is considerably more efficient than rendering the similar-quality 512 spp image with PBRT, which takes 3910.5s, or 18x longer than combined input+reconstruction. Our 256 spp result exhibits significantly less noise than PBRT?s 256 spp rendering, thanks to our spatial filtering of the samples. Notice that our ability to perform image antialiasing is limited by the number of primary hits in the input samples. The supplemental video contains a short animation rendered from 8 input samples per pixel using 512 reconstruction rays per pixel. Each frame is processed in isolation; no temporal filtering of any kind is employed. The result demonstrates the temporal stability of our reconstruction even from severely noisy input. Comparison methods A-Trous is an iterative approximation to a cross-bilateral filter, with the twist that when spatial support widens between iterations, the range filters tighten. This allows the application of a very large spatial filter without disproportionate blurring. The original implementation uses three range filters: color, normal, and world-space position. Since our input is very noisy, and we do not wish to clamp the input samples? energies, we chose not to use color as a range filter (using it gave worse results). While the quality leaves some room for improvement, the A-Trous filter is efficient: our CPU implementation takes 58s in this scene. Since no reference implementation of random parameter filtering (RPF) is available, we reimplemented it by following the authors? detailed guidelines [Sen and Darabi 2011]. RPF is a sophisticated cross-bilateral filter that automatically tunes the weights for each feature, at each pixel, based on mutual information between domain variables, scene features (position, normal, texture, etc.), and radiance. Their input samples are almost identical to ours. Unfortunately, the original formulation of RPF makes heavy use of the color channel as a range filter, requiring special treatment for bright samples (?HDR clamp?), which essentially discards high-energy spikes. This loses a significant amount of energy, up to 50% in our tests. We modified their algorithms to reinsert the lost energy evenly to all samples within the pixel. Our reasonably tuned CPU implementation filters the image in 2895s, roughly in line with their results. We estimate a 10x possible speedup from a GPU port. We use the parameters recommended in the authors? guidelines.\n        ACM Transactions on Graphics, Vol. 31, No. 4, Article 51, Publication Date: July 2012\n        51:6\n        ?\n        J. Lehtinen et al.\n      \n      \n        3.2 Glossy Reflection\n         Figure 9 shows M ONKEY H EADS , a scene with three statuettes of decreasing gloss 2 on a glossy ground plane. The scene is lit by single-bounce indirect illumination from a distant point light source (direct illumination not shown), and consequently the input samples are noise-free. The input contains 8 samples per pixel. Our result is computed using 512 reconstruction rays per pixel. A-Trous and RPF results are shown below. We noticed the results for A-Trous\n        2 The roughnesses are 0.01, 0.05 and 0.25 for the statuettes and 0.01 for the ground plane.\n        could be significantly improved by introducing an additional range filter over the normal of the secondary hit, which is conveniently present in our data. We present this extension in our comparison results in addition to the original algorithm. Our results are significantly closer to ground truth than either comparison method both visually and in terms of PSNR (38.6dB vs. 31?33dB). The full-size images are provided in the auxiliary material for closer inspection. In particular, we reconstruct the position and sharpness of the reflections faithfully, thanks to the 4D treatment of the input samples that accounts for both space and angle. Figure 10 demonstrates the importance of accounting for angular effects. While the comparison methods produce smooth results, the reflections have shifted noticeably and are not as sharp as they should. Note that unlike the comparison methods, we use the rendering system (PBRT) to evaluate the BRDFs of the final bounce towards the eye, as per Equation 3. While closely matching ground truth, our algorithm is currently 2.6x slower in this scene than the reference method. This is mainly due to the extreme geometric simplicity of the scene, which plays to our disadvantage because our algorithm scales weakly with scene complexity (Section 4). Our spatial hierarchy does not currently include angular subdivisions [Arvo and Kirk 1987], and we may therefore process redundant splats on glossy surfaces, where the spatial supports are larger (Section 2.2). Another possible improvement is discussed in Section 4. Regardless, the result demonstrates that the information required for reconstructing high-quality reflections is present in the sparse input, and that our algorithm correctly extracts it to produce a high-quality result.\n      \n      \n        3.3 Ambient Occlusion\n        Our algorithm can be easily used for rendering ambient occlusion by bypassing the radiance filter and thresholding the distance to the closest apparent surface found. Figure 8 shows our ambient occlusion reconstruction in S AN M IGUEL . Although the scene contains fine geometric features such as grooves and vegetation, our reconstruction from only 4 input samples per pixel is in very close agreement with the ground truth computed using 2048 samples per pixel. In this case, image antialiasing is particularly limited since the input contains only 4 primary hits per pixel. The GPU execution time was 145 seconds for 256 reconstruction rays per pixel at 720p. In contrast to the ambient occlusion technique of Egan et al. [2011a], we do not resort to brute force Monte Carlo sampling of the original scene at all.\n      \n      \n        3.4 Motion and Defocus\n        Finally, we demonstrate the generality of our reconstruction by applying it to motion blur and defocus ( Figure 11 ). Specifically, instead of secondary rays, we now store the primary rays cast from a lens, and reconstruct the incident temporal light field at different points on the lens instead of indirect lighting at scene points. We use the B UTTERFLIES dataset from Lehtinen et al. [2011] and compare against their publicly available implementation. Our result is slightly more accurate, approx. 1 dB in terms of PNSR. The images are available in the supplemental material. Our better result is explained by our better adaptation to the input sampling rate. They use a worst-case radius derived from the dispersion of the sampling pattern, which tends to blur in-focus geometry slightly, but may still result in lack of support in regions of the temporal light field that contain features that are visible from only a small fraction of the lens and shutter interval. In contrast, our k-NN approach adapts to the local sampling density, leading to sharp results in well-\n        ACM Transactions on Graphics, Vol. 31, No. 4, Article 51, Publication Date: July 2012\n        Reconstructing the Indirect Light Field for Global Illumination\n        ?\n        51:7\n        PBRT (512 spp) Input (8 spp) PBRT (512 spp)\n        \n          Figure 7: Diffuse global illumination in S AN M IGUEL . Only indirect illumination is shown. Our result upsamples the 8 spp incident light field using 256 reconstruction rays per pixel. The supplemental material contains the full images.\n        \n        Input (4 spp)\n        Our reconstruction\n        \n          Figure 8: Our reconstruction of ambient occlusion from 4 input samples per pixel, compared to 2048 spp ground truth from PBRT.\n          \n        \n        Our reconstruction A-Trous RPF\n        Ground truth (2048 spp)\n        ACM Transactions on Graphics, Vol. 31, No. 4, Article 51, Publication Date: July 2012\n        51:8\n        ?\n        J. Lehtinen et al.\n        Ground truth (8192 spp from PBRT)\n        Input 8 spp (20.3dB)\n        Our (38.6dB), diff x2\n        A-Trous (31.5dB), diff x2\n        A-Trous + secondary normal (32.3dB), diff x2\n        RPF (32.1dB), diff x2\n        \n          Figure 9: Glossy reflectance. The closeups show differences from the ground truth (multiplied by 2). Our result upsamples the incident light field from 8 to 512 samples per pixel. The full uncompressed images are provided as auxiliary material.\n        \n        sampled areas, and better support for the lower sampling density areas, as demonstrated in Figure 12 . Our reconstruction takes 3?4x longer than the algorithm of Lehtinen et al., primarily because they use a specialized 2D hierarchy in post-perspective space, essentially tailoring the data structure to the known distribution of reconstruction rays (they all originate from the lens). As our focus is reconstructing the incident light field at arbitrary points in the scene, we use a true 3D hierarchy.\n        \n          \n        \n        Our result No angular bandwidth\n        \n          Figure 10: Disregarding angular effects, effectively treating all surfaces hit by secondary rays as diffuse, has a large negative impact on the result.\n        \n        \n          Figure 11: Motion blur and depth of field rendered using our algorithm using 1 sample per pixel as input. Please refer to the supplemental material for images showing input data and ground truth.\n        \n      \n      \n        4 Discussion\n        Scalability and memory consumption The execution time of our algorithm scales linearly with the number of reconstruction rays, but is only very weakly affected by the structure of the scene and the number of input samples. For example, increasing the number of input samples from 1 to 8 in S AN M IGUEL increases the execution time by only about 40%. Also, S AN M IGUEL takes only 80% longer to reconstruct than C ORNELL with the same parameters, even though the original model contains about 5?6 orders of magnitude more geometry, and has much more challenging structure (foliage vs. straight walls). Memory consumption is almost completely determined by the number of input samples. Each sample consists of 30 floating-point numbers, totaling up to ?1GB at 720p with 8 input samples per pixel, independent of scene structure. In addition, the BVH consumes about 80MB with these parameters, again almost independently of the scene structure. All other memory usage is negligible.  Recursive filtering With very low input sampling rates, artifacts can appear near corners: when we integrate over the hemisphere, a large fraction of the reconstruction rays may hit the same few samples. If the samples are noisy, the reconstructed image can suffer from structured artifacts, as demonstrated in Figure 13 . In this example, C ORNELL was rendered with up to eight-bounce indirect illumination from a point light at 1024?1024 with only one sample per pixel. The multiple bounces lead to noise in the samples? radiances. We implemented an experimental step that reduces variance by performing a quick reconstruction of the incident lighting at the secondary hits and replacing the secondary hits? radiances\n        ACM Transactions on Graphics, Vol. 31, No. 4, Article 51, Publication Date: July 2012\n        Reconstructing the Indirect Light Field for Global Illumination\n        ?\n        51:9\n        Our reconstruction [Lehtinen et al. 2011]\n        \n          Figure 12: Close-up of a pinhole reconstruction from B UTTER -\n        \n        FLIES . Lehtinen et al. [2011] do not adapt to the local density of the input samples and fail to reconstruct the marked regions. Our novel visibility heuristic reproduces the correct visibility.\n        with the reconstructed values before reconstructing incident lighting at the primary hits. In this scene, performing this step with 16 reconstruction rays adds less than 10% to execution time, and almost completely removes the artifacts. As a result, our reconstruction matches the ground truth closely, accurately preserving the boundaries of indirect shadows. Image antialiasing is still missing, because we have only one primary ray per pixel. Notice that the black borders near the corners are present in the ground truth PBRT rendering as well.  Glossy GI with noisy samples It should be possible to generalize the recursive filtering to more reliable handling of highly specular surfaces. In the extreme, it is clearly not very useful to reconstruct incident radiance onto a mirror from sparse samples. Instead it would make more sense to reconstruct at the next path segment to remove the noise on the surface seen in the mirror. Since our reconstruction works in 3D, it should be possible to extend it to walk forward in the path segments adaptively based on the angular bandwidth of the reflectance function. Information content We find it interesting that even very sparse input samplings can contain nearly all of the relevant information about visibility and light transport, particularly in diffuse scenes. For example, in diffuse C ORNELL one input path per pixel allows an essentially perfect reconstruction of indirect illumination, and even in the much more complex S AN M IGUEL four samples per pixel yields very good reconstructions. Multi-layer materials Most realistic material models are built from multiple layers. It would be interesting to extend our work to reconstruct the layers independently. For example, a varnished wood consists of an almost-diffuse base layer, a specular top layer, and the two are mixed according to a Fresnel term. Treating the two layers separately would allow very broad reuse of the samples from the base layer, while the glossy top layer could only be used from a narrow set of directions. Overall this would allow broader reuse than collapsing the layers beforehand and selecting the maximum bandwidth for the sample. Sheared filters In contrast to sheared reconstruction of (temporal) light fields [Egan et al. 2009; Egan et al. 2011b] where reconstruction and integration are combined to a single, large filter, we perform integration over incident angle numerically. This allows us to reason about the anisotropy of each input sample individually,\n        \n          \n        \n        Input (1 spp) Ground truth (2048 spp)\n        Our without recursive step Our with recursive step\n        \n          Figure 13: Multi-bounce indirect illumination in Cornell box reconstructed from 1 spp input. Recursive filtering removes the artifacts in corners.\n        \n        but prevents a clean frequency analysis due to the non-translationinvariant nature of our reconstruction filters. However, in simple uniformly sampled planar scenarios, our filter reduces to earlier linear sheared formulations.  Failure cases The proposed algorithm can fail if the scene contains higher-frequency shading and visibility than what the input sampling rate can capture. For example, a sparse sampling of hair will probably not suffice to accurately describe its visibility and shading. In these cases the resulting reconstruction is consistent with the input sampling, but may not be faithful to the original scene. The foliage in our diffuse results is an example of difficult visibility that is handled gracefully at low sampling rates. Also, the distribution of input rays, which is driven by reflectance at the primary hits, may be insufficient to capture very high-frequency angular effects (e.g., a mirror) at the secondary hits. This would lead to slight blurring in the reconstructed light field. Specialized hierarchies Our bandwidth-aware k-NN produces a hierarchy that serves two purposes: it is used to resolve visibility and also to guarantee that we find the nearby splats with similar angular support. An alternative design would be to have separate hierarchies for the two tasks. In that design, the visibility hierarchy would ignore angular bandwidth and implement the shrinking step. The second hierarchy would take bandwidth into account and omit shrinking. This slightly more complicated approach could improve the execution speed in case of very glossy materials.\n        ACM Transactions on Graphics, Vol. 31, No. 4, Article 51, Publication Date: July 2012\n        51:10\n        ?\n        J. Lehtinen et al.\n      \n      \n        Acknowledgements\n        We thank Guillermo Lleal Laguna for the San Miguel scene. Fr?do Durand is supported by the National Science Foundation.\n      \n      \n        References\n        \n          A RVO , J., AND K IRK , D. 1987. Fast ray tracing by ray classification. Computer Graphics (Proc. ACM SIGGRAPH ?87) 21, 55?64.\n          B ALA , K., D ORSEY , J., AND T ELLER , S. 1999. Radiance interpolants for accelerated bounded-error ray tracing. ACM Trans. Graph. 18, 213?256.\n          B EKAERT , P., S BERT , M., AND H ALTON , J. 2002. Accelerating path tracing by re-using paths. In Proc. Eurographics Workshop on Rendering 2002, 125?134.\n          C HAI , J.-X., T ONG , X., C HAN , S.-C., AND S HUM , H.-Y. 2000. Plenoptic sampling. In Proc. ACM SIGGRAPH 2000, 307?318.\n          C HRISTENSEN , P., 2008. Point-based approximate color bleeding. Pixar Technical Memo #08?01.\n          D AMMERTZ , H., S EWTZ , D., H ANIKA , J., AND L ENSCH , H. P. A. 2010. Edge-avoiding A-trous ` wavelet transform for fast global illumination filtering. In Proc. High Performance Graphics 2010, 67?75.\n          D URAND , F., H OLZSCHUCH , N., S OLER , C., C HAN , E., AND S ILLION , F. X. 2005. A frequency analysis of light transport. ACM Trans. Graph. 24, 3, 1115?1126.\n          E GAN , K., T SENG , Y., H OLZSCHUCH , N., D URAND , F., AND R AMAMOORTHI , R. 2009. Frequency analysis and sheared reconstruction for rendering motion blur. ACM Trans. Graph. 28, 3, 93:1?93:13.\n          E GAN , K., D URAND , F., AND R AMAMOORTHI , R. 2011. Practical filtering for efficient ray-traced directional occlusion. ACM Trans. Graph. 30, 6, 180:1?180:10.\n          E GAN , K., H ECHT , F., D URAND , F., AND R AMAMOORTHI , R. 2011. Frequency analysis and sheared filtering for shadow light fields of complex occluders. ACM Trans. Graph. 30, 2, 9:1?9:13.\n          G ASSENBAUER , V., K RIV ? ANEK  ? , J., AND B OUATOUCH , K. 2009. Spatial directional radiance caching. Computer Graphics Forum 28, 4, 1189?1198.\n          G LASSNER , A. 1988. Spacetime ray tracing for animation. IEEE Computer Graphics and Applications 8, 2, 60?70.\n          H ACHISUKA , T., J AROSZ , W., W EISTROFFER , R. P., D ALE , K., H UMPHREYS , G., Z WICKER , M., AND J ENSEN , H. W. 2008. Multidimensional adaptive sampling and reconstruction for ray tracing. ACM Trans. Graph. 27, 3, 33:1?33:10.\n          I SAKSEN , A., M C M ILLAN , L., AND G ORTLER , S. J. 2000. Dynamically reparameterized light fields. In Proc. ACM SIGGRAPH 2000, 297?306.\n          K ELLER , A. 1997. Instant radiosity. In Proc. ACM SIGGRAPH ?97, 49?56.\n          K ONTKANEN , J., T ABELLION , E., AND O VERBECK , R. 2011. Coherent out-of-core point-based global illumination. Computer Graphics Forum 30, 4, 1353?1360.\n          L EHTINEN , J., A ILA , T., C HEN , J., L AINE , S., AND D URAND , F. 2011. Temporal light field reconstruction for rendering distribution effects. ACM Trans. Graph. 30, 4, 55:1?55:12.\n          M C C OOL , M. D. 1999. Anisotropic diffusion for Monte Carlo noise reduction. ACM Trans. Graph. 18, 2, 171?194.\n          O VERBECK , R., D ONNER , C., AND R AMAMOORTHI , R. 2009. Adaptive wavelet rendering. ACM Trans. Graph. 28, 5, 140:1? 140:12.\n          P HARR , M., AND H UMPHREYS , G. 2010. Physically Based Rendering, 2nd ed. Morgan Kaufmann.\n          R AMAMOORTHI , R., M AHAJAN , D., AND B ELHUMEUR , P. 2007. A first-order analysis of lighting, shading, and shadows. ACM Trans. Graph. 26, 1, 2:1?2:21.\n          R ITSCHEL , T., E NGELHARDT , T., G ROSCH , T., S EIDEL , H.-P., K AUTZ , J., AND D ACHSBACHER , C. 2009. Micro-rendering for scalable, parallel final gathering. ACM Trans. Graph. 28, 5, 132:1?132:8.\n          R OUSSELLE , F., K NAUS , C., AND Z WICKER , M. 2011. Adaptive sampling and reconstruction using greedy error minimization. ACM Trans. Graph. 30, 6, 159:1?159:12.\n          S CHAUFLER , G., AND W ANN J ENSEN , H. 2000. Ray tracing point sampled geometry. In Proc. Eurographics Workshop on Rendering 2000, 319?328.\n          S EN , P., AND D ARABI , S. 2011. Implementation of random parameter filtering. Tech. Rep. EECE-TR-11-0004, University of New Mexico.\n          S EN , P., AND D ARABI , S. 2012. On filtering the noise from the random parameters in monte carlo rendering. ACM Trans. Graph., To Appear.\n          S OLER , C., S UBR , K., D URAND , F., H OLZSCHUCH , N., AND S ILLION , F. 2009. Fourier depth of field. ACM Trans. Graph. 28, 2, 18:1?18:12.\n          W ALTER , B., F ERNANDEZ , S., A RBREE , A., B ALA , K., D ONIKIAN , M., AND G REENBERG , D. P. 2005. Lightcuts: a scalable approach to illumination. ACM Trans. Graph. 24, 3, 1098?1107.\n          W ANN J ENSEN , H. 1996. Global illumination using photon maps. In Proc. Eurographics Workshop on Rendering ?96, 21?30.\n          W ARD , G. J., R UBINSTEIN , F. M., AND C LEAR , R. D. 1988. A ray tracing solution for diffuse interreflection. In Computer Graphics (Proc. ACM SIGGRAPH ?88), 85?92.\n          Z WICKER , M., P FISTER , H., VAN B AAR , J., AND G ROSS , M. 2001. Surface splatting. In Proc. ACM SIGGRAPH 2001, 371? 378.\n        \n        ACM Transactions on Graphics, Vol. 31, No. 4, Article 51, Publication Date: July 2012\n      \n    \n  ",
  "resources" : [ ]
}