{
  "uri" : "sig2010a-a145-farbman_PROC.xml",
  "url" : "/Users/cbadenes/Documents/OEG/Projects/DrInventor/datasets/acm-siggraph-2006-2014-upf/sig2010a/a145-farbman_PROC.xml",
  "source" : {
    "name" : "SIGGRAPH",
    "uri" : "http://drinventor/SIGGRAPH",
    "url" : "http://drinventor/SIGGRAPH",
    "protocol" : "http"
  },
  "metainformation" : {
    "title" : "Diffusion Maps for Edge-Aware Image Editing",
    "published" : "2010",
    "format" : "pdf",
    "language" : "en",
    "rights" : "GPLv2",
    "description" : "",
    "creators" : [ {
      "uri" : "http://drinventor/Zeev-Farbman",
      "name" : "Zeev",
      "surname" : "Farbman"
    }, {
      "uri" : "http://drinventor/Raanan-Fattal",
      "name" : "Raanan",
      "surname" : "Fattal"
    }, {
      "uri" : "http://drinventor/Dani-Lischinski",
      "name" : "Dani",
      "surname" : "Lischinski"
    } ]
  },
  "bagOfWords" : [ "we", "demonstrate", "benefit", "use", "diffusion", "distance", "variety", "image", "editing", "context", "explore", "use", "diffusion", "map", "tool", "facilitate", "creation", "complex", "selection", "mask", "finally", "we", "present", "new", "analysis", "establish", "connection", "between", "spatial", "interaction", "range", "between", "two", "pixel", "number", "sample", "necessary", "accurate", "nystr?m", "approximation", "map", "describe", "more", "detail", "section", "also", "make", "easy", "compute", "diffusion", "distance", "correspond", "different", "time", "provide", "important", "parameter", "which", "user", "can", "control", "desire", "amount", "propagation", "-lrb-", "figure", "bottom", "row", "-rrb-", "section", "we", "explore", "benefit", "use", "diffusion", "distance", "variety", "edge-aware", "image", "editing", "context", "also", "demonstrate", "diffusion", "map", "facilitate", "creation", "complex", "edgeaware", "selection", "mask", "image", "contain", "textured", "region", "fuzzy", "and/or", "fragmented", "appearance", "we", "analysis", "also", "show", "even", "increase", "sampling", "rate", "result", "matrix", "sparse", "thus", "can", "solve", "efficiently", "use", "standard", "sparse", "linear", "solver", "make", "possible", "perform", "edge-aware", "image", "editing", "arbitrary", "permit", "interaction", "range", "approach", "generalize", "other", "tonal", "manipulation", "-lsb-", "Lischinski", "et", "al.", "2006", "-rsb-", "well", "natural", "image", "matting", "-lsb-", "Levin", "et", "al.", "2008a", "-rsb-", "all", "technique", "above", "rely", "gradient", "between", "adjacent", "pixel", "control", "propagation", "thus", "have", "trouble", "propagate", "information", "highly", "textured", "region", "well", "prevent", "propagation", "across", "low-contrast", "edge", "Pellacini", "-lsb-", "2008", "-rsb-", "generalize", "optimization-based", "edit", "propagation", "consider", "interaction", "between", "all", "pair", "pixel", "image", "enable", "less", "precise", "specification", "user", "constraint", "propagation", "across", "disconnect", "region", "pellacini?s", "error", "analysis", "show", "nystr?m", "approximation", "become", "less", "accurate", "spatial", "range", "interaction", "decrease", "we", "work", "we", "also", "apply", "nystr?m", "method", "related", "eigenvalue", "problem", "-lsb-", "Fowlkes", "et", "al.", "2004", "-rsb-", "present", "refined", "error", "analysis", "more", "precisely", "quantify", "effective", "rank", "affinity", "matrix", "function", "spatial", "interaction", "range", "enable", "we", "generalize", "all-pairs", "approach", "handle", "arbitrary", "interaction", "range", "accurately", "efficiently", "selection", "mask", "compute", "solve", "linear", "system", "once", "each", "scribble", "type", "while", "we", "idea", "use", "diffusion", "distance", "also", "leverage", "machine", "learning", "technique", "we", "effectively", "perform", "unsupervised", "clustering", "which", "consider", "all", "datum", "image", "rather", "than", "just", "pixel", "cover", "particular", "set", "stroke", "all", "technique", "mention", "above", "rely", "difference", "between", "pixel", "value", "-lrb-", "difference", "luminance", "euclidean", "distance", "some", "color", "space", "-rrb-", "thus", "we", "argue", "could", "all", "benefit", "from", "use", "diffusion", "distance", "instead", "support", "we", "claim", "number", "example", "section", "approach", "effectively", "assume", "oscillatory", "model", "textured", "region", "succeed", "remove", "detail", "even", "high-contrast", "textured", "region", "while", "we", "approach", "do", "make", "use", "texture", "model", "we", "show", "plug", "diffusion", "distance", "exist", "edge-preserving", "smoothing", "approach", "become", "possible", "remove", "detail", "just", "effectively", "clustering", "Diffusion", "map", "have", "emerge", "machine", "learn", "community", "tool", "dimensionality", "reduction", "unsupervised", "clustering", "-lsb-", "coifman", "Lafon", "2006", "Nadler", "et", "al.", "2005", "Singer", "et", "al.", "2009", "-rsb-", "Diffusion", "distance", "also", "have", "random", "walker", "interpretation", "-lrb-", "section", "3.1", "-rrb-", "however", "since", "he", "random", "walker", "formulation", "consider", "only", "limited", "spatial", "neighborhood", "we", "analysis", "section", "imply", "approximation", "only", "accurate", "small", "image", "spectral", "clustering", "have", "also", "be", "use", "natural", "image", "matting", "-lsb-", "Levin", "et", "al.", "2008b", "-rsb-", "where", "eigenvector", "suitable", "laplacian", "matrix", "rotate", "combine", "together", "yield", "soft", "matte", "we", "also", "compute", "eigenvector", "use", "they", "order", "define", "robust", "distance", "between", "pair", "image", "pixel", "Diffusion", "distance", "also", "account", "length", "density", "path", "datum", "lend", "themselves", "faster", "computation", "section", "we", "present", "we", "approach", "towards", "edge-aware", "image", "editing", "which", "base", "use", "diffusion", "distance", "place", "distance", "typically", "use", "exist", "edge-aware", "method", "exist", "edge-aware", "method", "rely", "pairwise", "similarity", "-lrb-", "affinity", "-rrb-", "measure", "between", "image", "pixel", "where", "feature", "vector", "associate", "i-th", "pixel", "e.g.", "its", "luminance", "log-luminance", "its", "coordinate", "some", "color", "space", "concatenation", "color", "spatial", "coordinate", "intuitively", "affinity", "between", "two", "pixel", "predict", "likelihood", "both", "pixel", "belong", "same", "surface/region", "image", "edge-preserving", "smoothing", "technique", "allow", "group", "pixel", "high", "affinity", "between", "they", "average", "together", "edge-aware", "editing", "system", "allow", "edit", "propagate", "between", "pair", "pixel", "high", "affinity", "shortcoming", "approach", "might", "-lrb-", "-rrb-", "fail", "distinguish", "between", "region", "separate", "low", "contrast", "edge", "-lrb-", "ii", "-rrb-", "fail", "cluster", "together", "pixel", "highly", "textured", "region", "which", "may", "exhibit", "strong", "difference", "between", "nearby", "pixel", "distribution", "pixel", "color", "image", "highly", "non-uniform", "clearly", "exhibit", "three", "distinct", "cluster", "correspond", "blue", "sky", "region", "red", "flower", "green", "grass", "while", "pairwise", "distance", "color", "space", "between", "red", "green", "pixel", "same", "order", "magnitude", "those", "between", "red", "blue", "-lrb-", "green", "blue", "-rrb-", "distribution", "reveal", "transition", "between", "red", "green", "cluster", "much", "more", "densely", "populated", "than", "red-blue", "green-blue", "transition", "correspond", "we", "intuition", "coarsest", "possible", "clustering", "image", "green", "red", "should", "go", "one", "cluster", "while", "blue", "another", "intuitively", "likelihood", "two", "datum", "point", "belong", "same", "cluster", "should", "depend", "length", "density", "different", "path", "between", "they", "may", "achieve", "replace", "euclidean", "distance", "diffusion", "distance", "concept", "recently", "propose", "dimensionality", "reduction", "clustering", "-lsb-", "coifman", "Lafon", "2006", "Nadler", "et", "al.", "2005", "-rsb-", "which", "we", "describe", "more", "detail", "below", "definition", "normalize", "matrix", "can", "interpret", "stochastic", "matrix", "where", "probability", "random", "walker", "located", "point", "transition", "point", "single", "time", "step", "consequently", "consist", "probability", "move", "from", "each", "point", "another", "time", "step", "informally", "each", "we", "can", "associate", "soft", "clustering", "datum", "point", "subset", "point", "consider", "cluster", "low", "probability", "random", "walker", "start", "from", "point", "subset", "end", "up", "outside", "after", "move", "Diffusion", "distance", "interesting", "relationship", "between", "geometry", "datum", "spectral", "property", "capture", "notion", "diffusion", "distance", "-lsb-", "Nadler", "et", "al.", "2005", "-rsb-", "diffusion", "distance", "-lrb-", "-rrb-", "define", "difference", "between", "probability", "random", "walker", "start", "each", "two", "point", "end", "up", "same", "position", "time", "t.", "where", "-lrb-", "-rrb-", "probability", "random", "walker", "transition", "from", "time", "step", "-lrb-", "-rrb-", "reciprocal", "local", "density", "z.", "Intuitively", "more", "short", "path", "connect", "two", "point", "smaller", "diffusion", "distance", "between", "they", "note", "-lrb-", "-rrb-", "define", "family", "diffusion", "distance", "parameterize", "time", "increase", "two", "point", "be", "originally", "distant", "from", "each", "other", "may", "grow", "closer", "Diffusion", "map", "may", "show", "have", "set", "real", "eigenvalue", "-lcb-", "-rcb-", "note", "eigenvector", "do", "participate", "diffusion", "map", "since", "constant", "thus", "do", "contribute", "any", "discriminate", "information", "other", "word", "diffusion", "distance", "between", "two", "point", "simply", "sum", "square", "difference", "between", "corresponding", "entry", "eigenvector", "where", "each", "eigenvector", "weight", "practice", "matrix", "often", "exhibit", "spectral", "gap", "i.e.", "only", "few", "its", "eigenvalue", "close", "one", "while", "rest", "much", "example", "image", "40", "20", "pixel", "lab", "space", "thus", "diffusion", "distance", "well", "approximate", "diffusion", "map", "construct", "from", "first", "eigenvector", "accuracy", "approximation", "increase", "time", "discuss", "section", "value", "depend", "spatial", "support", "affinity", "kernel", "figure", "show", "visualization", "first", "three", "eigenvector", "produce", "from", "input", "image", "note", "first", "eigenvector", "roughly", "cluster", "image", "two", "main", "region", "-lrb-", "correspond", "sky", "ground", "-rrb-", "mainly", "distinguish", "red", "flower", "from", "everything", "else", "while", "set", "apart", "white", "cloud", "from", "everything", "else", "next", "eigenvector", "-lrb-", "show", "-rrb-", "correspond", "smaller", "eigenvalue", "further", "separate", "between", "progressively", "smaller", "region", "image", "since", "all", "eigenvalue", "strictly", "smaller", "than", "increase", "value", "time", "parameter", "give", "more", "weight", "coarser", "eigenvector", "thus", "diffusion", "distance", "correspond", "higher", "value", "emphasize", "edge", "separate", "between", "coarser", "cluster", "while", "suppress", "those", "separate", "smaller", "scale", "image", "region", "section", "we", "demonstrate", "usefulness", "diffusion", "distance", "plug", "they", "place", "regular", "pairwise", "distance", "several", "edge-aware", "operation", "possible", "concern", "regard", "use", "diffusion", "distance", "practice", "add", "computational", "cost", "nystr?m", "approximation", "method", "proceed", "follow", "correspond", "partition", "complete", "affinity", "matrix", "note", "block", "which", "contain", "bulk", "pairwise", "affinity", "never", "actually", "compute", "approximate", "eigenvector", "give", "Intuitively", "we", "compute", "eigenvalue", "eigenvector", "sample", "matrix", "use", "upsample", "vector", "full", "resolution", "original", "problem", "approximation", "yield", "eigenvector", "while", "diffusion", "map", "consist", "eigenvector", "where", "thus", "practical", "method", "compute", "diffusion", "map", "involve", "sampling", "image", "section", "we", "show", "give", "accuracy", "number", "sample", "depend", "where", "pairwise", "interaction", "range", "between", "pixel", "therefore", "affinity", "matrix", "allow", "all", "pair", "pixel", "interact", "constant", "number", "sample", "suffice", "exact", "number", "depend", "image", "hand", "since", "reduce", "matrix", "should", "ideally", "represent", "main", "local", "edit", "propagation", "top", "input", "scribble", "result", "use", "ordinary", "distance", "-lrb-", "middle", "-rrb-", "diffusion", "distance", "-lrb-", "right", "-rrb-", "compute", "spatial", "coordinate", "-lrb-", "16", "-rrb-", "bottom", "corresponding", "influence", "map", "green", "scribble", "distinct", "region", "present", "image", "sample", "place", "use", "stratified", "sampling", "image", "also", "do", "Pellacini", "-lsb-", "2008", "-rsb-", "following", "time", "-lrb-", "seconds", "-rrb-", "be", "measure", "when", "construct", "diffusion", "map", "eigenvector", "different", "image", "size", "number", "sample", "0.5", "mp", "0.75", "mp", "mp", "1.5", "mp", "mp", "10", "sample", "0.58", "0.58", "0.79", "1.12", "1.53", "30", "sample", "1.24", "1.82", "2.46", "3.57", "4.84", "60", "sample", "2.44", "3.66", "4.95", "7.20", "9.75", "each", "operator", "we", "compare", "its", "performance", "without", "use", "diffusion", "distance", "rather", "we", "aim", "show", "practical", "scenario", "where", "state-of-theart", "method", "perform", "better", "diffusion", "distance", "give", "same", "input", "we", "experiment", "number", "color", "space", "when", "compute", "affinity", "matrix", "all", "result", "show", "paper", "we", "use", "CIELAB", "color", "space", "-lrb-", "normalize", "channel", "range", "-lsb-", "-rsb-", "-rrb-", "we", "have", "also", "experiment", "number", "different", "feature", "vector", "use", "pixel", "color", "along", "spatial", "coordinate", "attractive", "option", "since", "typically", "yield", "good", "result", "however", "reduce", "spatial", "interaction", "range", "between", "pixel", "therefore", "require", "use", "more", "nystr?m", "sample", "compute", "diffusion", "map", "show", "section", "reason", "all", "we", "result", "except", "figure", "we", "use", "only", "color", "each", "pixel", "-lrb-", "spatial", "attenuation", "-rrb-", "compute", "diffusion", "map", "use", "30", "sample", "throughout", "section", "each", "result", "use", "diffusion", "distance", "we", "report", "value", "which", "we", "use", "possible", "strategy", "set", "parameter", "discuss", "section", "input", "image", "-lsb-", "subr", "et", "al.", "2009", "-rsb-", "wl", "diffusion", "local", "edit", "propagation", "Figure", "demonstrate", "performance", "diffusion", "distance", "context", "local", "edit", "propagation", "from", "sparse", "user", "constraint", "plug", "distance", "optimization-based", "approach", "describe", "Lischinski", "et", "al.", "-lsb-", "2006", "-rsb-", "goal", "apply", "warming", "filter", "city", "building", "cooling", "filter", "sky", "water", "region", "use", "minimal", "user", "input", "indeed", "original", "method", "fail", "propagate", "yellow", "scribble", "capture", "entire", "region", "interest", "when", "use", "diffusion", "distance", "result", "slightly", "better", "increase", "time", "16", "nicely", "capture", "target", "area", "produce", "significantly", "better", "result", "although", "two", "region", "appear", "quite", "distinct", "human", "observer", "select", "each", "they", "use", "state-of-the-art", "commercial", "tool", "prove", "require", "substantial", "amount", "user", "interaction", "use", "again", "method", "Lischinski", "et", "al.", "-lsb-", "2006", "-rsb-", "we", "be", "able", "obtain", "satisfactory", "result", "sparse", "set", "scribble", "since", "gradient", "between", "two", "region", "inside", "each", "region", "same", "order", "magnitude", "switch", "diffusion", "map", "construct", "use", "color", "each", "pixel", "only", "produce", "similar", "unsatisfactory", "result", "however", "add", "spatial", "coordinate", "feature", "vector", "feed", "result", "diffusion", "distance", "same", "method", "we", "be", "able", "produce", "more", "satisfactory", "result", "similar", "improvement", "propagation", "may", "observe", "well", "practice", "scribble-based", "editing", "intend", "iterative", "interactive", "workflow", "where", "user", "able", "add", "remove", "scribble", "until", "satisfactory", "result", "achieve", "sufficient", "amount", "user", "input", "obviously", "possible", "achieve", "result", "identical", "better", "than", "those", "we", "have", "show", "thus", "practical", "advantage", "use", "diffusion", "distance", "context", "lie", "reduce", "amount", "necessary", "user", "input", "edge-preserving", "smoothing", "Figure", "compare", "result", "filter", "image", "WLS", "edge-preserving", "smoothing", "operator", "-lsb-", "Farbman", "et", "al.", "2008", "-rsb-", "without", "use", "diffusion", "distance", "example", "contain", "texture", "high", "gradient", "building", "background", "WLS", "operator", "control", "degree", "smooth", "via", "parameter", "when", "value", "choose", "so", "remove", "most", "texture", "form", "building", "result", "fade", "edge", "between", "building", "sky", "-lrb-", "top", "middle", "image", "-rrb-", "contrast", "reduction", "undesirable", "application", "image", "abstraction", "when", "same", "operator", "use", "diffusion", "distance", "contrast", "edge", "better", "preserved", "-lrb-", "top", "right", "-rrb-", "bottom", "row", "show", "what", "happen", "when", "remove", "texture", "detail", "amplify", "add", "back", "-lrb-", "local", "contrast", "boost", "-rrb-", "may", "see", "detail", "building", "boost", "much", "more", "uniform", "manner", "right", "Figure", "show", "comparison", "between", "result", "produce", "method", "recently", "propose", "Subr", "et", "al.", "-lsb-", "2009", "-rsb-", "result", "edge-preserving", "filter", "wl", "use", "diffusion", "distance", "Subr", "et", "al.", "first", "search", "local", "extrema", "image", "fit", "lower", "upper", "envelope", "extrema", "solve", "linear", "system", "twice", "may", "see", "wl", "diffusion", "distance", "able", "remove", "small", "scale", "detail", "vase", "just", "effectively", "while", "avoid", "cost", "non-linear", "filter", "solve", "multiple", "linear", "system", "we", "also", "experiment", "incorporate", "diffusion", "distance", "matting", "method", "Levin", "et", "al.", "-lsb-", "2008a", "-rsb-", "unlike", "many", "mat", "algorithm", "assume", "tight", "trimap", "method", "also", "admit", "sparse", "user", "scribble", "indicate", "background", "foreground", "which", "propagate", "over", "image", "yield", "alpha", "matte", "we", "have", "modify", "author", "original", "code", "use", "diffusion", "coordinate", "instead", "color", "when", "construct", "mat", "laplacian", "Figure", "show", "example", "where", "modify", "method", "produce", "matte", "closer", "ground", "truth", "than", "original", "method", "local", "image", "editing", "we", "find", "fewer", "scribble", "necessary", "produce", "accurate", "matte", "diffusion", "distance", "presence", "textured", "region", "further", "evaluate", "mat", "performance", "we", "also", "run", "benchmark", "suggest", "-lsb-", "Rhemann", "et", "al.", "2009", "-rsb-", "we", "do", "see", "any", "significant", "increase", "quantitative", "accuracy", "can", "explain", "fact", "benchmark", "use", "tight", "trimap", "thus", "ability", "diffusion", "distance", "propagate", "across", "textured", "region", "do", "play", "significant", "role", "when", "input", "trimap", "loose", "visual", "accuracy", "diffusion-based", "matte", "sometimes", "better", "-lrb-", "see", "supplementary", "material", "-rrb-", "local", "edit", "propagation", "particular", "adjustment", "propagate", "apply", "all", "pixel", "within", "contiguous", "region", "indicate", "user", "example", "Figure", "modify", "color", "soil", "bush", "independently", "difficult", "accomplish", "use", "scribble-based", "local", "propagation", "experienced", "Photoshop", "user", "might", "prefer", "first", "create", "mask", "separate", "ground", "from", "sky", "use", "color", "range", "selection", "tool", "further", "separate", "ground", "red", "green", "here", "we", "demonstrate", "have", "diffusion", "map", "under", "hood", "can", "also", "useful", "quickly", "obtain", "similar", "fuzzy", "mask", "recall", "diffusion", "map", "consist", "dominant", "eigenvector", "all-pairs", "affinity", "matrix", "which", "discriminate", "between", "dominant", "mode", "datum", "various", "scale", "each", "eigenvector", "consist", "positive", "negative", "value", "-lrb-", "show", "shades", "red", "blue", "figure", "-rrb-", "transition", "between", "negative", "positive", "region", "correspond", "transition", "between", "cluster", "thus", "we", "idea", "give", "scribble", "draw", "user", "we", "first", "identify", "which", "eigenvector", "diffusion", "map", "respond", "most", "strongly", "scribble", "measure", "variance", "each", "eigenvector", "pixel", "cover", "scribble", "have", "find", "eigenvector", "we", "use", "produce", "mask", "capture", "either", "positive", "negative", "region", "eigenvector", "formally", "give", "user", "scribble", "we", "first", "search", "eigenvector", "which", "exhibit", "highest", "variance", "area", "cover", "scribble", "we", "use", "eigenvector", "define", "two", "mask", "area", "where", "eigenvector", "positive", "negative", "respectively", "where", "parameter", "enable", "user", "control", "hardness", "mask", "-lrb-", "make", "mask", "softer", "while", "make", "they", "harder", "-rrb-", "note", "mask", "normalize", "sum", "every", "pixel", "often", "case", "first", "eigenvector", "effectively", "partition", "image", "two", "main", "region", "-lrb-", "e.g.", "ground", "sky", "see", "figure", "-rrb-", "thus", "scribble", "contain", "one", "two", "region", "we", "assume", "user?s", "intent", "apply", "manipulation", "only", "inside", "contain", "region", "case", "we", "also", "define", "attenuation", "mask", "final", "mask", "use", "edit", "image", "give", "product", "one", "mask", "attenuation", "mask", "att", "process", "demonstrate", "figure", "user", "first", "draw", "scribble", "across", "boundary", "between", "two", "main", "region", "image", "-lrb-", "sky", "ground", "-rrb-", "first", "eigenvector", "respond", "most", "strongly", "scribble", "yield", "mask", "distinguish", "between", "two", "region", "user", "able", "boost", "local", "contrast", "sky", "without", "significant", "effect", "elsewhere", "next", "scribble", "draw", "across", "ground", "region", "eigenvector", "respond", "most", "strongly", "discriminate", "between", "red", "soil", "green", "vegetation", "user", "use", "one", "two", "result", "mask", "-lrb-", "case", "-rrb-", "change", "hue", "saturation", "soil", "its", "complement", "-lrb-", "-rrb-", "make", "vegetation", "more", "green", "use", "different", "hue/saturation", "adjustment", "here", "attenuate", "mask", "first", "eigenvector", "help", "confine", "edit", "ground", "region", "-lrb-", "figure", "show", "attenuate", "mask", "att", "-rrb-", "finally", "scribble", "across", "sky", "produce", "mask", "discriminate", "between", "blue", "sky", "white", "cloud", "enable", "user", "deepen", "color", "sky", "again", "edit", "attenuate", "apply", "only", "sky", "region", "yield", "final", "result", "input", "image", "mask", "result", "mask", "optimization-based", "edit", "propagation", "operator", "explore", "so", "far", "literature", "may", "group", "two", "main", "class", "base", "spatial", "range", "interaction", "explicitly", "account", "below", "we", "review", "method", "use", "solve", "edit", "propagation", "problem", "each", "two", "case", "conclude", "method", "well", "suit", "handle", "middle-range", "interaction", "however", "careful", "spectral", "analysis", "corresponding", "affinity", "matrix", "lead", "naturally", "hybrid", "solution", "method", "make", "possible", "handle", "intermediate", "case", "both", "accurately", "efficiently", "interaction", "range", "optimization-based", "edge-aware", "edit", "propagation", "method", "solve", "linear", "system", "form", "lx", "where", "non-homogeneous", "laplacian", "matrix", "affinity", "matrix", "one", "define", "eq", "-lrb-", "-rrb-", "diagonal", "matrix", "give", "let", "we", "define", "spatial", "interaction", "range", "radius", "-lrb-", "pixel", "-rrb-", "beyond", "which", "pairwise", "affinity", "between", "two", "pixel", "image", "fall", "below", "some", "threshold", "example", "5-point", "inhomogeneous", "laplacian", "operator", "use", "-lsb-", "Lischinski", "et", "al.", "2006", "Farbman", "et", "al.", "2008", "-rsb-", "correspond", "Levin", "et", "al.", "-lsb-", "2004", "2008a", "-rsb-", "use", "slightly", "larger", "-lrb-", "still", "constant", "-rrb-", "interaction", "range", "while", "all-pairs", "approach", "-lsb-", "Pellacini", "2008", "-rsb-", "use", "interaction", "range", "-lrb-", "-rrb-", "where", "dimension", "-lrb-", "width", "height", "-rrb-", "image", "when", "small", "constant", "edit", "propagate", "well", "within", "smooth", "contiguous", "image", "region", "propagation", "block", "strong", "edge", "image", "so", "fragmented", "strongly", "textured", "region", "can", "handle", "other", "extreme", "when", "-lrb-", "-rrb-", "edit", "allow", "propagate", "between", "region", "similar", "attribute", "even", "region", "distant", "completely", "separate", "region", "very", "different", "color", "attribute", "one", "interested", "be", "able", "handle", "fragmented", "region", "while", "same", "time", "have", "flexibility", "local", "control", "use", "intermediate", "interaction", "range", "might", "provide", "answer", "however", "we", "shall", "see", "below", "latter", "case", "clear", "how", "result", "system", "linear", "equation", "can", "efficiently", "compute", "solve", "practice", "exist", "approach", "let", "we", "review", "solution", "method", "commonly", "use", "handle", "two", "extreme", "case", "case", "sparse", "laplacian", "matrix", "have", "be", "study", "extensively", "numerical", "computing", "literature", "since", "matrix", "use", "approximate", "differential", "operator", "well", "know", "-lsb-", "Trottenberg", "et", "al.", "2001", "-rsb-", "matrix", "have", "condition", "number", "grow", "function", "eigenvector", "correspond", "mode", "variation", "different", "scale", "-lrb-", "fourier", "mode", "different", "wavelength", "-rrb-", "result", "mask", "result", "fore", "matrix", "treat", "multi-scale", "preconditioner", "capture", "rescale", "mode", "geometric", "multigrid", "method", "-lsb-", "trottenberg", "et", "al.", "2001", "-rsb-", "conjugate", "gradient", "hierarchical", "basis", "precondition", "-lsb-", "szeliski", "1990", "-rsb-", "recently", "several", "work", "show", "action", "perform", "non-homogeneous", "laplacian", "system", "can", "approximate", "efficiently", "without", "explicitly", "construct", "preconditioning", "solve", "full-resolution", "linear", "system", "-lsb-", "Kopf", "et", "al.", "2007", "Fattal", "2009", "-rsb-", "contrast", "global", "all-pairs", "laplacian", "behave", "differently", "dense", "hence", "linear", "relaxation", "Gauss-Seidel", "conjugate", "gradient", "become", "prohibitively", "expensive", "since", "each", "matrixvector", "multiplication", "cost", "-lrb-", "-rrb-", "Pellacini", "-lsb-", "2008", "-rsb-", "exploit", "observation", "use", "nystr?m", "method", "-lsb-", "Williams", "Seeger", "2000", "-rsb-", "first", "drastically", "reduce", "dimensionality", "matrix", "solve", "associate", "laplacian", "its", "reduced", "form", "use", "Woodbury", "formulum", "-lsb-", "Golub", "Van", "Loan", "1998", "-rsb-", "summarize", "discussion", "so", "far", "variety", "efficient", "accurate", "solution", "exist", "two", "extreme", "case", "either", "very", "sparse", "fully", "dense", "inhomogeneous", "Laplacians", "solution", "practically", "linear", "number", "pixel", "N.", "however", "solution", "well", "suit", "intermediate", "case", "since", "corresponding", "affinity", "matrix", "neither", "sufficiently", "sparse", "nor", "sufficiently", "rank-deficient", "-lsb-", "Pellacini", "2008", "-rsb-", "Rank", "vs.", "interaction", "range", "top", "right", "plot", "Figure", "show", "several", "spectrum", "normalize", "gaussian", "affinity", "matrix", "correspond", "increase", "value", "-lrb-", "hence", "increase", "value", "-rrb-", "note", "short", "interaction", "range", "most", "eigenvalue", "non-negligible", "number", "indeed", "decrease", "become", "larger", "plot", "numerical", "rank", "function", "-lrb-", "figure", "bottom", "left", "-rrb-", "reveal", "get", "smaller", "rank", "grow", "approximately", "spatially-homogeneous", "case", "-lrb-", "constant", "very", "smooth", "image", "-rrb-", "empirical", "result", "can", "verify", "formally", "notice", "circulant", "matrix", "correspond", "convolution", "affinity", "kernel", "e.g.", "exp", "-lrb-", "-rrb-", "case", "eigenvalue", "96", "test", "window", "-lrb-", "blue", "-rrb-", "red", "line", "constant", "value", "left", "grow", "full", "rank", "linearly", "indicate", "we", "propose", "sampling", "strategy", "bottom", "right", "nystr?m", "approximation", "error", "function", "different", "sampling", "strategy", "measure", "one", "window", "give", "-lrb-", "up", "scale", "-rrb-", "-lsb-", "Oppenheim", "Schafer", "1975", "-rsb-", "where", "index", "fourier", "domain", "thus", "number", "eigenvalue", "above", "some", "fix", "threshold", "proportional", "number", "different", "k?s", "satisfy", "two", "dimension", "all", "k?s", "fall", "inside", "circle", "whose", "radius", "proportional", "substitute", "we", "obtain", "rank", "-lrb-", "-rrb-", "homogeneous", "analysis", "apply", "each", "block", "once", "become", "sufficiently", "small", "thus", "overall", "rank", "grow", "like", "before", "-lrb-", "-rrb-", "extremely", "cluttered/textured", "window", "growth", "more", "concave", "large", "value", "specifically", "actual", "slope", "curve", "different", "test", "window", "left", "end", "plot", "-lrb-", "large", "-rrb-", "between", "0.85", "6.39", "while", "right", "end", "plot", "-lrb-", "approach", "-rrb-", "slope", "between", "0.82", "0.93", "summarize", "affinity", "matrix", "case", "have", "rank", "-lrb-", "-rrb-", "sparsity", "pattern", "-lrb-", "-rrb-", "non-zeros", "per", "row", "mean", "when", "apply", "nystr?m", "approximation", "one", "should", "sample", "image", "rate", "-lrb-", "-rrb-", "along", "each", "dimension", "-lrb-", "one", "every", "-lrb-", "-rrb-", "column", "-rrb-", "reduce", "matrix", "eq", "-lrb-", "-rrb-", "full-rank", "have", "sparsity", "pattern", "-lrb-", "-rrb-", "which", "make", "possible", "use", "standard", "iterative", "linear", "solver", "Figure", "show", "large", "value", "rank", "grow", "somewhat", "faster", "than", "linear", "prediction", "therefore", "we", "suggest", "follow", "strategy", "some", "constant", "number", "-lrb-", "ten", "few", "hundred", "-rrb-", "sample", "all-pairs", "case", "increase", "number", "sample", "proportionally", "strategy", "demonstrate", "bottom", "right", "plot", "figure", "which", "confirm", "error", "correspond", "constant", "number", "sample", "increase", "decrease", "while", "use", "sample", "result", "non-increasing", "error", "edit", "propagation", "example", "Figure", "demonstrate", "importance", "use", "appropriate", "sampling", "rate", "edit", "propagation", "practice", "suppose", "give", "input", "image", "user", "wish", "recolor", "all", "tulip", "mark", "single", "tulip", "one", "scribble", "while", "place", "another", "scribble", "across", "background", "all-pairs", "approach", "well-suited", "scenario", "desire", "interaction", "range", "here", "roughly", "entire", "image", "accord", "we", "analysis", "small", "constant", "number", "sample", "suffice", "case", "indeed", "propagation", "mask", "obtain", "use", "small", "-lrb-", "50", "-rrb-", "larger", "number", "sample", "look", "virtually", "identical", "produce", "same", "visual", "result", "contrast", "suppose", "goal", "recolor", "only", "left", "right", "flower", "while", "keep", "original", "color", "middle", "case", "use", "small", "number", "sample", "longer", "produce", "desire", "mask", "which", "nevertheless", "obtain", "suitably", "larger", "number", "sample", "efficient", "numerical", "solution", "analysis", "we", "have", "present", "section", "suggest", "only", "correct", "sampling", "rate", "use", "intermediate", "interaction", "range", "also", "how", "efficiently", "solve", "associate", "linear", "system", "accord", "nystr?m", "approximation", "apply", "Woodbury", "identity", "-lsb-", "Golub", "Van", "Loan", "1998", "-rsb-", "yield", "Pellacini", "be", "able", "evaluate", "eq", "-lrb-", "16", "-rrb-", "efficiently", "use", "direct", "method", "because", "use", "constant", "number", "sample", "when", "rank", "sufficiently", "small", "hence", "number", "sample", "have", "larger", "we", "observe", "still", "possible", "evaluate", "eq", "-lrb-", "16", "-rrb-", "efficiently", "so", "since", "both", "sparse", "-lrb-", "latter", "sparse", "since", "involve", "inner", "product", "between", "vector", "nonzero", "over", "mostly", "nonoverlapping", "image", "region", "-rrb-", "thus", "instead", "use", "direct", "matrix", "inversion", "-lrb-", "-rrb-", "can", "invert", "use", "standard", "sparse", "linear", "solver", "linear", "time", "time", "parameter", "diffusion", "map", "edge", "separate", "between", "larger", "cluster", "appear", "lead", "eigenvector", "while", "lower", "eigenvector", "populate", "edge", "separate", "finer", "cluster", "thus", "time", "parameter", "effectively", "attenuate", "transition", "between", "finer", "cluster", "respect", "coarser", "one", "increase", "value", "one", "obtain", "stronger", "more", "aggressive", "edgepreserve", "smoothing", "interpolation", "we", "envision", "several", "option", "set", "value", "parameter", "practice", "should", "emphasize", "here", "change", "value", "only", "rescale", "diffusion", "map", "eigenvector", "-lrb-", "eq", "-rrb-", "do", "require", "recompute", "they", "computational", "cost", "order", "use", "diffusion", "distance", "instead", "regular", "distance", "color", "space", "necessary", "first", "construct", "input", "image", "mask", "-lrb-", "50", "sample", "-rrb-", "mask", "-lrb-", "500", "sample", "-rrb-", "input", "scribble", "edited", "result", "edit", "result", "input", "scribble", "mask", "-lrb-", "50", "sample", "-rrb-", "mask", "-lrb-", "500", "sample", "-rrb-", "edit", "result", "edited", "result", "diffusion", "map", "computation", "time", "we", "current", "implementation", "report", "section", "while", "time", "might", "appear", "significant", "compare", "interactive", "editing", "turnaround", "time", "fast", "bilateral", "filter", "-lsb-", "Chen", "et", "al.", "2007", "-rsb-", "edge-avoiding", "wavelet", "-lsb-", "fattal", "2009", "-rsb-", "one", "should", "keep", "mind", "diffusion", "map", "only", "need", "compute", "once", "before", "interactive", "editing", "commence", "thus", "one", "might", "view", "color", "space", "conversion", "do", "when", "image", "edit", "load", "from", "disk", "do", "necessarily", "slow", "down", "interaction", "user", "image", "-lrb-", "computation", "might", "only", "bit", "slower", "more", "than", "eigenvector", "use", "instead", "color", "channel", "original", "image", "-rrb-", "strength", "weakness", "one", "challenge", "edge-aware", "operator", "distinguish", "between", "high", "gradient", "-lrb-", "color", "difference", "-rrb-", "occur", "highly", "textured", "region", "between", "salient", "edge", "separate", "different", "larger", "scale", "region", "we", "approach", "we", "effectively", "assume", "textured", "region", "characterize", "multiple", "transition", "between", "texture", "element", "thus", "more", "path", "color", "space", "between", "different", "value", "pixel", "occur", "within", "same", "texture", "than", "between", "distinct", "larger", "scale", "region", "thus", "use", "diffusion", "distance", "place", "color", "difference", "advantageous", "image", "contain", "relatively", "large", "heavily", "textured", "region", "edge-aware", "interpolation", "show", "propagate", "better", "inside", "region", "removal", "texture", "edge-preserving", "smoothing", "show", "more", "effective", "example", "include", "scribble", "cover", "most", "target", "region", "scribble", "follow", "closely", "boundary", "region", "tight", "trimap", "etc.", "however", "we", "have", "encounter", "case", "where", "result", "suffer", "from", "use", "diffusion", "distance", "except", "bear", "add", "computational", "cost", "discuss", "earlier", "should", "point", "out", "all", "texture", "satisfy", "assumption", "we", "approach", "example", "skirt", "many", "colorful", "swatch", "might", "have", "significantly", "more", "transition", "pixel", "between", "different", "swatch", "than", "transition", "between", "shirt", "background", "thus", "some", "inter-swatch", "transition", "inside", "shirt", "might", "present", "already", "one", "lead", "eigenvector", "diffusion", "distance", "between", "they", "still", "significant", "propagation/smoothing", "inside", "shirt", "significantly", "improve", "another", "difficult", "example", "consider", "two", "adjacent", "region", "which", "semantically", "distinct", "have", "texture", "similar", "color", "case", "propagation", "from", "scribble", "inside", "one", "region", "might", "propagate", "adjacent", "region", "give", "sufficiently", "high", "value", "small", "value", "better", "than", "when", "use", "ordinary", "color", "difference", "both", "example", "above", "include", "supplementary", "material", "paper", "we", "have", "introduce", "idea", "perform", "edge-aware", "operation", "image", "use", "diffusion", "distance", "instead", "euclidean", "distance", "we", "have", "demonstrate", "diffusion", "distance", "which", "account", "both", "length", "number", "path", "between", "datum", "point", "feature", "space", "provide", "local", "edit", "propagation", "scheme", "edge-preserving", "smoothing", "operator", "valuable", "global", "perspective", "cluster", "present", "feature", "space", "variety", "scale", "we", "have", "also", "provide", "analysis", "extend", "applicability", "nystr?m", "method", "more", "general", "class", "affinity", "matrix", "suggest", "efficient", "solution", "entire", "range", "spatial", "interaction", "use", "diffusion", "distance", "span", "two-dimensional", "space", "edge-aware", "operator", "two", "axis", "space", "diffusion", "time", "parameter", "spatial", "interaction", "range", "currently", "up", "user", "specify", "appropriate", "value", "two", "parameter", "provide", "important", "degree", "user", "control", "currently", "unclear", "how", "automatically", "determine", "optimal", "combination", "two", "parameter", "particular", "image", "manipulation", "task", "we", "currently", "construct", "diffusion", "map", "use", "only", "color", "-lrb-", "sometimes", "-rrb-", "spatial", "position", "pixel", "image", "natural", "direction", "explore", "work", "richer", "feature", "space", "however", "we", "preliminary", "attempt", "direction", "be", "too", "successful", "since", "point", "out", "earlier", "exist", "texture", "descriptor", "effectively", "operate", "lower", "spatial", "resolution", "all", "exist", "edge-aware", "operator", "oblivious", "semantic", "content", "example", "human", "present", "image", "-lrb-", "any", "other", "object", "large", "variance", "texture", "and/or", "color", "-rrb-", "unlikely", "select", "edit", "single", "region", "unless", "sufficient", "user", "input", "provide", "thus", "integration", "object", "detection", "recognition", "algorithm", "image", "editing", "tool", "seem", "fruitful", "direction", "explore", "acknowledgment", "work", "support", "part", "Israel", "Science", "Foundation", "found", "Israel", "Academy", "Sciences", "Humanities" ],
  "content" : "We demonstrate the benefits of using diffusion distances in a variety of image editing contexts, and explore the use of diffusion maps as a tool for facilitating the creation of complex selection masks. Finally, we present a new analysis that establishes a connection between the spatial interaction range between two pixels, and the number of samples necessary for accurate Nystr?m approximations. These maps, described in more detail in Section 3, also make it easy to compute diffusion distances corresponding to different times, providing an important parameter with which the user can control the desired amount of propagation (Figure 1, bottom row). In Section 4, we explore the benefits of using diffusion distances in a variety of edge-aware image editing contexts, and also demonstrate that diffusion maps facilitate the creation of complex edgeaware selection masks in images containing textured regions with fuzzy and/or fragmented appearance. Our analysis also shows that even with the increased sampling rates, the resulting matrices are sparse and thus can be solved efficiently using standard sparse linear solvers. This makes it possible to perform edge-aware image editing with an arbitrary permitted interaction range. This approach was generalized to other tonal manipulations [Lischinski et al. 2006], as well as to natural image matting [Levin et al. 2008a]. All of the techniques above rely on gradients between adjacent pixels to control propagation, and thus have trouble propagating information in highly textured regions, as well as preventing propagation across low-contrast edges. An and Pellacini [2008] generalized optimization-based edit propagation to consider interactions between all pairs of pixels in the image, enabling less precise specification of user constraints and their propagation across disconnected regions. An and Pellacini?s error analysis shows that the Nystr?m approximation becomes less accurate as the spatial range of the interactions is decreased. In our work we also apply the Nystr?m method to a related eigenvalue problem [Fowlkes et al. 2004], and present a refined error analysis that more precisely quantifies the effective rank of the affinity matrix as a function of the spatial interaction range, enabling us to generalize the all-pairs approach to handle arbitrary interaction ranges accurately and efficiently. A selection mask is then computed by solving the linear system once for each scribble type. While our idea of using diffusion distances also leverages machine learning techniques, we effectively perform unsupervised clustering, which considers all of the data in the image, rather than just the pixels covered by a particular set of strokes. All of the techniques mentioned above rely on the difference between pixel values (difference in luminance, or Euclidean distance in some color space). Thus, we argue that they could all benefit from using diffusion distances instead, and support our claim by a number of examples in Section 4. This approach effectively assumes an oscillatory model of textured regions, and succeeds in removing detail even in high-contrast textured regions. While our approach does not make use of such a texture model, we show that by plugging diffusion distances into an existing edge-preserving smoothing approach it becomes possible to remove detail just as effectively. Clustering. Diffusion maps have emerged in the machine learning community as a tool for dimensionality reduction and unsupervised clustering [Coifman and Lafon 2006; Nadler et al. 2005; Singer et al. 2009]. Diffusion distances also have a random walker interpretation (Section 3.1). However, since his random walker formulation considers only limited spatial neighborhoods, our analysis in Section 5 implies that such an approximation is only accurate for small images. Spectral clustering has also been used for natural image matting [Levin et al. 2008b], where the eigenvectors of a suitable Laplacian matrix are rotated and combined together to yield a soft matte. We also compute eigenvectors, but use them in order to define robust distances between pairs of image pixels. Diffusion distances also account for length and density of paths in the data, but lend themselves to faster computation. In this section we present our approach towards edge-aware image editing, which is based on the use of diffusion distances in place of the distances typically used by existing edge-aware methods. Existing edge-aware methods rely on a pairwise similarity (affinity) measure between image pixels. where x i is the feature vector associated with the i-th pixel, e.g., its luminance or log-luminance, its coordinates in some color space, or a concatenation of color and spatial coordinates. Intuitively, the affinity between two pixels predicts the likelihood that both pixels belong to the same surface/region in the image. Edge-preserving smoothing techniques allow groups of pixels with high affinities between them to be averaged together, and edge-aware editing systems allow edits to propagate between pairs of pixels with high affinity. The shortcomings of this approach are that it might (i) fail to distinguish between regions separated by a low contrast edge; and (ii) fail to cluster together pixels in highly textured regions, which may exhibit strong differences between nearby pixels. The distribution of the pixel colors in this image is highly non-uniform, and clearly exhibits three distinct clusters corresponding to the blue sky region, the red flowers, and the green grass. While the pairwise distances in the color space between the red and the green pixels are of the same order of magnitude as those between red and blue (or green and blue), the distribution reveals that the transition between the red and the green clusters is much more densely populated than the red-blue or green-blue transitions. This corresponds to our intuition that in the coarsest possible clustering of this image the green and red should go into one cluster, while the blue into another. Intuitively, the likelihood of two data points to belong to the same cluster should depend on the lengths and the density of the different paths between them. This may be achieved by replacing the Euclidean distances with diffusion distances, a concept that was recently proposed for dimensionality reduction and clustering [Coifman and Lafon 2006; Nadler et al. 2005], which we describe in more detail below. Definitions. The normalized matrix M = D ?1 W can be interpreted as a stochastic matrix, where M i, j is the probability of a random walker located at point x i to transition to point x j in a single time step. Consequently, M t consists of the probabilities to move from each point to another in t time steps. Informally, for each t, we can associate M t with a ?soft? clustering of the data points: a subset of points is considered a cluster if there is a low probability of a random walker starting from a points in this subset to end up outside it after t moves. Diffusion distance. There is an interesting relationship between the geometry of the data and the spectral properties of M, captured by the notion of diffusion distances [Nadler et al. 2005]. The diffusion distance D t (x i , x j ) is defined as difference between the probabilities that a random walker starting at each of these two points will end up in the same position at time t. where p(t, z|x) is the probability of a random walker to transition from x to z in t time steps, and w(z) is the reciprocal of the local density at z. Intuitively, the more short paths connect two points, the smaller the diffusion distance between them. Note that (3) defines a family of diffusion distances parameterized by the time t. As t increases, two points that were originally distant from each other may grow closer. Diffusion map. It may be shown that M has a set of n real eigenvalues {? i } n?1 0 . Note that the eigenvector ? 0 does not participate in the diffusion map, since it is constant and thus does not contribute any discriminating information. In other words, the diffusion distance between two points is simply the sum of squared differences between the corresponding entries of the eigenvectors ? i , where each eigenvector is weighted by ? i t . In practice, the matrix M often exhibits a spectral gap, i.e., only a few of its eigenvalues are close to one, while the rest are much example image 40 20 pixels in LAB space ? 3 , ? 3 = Thus, the diffusion distance is well approximated by a diffusion map constructed from the first k eigenvectors, with the accuracy of the approximation increasing with the time t. As discussed in Section 5, the value of k depends on the spatial support of the affinity kernel. Figure 2 shows a visualization of the first three eigenvectors produced from the input image. Note that the first eigenvector ? 1 roughly clusters the image into two main regions (corresponding to sky and ground), ? 2 mainly distinguishes the red flowers from everything else, while ? 3 sets apart the white clouds from everything else. The next eigenvectors (not shown), corresponding to smaller eigenvalues further separate between progressively smaller regions in the image. Since all eigenvalues are strictly smaller than 1, increasing the value of the time parameter t gives more weight to the ?coarser? eigenvectors. Thus, diffusion distances corresponding to higher values of t emphasize edges separating between the coarser clusters, while suppressing those that separate smaller scale image regions. In the Section 4 we demonstrate the usefulness of diffusion distances by plugging them in place of regular pairwise distances in several edge-aware operations. A possible concern regarding the use of diffusion distances in practice is the added computational cost. The Nystr?m approximation method proceeds as follows. This corresponds to partitioning the complete N ? N affinity matrix W as: Note that the block C, which contains the bulk of the pairwise affinities is never actually computed. The approximate eigenvectors V of W are then given as Intuitively, we compute the eigenvalues and eigenvectors of the sampled matrix A, and use B to ?upsample? these vectors to the full resolution of the original problem. This approximation yields the eigenvectors of W , while the diffusion map consists of the eigenvectors of M = D ?1 W , where D i,i = ? j W i j . Thus, a practical method for computing the diffusion maps involves sampling the image. In Section 5 we show that, for a given accuracy, the number of samples depends on N/? 2 , where ? is the pairwise interaction range between pixels. Therefore, if the affinity matrix allows all pairs of pixels to interact, a constant number of samples will suffice. The exact number depends on the image at hand, since the reduced matrix should ideally represent the main Local edit propagation. Top: input with scribbles and result using ordinary distances (middle) and diffusion distances (right), computed with spatial coordinates (t = 16). Bottom: The corresponding influence maps for the green scribble. distinct regions present in the image. The samples are placed using stratified sampling of the image, as was also done by An and Pellacini [2008]. The following times (in seconds) were measured 1 when constructing a diffusion map with 7 eigenvectors for different image sizes and numbers of samples:\n          0.5 MP 0.75 MP 1 MP 1.5 MP 2 MP 10 samples 0.58 0.58 0.79 1.12 1.53 30 samples 1.24 1.82 2.46 3.57 4.84 60 samples 2.44 3.66 4.95 7.20 9.75 For each operator we compare its performance with and without the use of diffusion distances. Rather, we aim to show that there are practical scenarios where state-of-theart methods perform better with diffusion distances, given the same input. We experimented with a number of color spaces when computing the affinity matrices, and for all the results shown in this paper we use the CIELAB color space (normalized such that the L channel range is [0, 1]). We have also experimented with a number of different feature vectors. Using the pixel colors along with spatial coordinates is an attractive option, since it typically yields good results. However, it reduces the spatial interaction range between pixels, and therefore requires using more Nystr?m samples to compute the diffusion map, as shown in Section 5. For that reason, in all of our results except Figures 3 and 9, we use only the color at each pixel (no spatial attenuation), and compute diffusion maps using 30 samples. Throughout this section, for each result using the diffusion distances we report the value of t which we used. Possible strategies for setting this parameter are discussed in Section 6. input image [Subr et al. 2009] WLS with diffusion Local edit propagation. Figure 1 demonstrates the performance of diffusion distances in the context of local edit propagation from sparse user constraints by plugging these distances into the optimization-based approach described by Lischinski et al. [2006]. The goal is to apply a warming filter to the city buildings and a cooling filter in the sky and water regions using minimal user input. Indeed, the original method fails to propagate the yellow scribble to capture the entire region of interest. When using diffusion distances with t = 2 the result is slightly better, but increasing the time to t = 16 nicely captures the target area, and produces a significantly better result. Although the two regions appear quite distinct to a human observer, selecting each of them using state-of-the-art commercial tools proved to require a substantial amount of user interaction. Using again the method of Lischinski et al. [2006] we were not able to obtain a satisfactory result with a sparse set of scribbles, since the gradients between the two regions and inside each region are of the same order of magnitude. Switching to diffusion maps constructed using the color at each pixel only produced a similar unsatisfactory result. However, by adding the spatial coordinates to the feature vectors and feeding the resulting diffusion distances into the same method, we were able to produce a more satisfactory result. Similar improvements in propagation may be observed there as well. In practice, scribble-based editing is intended for an iterative interactive workflow, where the user is able to add or remove scribbles until a satisfactory result is achieved. With sufficient amount of user input it is obviously possible to achieve results that are identical or better than those that we have shown. Thus, the practical advantage of using diffusion distances in this context lies in reducing the amount of necessary user input. Edge-preserving smoothing. Figure 4 compares the results of filtering an image with the WLS edge-preserving smoothing operator [Farbman et al. 2008] with and without the use of diffusion distances. This example contains textures with high gradients on the buildings in the background. The WLS operator controls the degree of smoothing via a parameter ? . When the value of ? is chosen so as to remove most of the texture form the building, this results in faded edges between the buildings and the sky (top middle image). Such contrast reduction is undesirable for applications such as image abstraction. When the same operator uses diffusion distances, the contrast of these edges is better preserved (top right). The bottom row shows what happens when the removed texture detail is amplified and added back in (local contrast boost). It may be seen that the detail on the buildings is boosted in a much more uniform manner on the right. Figure 5 shows a comparison between a result produced by the method recently proposed by Subr et al. [2009], and the result of edge-preserving filtering with WLS using diffusion distances. Subr et al. first search for the local extrema in the image, and then fit a lower and an upper envelope to these extrema by solving a linear system twice. It may be seen that WLS with diffusion distances is able to remove the small scale detail on the vase just as effectively, while avoiding the costs of non-linear filtering or solving multiple linear systems. We also experimented with incorporating the diffusion distance into matting method by Levin et al. [2008a]. Unlike many matting algorithms that assume a tight trimap, this method also admits sparse user scribbles indicating background and foreground, which are propagated over the image to yield an alpha matte. We have modified the authors? original code to use diffusion coordinates instead of colors when constructing the matting Laplacian. Figure 6 shows an example where the modified method produces a matte that is closer to the ground truth than the original method. As with local image editing, we found that fewer scribbles are necessary to produce an accurate matte with diffusion distances in the presence of textured regions. To further evaluate the matting performance, we also ran the benchmark suggested in [Rhemann et al. 2009], but we did not see any significant increase in quantitative accuracy. This can be explained by the fact that this benchmark uses tight trimaps; thus, the ability of diffusion distances to propagate across textured regions does not play a significant role. When the input trimap is loose, the visual accuracy of the diffusion-based mattes is sometimes better (see the supplementary materials). In local edit propagation, a particular adjustment is propagated and applied to all the pixels within a contiguous region indicated by the  user. For example, in Figure 7 , modifying the color of the soil and the bushes independently is difficult to accomplish using scribble-based local propagation. An experienced Photoshop user might prefer first to create a mask separating the ground from the sky, and then use color range selection tools to further separate the ground to reds and greens. Here we demonstrate that having diffusion maps under the hood can also be useful for quickly obtaining similar fuzzy masks. Recall that diffusion maps consist of the dominant eigenvectors of the all-pairs affinity matrix, which discriminate between the dominant modes in the data at various scales. Each eigenvector consists of positive and negative values (shown in shades of red and blue in Figures 1 and 2), with the transitions between negative and positive regions corresponding to transitions between clusters. Thus, our idea is that given a scribble drawn by the user we first identify which of the eigenvectors in the diffusion map ?responds? most strongly to this scribble by measuring the variance of each eigenvector in the pixels covered by the scribble. Having found such an eigenvector we use it to produce a mask that captures either the positive or the negative regions of this eigenvector. Formally, given a user scribble S we first search for the eigenvector ? i which exhibits the highest variance in the area covered by the scribble: We then use this eigenvector to define two masks, for the areas where the eigenvector is positive and negative, respectively: where the parameter a enables the user to control the hardness of the masks (a < 1 makes the masks softer, while a > 1 makes them harder). Note that the masks are normalized such that their sum at every pixel is 1. It is often the case that the first eigenvector ? 1 effectively partitions the image into two main regions (e.g., ground and sky, as seen in Figures 1 and 2). Thus, if the scribble S is contained in one of these two regions, we assume that it is the user?s intent to apply the manipulation only inside the containing region. In this case, we also define an attenuation mask: The final mask used to edit the image is then given by the product of one of the masks M ? + i or M ? + i with the attenuation mask M att . The process is demonstrated in Figure 7 . The user first draws a scribble across the boundary between the two main regions in the image (sky and ground). The first eigenvector responds most strongly to this scribble, yielding a mask distinguishing between the two regions, and the user is able to boost the local contrasts in the sky without significant effect elsewhere. The next scribble is drawn across the ground region, and the eigenvector that responds most strongly discriminates between the red soil and the green vegetation. The user uses one of the two resulting masks (M + in this ? 2 case) to change the hue and saturation of the soil, and its complement (M + ) to make the vegetation more green, using a different ? 2 hue/saturation adjustment. Here, attenuating by the mask of the first eigenvector helps confine the edit to the ground region (the figure shows the attenuated mask M att M ? + 2 ). Finally, a scribble across the sky produces a mask that discriminates between the blue sky and the white clouds, enabling the user to deepen the color of the sky. Again, the edits are attenuated to apply only in the sky region, yielding the final result. input image mask 1 result 1 mask 2 The optimization-based edit propagation operators explored so far in the literature may be grouped into two main classes, based on the spatial range of the interactions that they explicitly account for. Below, we review the methods used for solving the edit propagation problem in each of these two cases, and conclude that these methods are not well suited for handling middle-range interactions. However, a careful spectral analysis of the corresponding affinity matrices leads naturally to a hybrid solution method that makes it possible to handle this intermediate case, both accurately and efficiently. Interaction range. Optimization-based edge-aware edit propagation methods solve a linear system of the form Lx = b, where L = D ?W is a non-homogeneous Laplacian matrix, W is an affinity matrix, such as the one defined in eq. (2), and D is a diagonal matrix given by D i,i = ? j W i, j . Let us define the spatial interaction range ? as the radius (in pixels) beyond which the pairwise affinity between two pixels in the image falls below some threshold ?. For example, the 5-point inhomogeneous Laplacian operator used in [Lischinski et al. 2006; Farbman et al. 2008] corresponds to ? = 1. Levin et al. [2004; 2008a] use a slightly larger (but still constant) interaction range, while the all-pairs approach [An and Pellacini 2008] uses an interaction range ? = O(n), where n is the dimension (width or height) of the image. When ? is a small constant, edits propagate well within smooth contiguous image regions, but the propagation is blocked by strong edges in the image, so fragmented or strongly textured regions cannot be handled. At the other extreme, when ? = O(n), edits are allowed to propagate between regions of similar attributes, even if these regions are distant and completely separated by regions with very different color attributes. If one is interested in being able to handle fragmented regions, while at the same time having the flexibility of local control, using an intermediate interaction range 1 ? n might provide the answer. However, as we shall see below, in the latter case it is not clear how the resulting systems of linear equations can be efficiently computed and solved in practice. Existing approaches. Let us review the solution methods that are commonly used to handle the two extreme cases. The case of sparse Laplacian matrices has been studied extensively in the numerical computing literature, since such matrices are used for approximating differential operators. It is well known [Trottenberg et al. 2001] that such matrices have a condition number that grows as a function of n 2 , and their eigenvectors correspond to modes with variations at different scales (Fourier modes at different wavelengths). There-\n        result 2 mask 3 result 3\n        fore, such matrices are treated with multi-scale preconditioners that capture and rescale these modes, such as the geometric Multigrid method [Trottenberg et al. 2001], or conjugate gradient with hierarchical basis preconditioning [Szeliski 1990]. Recently, several works showed that the actions performed by these non-homogeneous Laplacian systems can be approximated efficiently without explicitly constructing, preconditioning, and solving the full-resolution linear system [Kopf et al. 2007; Fattal 2009]. In contrast, the global all-pairs Laplacians behave differently: they are dense and hence linear relaxations such as Gauss-Seidel or conjugate gradient become prohibitively expensive, since each matrixvector multiplication costs O(N 2 ). An and Pellacini [2008] exploit this observation, and use the Nystr?m method [Williams and Seeger 2000], to first drastically reduce the dimensionality of the matrix and then solve the associated Laplacian in its reduced form, using the Woodbury formula [Golub and Van Loan 1998]. To summarize the discussion so far, a variety of efficient and accurate solutions exist for the two extreme cases of either very sparse or fully dense inhomogeneous Laplacians. These solutions are practically linear in the number of pixels N. However, these solutions are not well suited for the intermediate case of 1 ? n, since the corresponding affinity matrices are neither sufficiently sparse, nor sufficiently rank-deficient [An and Pellacini 2008]. Rank vs. interaction range. The top right plot in Figure 8 shows several spectra of normalized Gaussian affinity matrices corresponding to increasing values of ? s (and hence increasing values of ?). Note that for short interaction ranges, most eigenvalues are non-negligible, but their number indeed decreases as ? s becomes larger. Plotting the numerical rank as a function of N/? 2 ( Figure 8 , bottom left) reveals that as ? gets smaller, the rank grows approximately as N/? 2 . In the spatially-homogeneous case (a constant, or very smooth image), this empirical result can be verified formally by noticing that W is a circulant matrix that corresponds to convolution with the affinity kernel, e.g., exp(? r 2 /? s 2 ). In this case, the eigenvalues 96 test windows (in blue). The red line starts at a constant value on the left and grows to full rank linearly in N/? 2 , indicating our proposed sampling strategy. Bottom right: Nystr?m approximation error as a function of ? for different sampling strategies, measured for one of the windows. ? k of W are given (up to scale) by [Oppenheim and Schafer 1975] where k are the indices in the Fourier domain. Thus, the number of eigenvalues of W above some fixed threshold ? is proportional to the number of different k?s that satisfy: In two dimensions these are all the k?s that fall inside a circle whose radius is proportional to n/? s , and substituting ? s = ? and N = n 2 we obtain that the rank of W is O(N/? 2 ). The homogeneous analysis then applies to each block once ? becomes sufficiently small, and thus the overall rank of W grows, like before, as O(N/? 2 ). In extremely cluttered/textured windows, the growth is more concave for large values of ?. Specifically, the actual slopes of the curves of the different test windows on the left end of the plot (large ?) are between 0.85 and 6.39, while on the right end of the plot (approaching ? = 1) the slopes are between 0.82 and 0.93. To summarize, the affinity matrices for 1 ? ? ? n case have rank O(N/? 2 ) and a sparsity pattern of O(? 2 ) non-zeros per row. This means that when applying the Nystr?m approximation one should sample the image at a rate of O(1/?) along each dimension (one in every O(? 2 ) columns of W ). Then, the reduced matrix A in eq. (6) is full-rank and has a sparsity pattern of O(1), which makes it possible to use standard iterative linear solvers. As Figure 8 shows, for large ? values the rank grows somewhat faster than the linear prediction. Therefore, we suggest the following strategy: start with some constant number (tens to a few hundred) samples for the all-pairs case, and increase the number of samples proportionally to N/? 2 . This strategy is demonstrated in the bottom right plot of Figure 8 , which confirms that the error corresponding to a constant number of samples increases as ? decreases, while using N/? 2 samples results in a non-increasing error. Edit propagation example. Figure 9 demonstrates the importance of using an appropriate sampling rate for edit propagation in practice. Suppose that given the input image the user wishes to recolor all of the tulips and marks a single tulip with one scribble, while placing another scribble across the background. The all-pairs approach is well-suited for this scenario, and the desired interaction range here is roughly the entire image. According to our analysis, a small constant number of samples suffices for this case. Indeed, the propagation masks obtained using a small (50) and a larger number of samples look virtually identical, and produce the same visual result. In contrast, suppose the goal is to recolor only the left and right flowers, while keeping the original color in the middle. In this case, using a small number of samples no longer produces the desired mask, which is nevertheless obtained with a suitably larger number of samples. Efficient numerical solution. The analysis we have presented in this section, suggests not only the correct sampling rate to use with intermediate interaction ranges, but also how to efficiently solve the associated linear system D ?W . According to the Nystr?m approximation, and applying the Woodbury identity [Golub and Van Loan 1998] yields: An and Pellacini were able to evaluate eq. (16) efficiently using direct methods, because they use a constant number of samples m N. When the rank of W is not sufficiently small, and hence the number of samples m has to be larger, we observe that it is still possible to evaluate eq. (16) efficiently. This is so since both A and U T D ?1 U are sparse (the latter is sparse since it involves inner products between vectors that are nonzero over mostly nonoverlapping image regions). Thus, instead of using direct matrix inversion, (?A + U T D ?1 U) can be inverted using standard sparse linear solvers in linear time. The time parameter t. In the diffusion map, edges separating between larger clusters appear in the leading eigenvectors, while lower eigenvectors are populated by edges separating finer clusters. Thus, the time parameter t effectively attenuates transitions between these finer clusters with respect to coarser ones. By increasing the value of t one obtains stronger, more aggressive edgepreserving smoothing and interpolation. We envision several options for setting the value of this parameter in practice. It should be emphasized here that changing the value of t only rescales the diffusion map eigenvectors (eq. 4), but does not require recomputing them. Computational costs. In order to use diffusion distances instead of regular distances in color space it is necessary to first construct the input image mask (50 samples) mask (500 samples) input + scribbles edited result edited result input + scribbles mask (50 samples) mask (500 samples) edited result edited result diffusion map. The computation times for our current implementation are reported in Section 4. While these times might appear significant compared to the interactive editing turnaround times of the fast bilateral filter [Chen et al. 2007] or of edge-avoiding wavelets [Fattal 2009], one should keep in mind that the diffusion map only needs to be computed once, before interactive editing commences. Thus, one might view it as a color space conversion, done when the image to be edited is loaded from the disk. As such, it does not necessarily slow down the interaction of the user with the image (computations might only be a bit slower if more than 3 eigenvectors are used instead of the 3 color channels of the original image). Strengths and weaknesses. One of the challenges of edge-aware operators is to distinguish between high gradients (color differences) that occur in highly textured regions and between salient edges that separate different larger scale regions. In our approach we effectively assume that textured regions are characterized by multiple transitions between the texture elements, thus there are more paths in color space between different valued pixels occurring within the same texture than between distinct larger scale regions. Thus, the use of diffusion distances in place of color differences is advantageous in images containing relatively large heavily textured regions: edge-aware interpolation is shown to propagate better inside such regions, and the removal of texture by edge-preserving smoothing is shown to be more effective. Examples include scribbles that cover most of the target region, scribbles that follow closely the boundaries of such regions, tight trimap, etc. However, we have not encountered cases where the results suffer from the use of diffusion distances, except bearing the added computational costs discussed earlier. It should be pointed out that not all textures satisfy the assumptions of our approach. For example, a skirt with many colorful swatches might not have significantly more transition pixels between the different swatches than the transitions between the shirt and the background. Thus, some inter-swatch transitions inside the shirt might be present already in one of the leading eigenvectors, the diffusion distance between them will still be significant, and propagation/smoothing inside the shirt will not be significantly improved. As another difficult example, consider two adjacent regions which are semantically distinct, but have textures with similar colors. In such a case, propagation from a scribble inside one region might propagate into the adjacent region give a sufficiently high value of t, but for a small value of t will not be better than when using ordinary color differences. Both examples above are included in the supplementary material. In this paper we have introduced the idea of performing edge-aware operations on images using diffusion distances instead of Euclidean distances. We have demonstrated that diffusion distances, which account for both the length and the number of paths between the data points in the feature space, provide local edit propagation schemes and edge-preserving smoothing operators with a valuable global perspective of the clusters present in the feature space at a variety of scales. We have also provided an analysis that extends the applicability of the Nystr?m method to a more general class of affinity matrices, and suggested an efficient solution for the entire range of spatial interactions. The use of diffusion distances spans a two-dimensional space of edge-aware operators. The two axes of this space are the diffusion time parameter t and the spatial interaction range ?. Currently, it is up to the user to specify the appropriate values for these two parameters. This provides an important degree of user control, but it is currently unclear how to automatically determine the optimal combination of these two parameters for a particular image manipulation task. We currently construct diffusion maps using only the color and (sometimes) spatial position of the pixels in the image. A natural direction to explore is working in a richer feature space. However, our preliminary attempts in this direction were not too successful, since as was pointed out earlier, existing texture descriptors effectively operate at a lower spatial resolution. All of the existing edge-aware operators are oblivious to semantic content. For example, a human present in the image (or any other object with a large variance in texture and/or color) is unlikely to be selected or edited as a single region, unless sufficient user input is provided. Thus, integration of object detection and recognition algorithms into image editing tools seems a fruitful direction to explore. Acknowledgments: This work was supported in part by the Israel Science Foundation founded by the Israel Academy of Sciences and Humanities.",
  "resources" : [ ]
}