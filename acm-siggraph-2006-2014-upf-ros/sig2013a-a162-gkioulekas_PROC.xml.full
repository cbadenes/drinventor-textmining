{
  "uri" : "sig2013a-a162-gkioulekas_PROC.xml",
  "url" : "/Users/cbadenes/Documents/OEG/Projects/DrInventor/datasets/acm-siggraph-2006-2014-upf/sig2013a/a162-gkioulekas_PROC.xml",
  "source" : {
    "name" : "SIGGRAPH",
    "uri" : "http://drinventor/SIGGRAPH",
    "url" : "http://drinventor/SIGGRAPH",
    "protocol" : "http"
  },
  "metainformation" : {
    "title" : "Inverse Volume Rendering with Material Dictionaries",
    "published" : "2013",
    "format" : "pdf",
    "language" : "en",
    "rights" : "GPLv2",
    "description" : "",
    "creators" : [ {
      "uri" : "http://drinventor/Ioannis-Gkioulekas",
      "name" : "Ioannis",
      "surname" : "Gkioulekas"
    }, {
      "uri" : "http://drinventor/Shuang-Zhao",
      "name" : "Shuang",
      "surname" : "Zhao"
    }, {
      "uri" : "http://drinventor/Kavita-Bala",
      "name" : "Kavita",
      "surname" : "Bala"
    }, {
      "uri" : "http://drinventor/Todd-Zickler",
      "name" : "Todd",
      "surname" : "Zickler"
    }, {
      "uri" : "http://drinventor/Anat-Levin",
      "name" : "Anat",
      "surname" : "Levin"
    } ]
  },
  "bagOfWords" : [ "47cf3c40342b114fc05089051df018ac3ac6d30ecb9410aed71c33eafe2fc243", "p35", "10.1145", "2508363.2508377", "name", "identification", "possible", "inverse", "volume", "render", "Material", "Dictionaries", "Ioannis", "Gkioulekas", "Shuang", "Zhao", "Kavita", "Bala", "Harvard", "University", "Cornell", "University", "Cornell", "University", "Figure", "acquire", "scatter", "parameter", "leave", "sample", "two", "material", "-lrb-", "milk", "blue", "curacao", "-rrb-", "glass", "cell", "use", "acquisition", "middle", "sample", "illuminate", "trichromatic", "laser", "beam", "observe", "scattering", "pattern", "use", "input", "we", "optimization", "right", "rendering", "material", "natural", "illumination", "use", "we", "acquire", "material", "parameter", "value", "scatter", "play", "critical", "role", "appearance", "most", "material", "much", "effort", "have", "be", "devote", "modeling", "simulate", "its", "visual", "effect", "give", "we", "precise", "efficient", "scatter", "simulation", "algorithm", "however", "algorithm", "produce", "image", "only", "accurate", "material", "parameter", "give", "input", "create", "need", "acquisition", "system", "can", "faithfully", "measure", "scattering", "parameter", "real-world", "material", "collect", "accurate", "repeatable", "measurement", "scattering", "significant", "challenge", "homogeneous", "materials?which", "primary", "topic", "paper?scattering", "any", "particular", "wavelength", "describe", "two", "scalar", "value", "one", "angular", "function", "scattering", "coefficient", "absorption", "coefficient", "represent", "fraction", "light", "scatter", "absorb", "phase", "function", "-lrb-", "-rrb-", "describe", "angular", "distribution", "scattering", "measurement", "difficult", "because", "sensor", "almost", "always", "observe", "combined", "effect", "many", "scattering", "absorption", "event", "three", "factor", "can", "easily", "separate", "indeed", "deeplyscatter", "geometry", "similarity", "theory", "-lsb-", "Wyman", "et", "al.", "1989", "-rsb-", "prove", "one", "can", "analytically", "derive", "distinct", "parameter-set", "nonetheless", "produce", "indistinguishable", "image", "abstract", "translucent", "material", "ubiquitous", "simulate", "appearance", "require", "accurate", "physical", "parameter", "however", "physicallyaccurate", "parameter", "scatter", "material", "difficult", "acquire", "we", "introduce", "optimization", "framework", "measure", "bulk", "scattering", "property", "homogeneous", "material", "-lrb-", "phase", "function", "scatter", "coefficient", "absorption", "coefficient", "-rrb-", "more", "accurate", "more", "applicable", "broad", "range", "material", "optimization", "combine", "stochastic", "gradient", "descent", "Monte", "Carlo", "render", "material", "dictionary", "invert", "radiative", "transfer", "equation", "offer", "several", "advantage", "-lrb-", "-rrb-", "do", "require", "isolate", "singlescattering", "event", "-lrb-", "-rrb-", "allow", "measure", "solid", "liquid", "hard", "dilute", "-lrb-", "-rrb-", "return", "parameter", "physically-meaningful", "unit", "-lrb-", "-rrb-", "do", "restrict", "shape", "phase", "function", "use", "henyey-greenstein", "any", "other", "low-parameter", "model", "we", "evaluate", "we", "approach", "create", "acquisition", "setup", "collect", "image", "material", "slab", "under", "narrow-beam", "rgb", "illumination", "we", "validate", "result", "measure", "prescribe", "nano-dispersion", "show", "recover", "parameter", "match", "those", "predict", "Lorenz-Mie", "theory", "we", "also", "provide", "table", "RGB", "scatter", "parameter", "some", "common", "liquid", "solid", "which", "validate", "simulate", "color", "image", "novel", "geometric", "configuration", "match", "corresponding", "photograph", "less", "than", "error", "cr", "category", "i.", "3.7", "-lsb-", "Computer", "Graphics", "-rsb-", "three-dimensional", "graphic", "realism?raytracing", "Keywords", "scattering", "inverse", "rendering", "material", "dictionary", "Links", "dl", "pdf", "EB", "ACM", "Reference", "Format", "Gkioulekas", "I.", "Zhao", "S.", "Bala", "K.", "Zickler", "T.", "Levin", "A.", "2013", "inverse", "volume", "render", "Material", "Dictionaries", "ACM", "Trans", "graph", "32", "Article", "162", "-lrb-", "November", "2013", "-rrb-", "13", "page", "dous", "10.1145", "2508363.2508377", "http://doi.acm.org/10.1145/2508363.2508377", "copyright", "Notice", "permission", "make", "digital", "hard", "copy", "all", "part", "work", "personal", "classroom", "use", "grant", "without", "fee", "provide", "copy", "make", "distribute", "profit", "commercial", "advantage", "copy", "bear", "notice", "full", "citation", "fus", "rst", "page", "copyright", "component", "work", "own", "other", "than", "ACM", "must", "honor", "abstract", "credit", "permit", "copy", "otherwise", "republish", "post", "server", "redistribute", "list", "require", "prior", "specific", "permission", "and/or", "fee", "request", "permission", "from", "permissions@acm.org", "copyright", "ACM", "0730-0301/13", "11-art162", "15.00", "DOI", "http://doi.acm.org/10.1145/2508363.2508377", "Todd", "Zickler", "Anat", "Levin", "Harvard", "University", "Weizmann", "Institute", "introduction", "most", "exist", "acquisition", "system", "address", "measurement", "challenge", "use", "combination", "two", "strategy", "-lrb-", "e.g.", "-lsb-", "Hawkins", "et", "al.", "2005", "Narasimhan", "et", "al.", "2006", "Mukaigawa", "et", "al.", "2010", "-rsb-", "-rrb-", "first", "manipulate", "lighting", "and/or", "material", "isolate", "single-scattering", "effect", "second", "regularize", "recover", "scattering", "parameter", "rely", "low-parameter", "phase", "function", "model", "henyey-greenstein", "-lrb-", "HG", "-rrb-", "model", "approach", "can", "provide", "accurate", "result", "both", "employ", "strategy", "have", "severe", "limitation", "single-parameter", "HG", "model", "limit", "applicability", "material", "represent", "well", "exclude", "some", "common", "natural", "material", "-lsb-", "gkiouleka", "et", "al.", "2013", "-rsb-", "meanwhile", "isolate", "single", "scattering", "rely", "either", "-lrb-", "-rrb-", "dilute", "sample", "-lsb-", "Hawkins", "et", "al.", "2005", "Narasimhan", "et", "al.", "2006", "-rsb-", "which", "can", "easily", "apply", "solid", "liquid", "have", "unknown", "disperse", "media", "-lrb-", "-rrb-", "use", "structured", "lighting", "pattern", "-lsb-", "Mukaigawa", "et", "al.", "2010", "-rsb-", "which", "provide", "only", "approximate", "isolation", "-lsb-", "holroyd", "Lawrence", "2011", "Gupta", "et", "al.", "2011", "-rsb-", "therefore", "induce", "error", "measure", "scattering", "parameter", "difficult", "characterize", "we", "introduce", "optimization", "framework", "allow", "measure", "homogeneous", "scatter", "parameter", "without", "limitation", "we", "optimization", "undo", "effect", "low-order", "scattering", "invert", "radiative", "transfer", "equation", "-lrb-", "i.e.", "invert", "random", "walk", "-rrb-", "use", "combination", "Monte", "Carlo", "render", "stochastic", "gradient", "descent", "we", "evaluate", "we", "optimization", "framework", "create", "volumetric", "scanner", "use", "camera", "narrow-beam", "RGB", "source", "collect", "handful", "image", "material", "sample", "reside", "box-shaped", "transparent", "glass", "cell", "-lrb-", "figure", "leave", "-rrb-", "once", "calibrate", "scanner", "provide", "image", "low-order", "scattering", "which", "geometry", "precisely", "know", "use", "image", "we", "optimize", "dictionary-based", "set", "scatter", "parameter", "so", "produce", "re-rendered", "image", "match", "acquire", "one", "we", "validate", "we", "result", "two", "way", "one", "we", "measure", "prescribe", "dispersion", "nano-scale", "particle", "whose", "scattering", "parameter", "can", "compute", "use", "Lorenz-Mie", "theory", "show", "we", "recover", "parameter", "close", "agreement", "two", "we", "re-render", "color", "image", "material", "novel", "lighting", "configuration", "show", "numerically", "match", "within", "new", "capture", "image", "benefit", "we", "approach", "-lrb-", "-rrb-", "we", "can", "accurately", "measure", "scatter", "broader", "set", "liquid", "solid", "since", "need", "precisely-isolated", "singlescattering", "effect", "thickness", "glass", "cell", "can", "select", "appropriately", "each", "material", "do", "need", "choose", "excessive", "care", "since", "we", "optimization", "succeed", "relatively", "broad", "range", "thickness", "-lrb-", "anywhere", "between", "0.1", "10", "time", "mean", "free", "path", "material", "be", "measure", "-rrb-", "-lrb-", "-rrb-", "we", "can", "support", "general", "phase", "function", "measurement", "restricted", "HG", "other", "low", "parameter", "model", "because", "we", "optimization", "incorporate", "large", "material", "dictionary", "allow", "phase", "function", "any", "convex", "combination", "hundred", "dictionary", "element", "general", "phase", "function", "particularly", "visually", "important", "accurate", "visual", "appearance", "object", "thin", "feature", "we", "contribution", "include", "optimization", "framework", "invert", "volumetric", "scattering", "use", "MC", "render", "stochastic", "gradient", "descent", "acquisition", "setup", "acquire", "homogeneous", "material", "scattering", "property", "physically", "accurate", "parameter", "table", "RGB", "scatter", "parameter", "variety", "common", "material", "both", "liquid", "solid", "well", "publicly-available", "collection", "tabulated", "phase", "function", "availability", "physically-accurate", "scattering", "parameter", "general", "phase", "function", "can", "improve", "simulation", "translucent", "material", "appearance", "better", "match", "real", "world", "ACM", "transaction", "Graphics", "Vol", "32", "no.", "Article", "162", "publication", "date", "November", "2013", "162:2", "i.", "Gkioulekas", "et", "al.", "related", "work", "inverse", "radiative", "transport", "study", "graphic", "well", "geophysical", "biomedical", "chemistry", "domain", "bal", "-lsb-", "2009", "-rsb-", "provide", "comprehensive", "review", "problem", "can", "group", "three", "category", "accord", "ratio", "material?s", "mean", "free", "path?the", "average", "distance", "photon", "travel", "before", "scattered?to", "size", "scattering", "volume", "we", "discuss", "three", "category", "turn", "we", "discuss", "phase", "function", "model", "surface-based", "appearance", "model", "deep", "scattering", "approximation", "diffusion", "inverse", "problem", "category", "consider", "media", "optically-thick", "so", "photon", "scatter", "many", "time", "before", "be", "measure", "radiative", "transport", "model", "use", "diffusion", "approximation", "where", "angular", "variation", "internal", "radiance", "limited", "radiative", "transport", "equation", "reduce", "partial", "differential", "equation", "-lsb-", "Ishimaru", "1978", "-rsb-", "advantage", "approach", "simplify", "inference", "problem", "allow", "efficient", "acquisition", "render", "system", "-lsb-", "Jensen", "et", "al.", "2001", "Donner", "Jensen", "2005", "-rsb-", "demonstrate", "Wang", "et", "al.", "-lsb-", "2008", "-rsb-", "estimation", "spatially-varying", "structure", "within", "medium", "physics", "diffusion", "approximation", "employ", "diffusing-wave", "spectroscopy", "-lsb-", "Pine", "et", "al.", "1990", "-rsb-", "which", "use", "application", "particle", "size", "measurement", "molecular", "weight", "diffusion", "approximation", "apply", "when", "high-order", "scattering", "dominant", "cause", "phase", "function", "confound", "other", "scatter", "parameter", "-lsb-", "Wyman", "et", "al.", "1989", "-rsb-", "therefore", "reasonable", "ignore", "appropriate", "we", "application", "where", "we", "seek", "material-specific", "phase", "function", "can", "accurately", "predict", "appearance", "shape", "have", "arbitrary", "thin", "thick", "part", "single", "scattering", "direct", "method", "other", "extreme", "optically-thin", "situation", "where", "photon", "scatter", "only", "once", "before", "be", "measure", "scatter", "parameter", "can", "often", "measure", "directly", "case", "use", "technique", "like", "static", "dynamic", "light", "scattering", "-lsb-", "Johnson", "Gabriel", "1994", "-rsb-", "graphic", "Hullin", "et", "al.", "-lsb-", "2008", "-rsb-", "use", "fluorescent", "dye", "make", "qualitative", "observation", "scattering", "parameter", "optically", "thin", "media", "exhibit", "mostly", "single", "scattering", "Hawkins", "et", "al.", "-lsb-", "2005", "-rsb-", "use", "laser", "measure", "albedo", "tabulated", "phase", "function", "sparse", "homogeneous", "aerosol", "liquid", "Narasimhan", "et", "al.", "-lsb-", "2006", "-rsb-", "successively", "dilute", "sample", "water", "until", "sparse", "enough", "infer", "from", "single-scatter", "HG", "phase", "function", "single-scattering", "have", "also", "be", "exploit", "capture", "time-varying", "spatially-varying", "wisp", "smoke", "sparse", "mix", "liquid", "-lsb-", "Hawkins", "et", "al.", "2005", "Fuchs", "et", "al.", "2007", "Gu", "et", "al.", "2008", "-rsb-", "all", "technique", "rely", "manipulate", "material", "so", "single-scattering", "dominate", "while", "dilution", "can", "use", "aerosol", "some", "liquid", "can", "easily", "apply", "solid", "liquid", "whose", "disperse", "medium", "unknown", "significantly", "different", "from", "water", "limitation", "motivate", "method", "suppress", "multiple", "scattering", "without", "dilution", "technique", "particle", "size", "molecular", "weight", "example", "exploit", "crosscorrelation", "property", "multiple", "temporal", "measurement", "-lsb-", "Pusey", "1999", "-rsb-", "specific", "those", "application", "do", "easily", "extend", "we", "problem", "graphic", "Mukaigawa", "et", "al.", "-lsb-", "2010", "-rsb-", "use", "high", "frequency", "lighting", "pattern", "isolate", "single-scattering", "effect", "-lsb-", "Nayar", "et", "al.", "2006", "-rsb-", "allow", "direct", "access", "mean", "free", "path", "good", "initialization", "indirect", "-lrb-", "multi-scattering", "-rrb-", "optimization", "over", "HG", "phase", "function", "parameter", "lightingbased", "isolation", "single", "scattering", "potentially", "quite", "useful", "discuss", "context", "3d", "surface", "reconstruction", "-lsb-", "holroyd", "Lawrence", "2011", "Gupta", "et", "al.", "2011", "-rsb-", "provide", "only", "approximate", "isolation", "currently", "analysis", "how", "affect", "accuracy", "infer", "scattering", "parameter", "low-order", "scattering", "indirect", "method", "we", "approach", "category", "where", "goal", "use", "moderately-thick", "sample", "infer", "scatter", "parameter", "iteratively", "refine", "they", "until", "predict", "measurement", "consistent", "acquire", "one", "-lrb-", "e.g.", "-lsb-", "Singer", "et", "al.", "1990", "Mukaigawa", "et", "al.", "2010", "-rsb-", "-rrb-", "most", "approach", "focus", "like", "we", "do", "homogeneous", "material", "since", "already", "very", "challenging", "-lrb-", "notable", "exception", "Antyufeev", "-lsb-", "2000", "-rsb-", "who", "use", "regularize", "estimation", "infer", "spatiallyvarying", "phase", "function", "-rrb-", "common", "strategy", "biomedical", "physics", "domain", "simplify", "calculation", "use", "planar", "slab", "spatially-uniform", "lighting", "reduce", "relevant", "scene", "geometry", "from", "three", "dimension", "two", "-lrb-", "e.g.", "-lsb-", "Chen", "et", "al.", "2006", "Prahl", "et", "al.", "1993", "McCormick", "Sanchez", "1981", "-rsb-", "-rrb-", "have", "significant", "disadvantage", "limit", "access", "angular", "scatter", "information", "thereby", "increase", "reliance", "restrictive", "low-parameter", "phase", "function", "model", "contrast", "we", "optimization", "apply", "any", "geometrical", "configuration", "any", "incident", "light", "field", "long", "both", "precisely", "calibrate", "allow", "use", "narrow-beam", "illumination", "which", "improve", "access", "angular", "scatter", "information", "allow", "consider", "much", "richer", "space", "phase", "function", "model", "phase", "function", "model", "most", "exist", "approach", "inverse", "radiative", "transfer", "use", "single", "parameter", "henyey-greenstein", "-lsb-", "1941", "-rsb-", "model", "other", "low-parameter", "model", "-lsb-", "Reynolds", "McCormick", "1980", "-rsb-", "can", "only", "accurate", "material", "represent", "well", "shape", "phase", "function", "important", "appearance", "especially", "object", "thin", "part", "recently", "show", "Gkioulekas", "et", "al.", "-lsb-", "2013", "-rsb-", "common", "material", "well-represented", "HG", "model", "we", "avoid", "restriction", "low-parameter", "model", "through", "use", "phase", "function", "dictionary", "hundred", "element", "similar", "spirit", "dictionary-based", "brdf", "representation", "use", "analyze", "edit", "opaque", "scene", "without", "be", "restricted", "any", "particular", "analytic", "brdf", "model", "-lrb-", "e.g.", "-lsb-", "Lawrence", "et", "al.", "2006", "Ben-Artzi", "et", "al.", "2008", "-rsb-", "-rrb-", "surface", "reflectance", "field", "bssrdf", "number", "acquisition", "system", "devote", "recover", "surface-based", "description", "light", "transport", "through", "translucent", "object", "-lsb-", "Debevec", "et", "al.", "2000", "Goesele", "et", "al.", "2004", "Tong", "et", "al.", "2005", "Peers", "et", "al.", "2006", "Donner", "et", "al.", "2008", "-rsb-", "provide", "mapping", "between", "input", "output", "light", "field", "specific", "object?s", "surface", "do", "so", "without", "explicitly", "estimate", "all", "internal", "scattering", "parameter", "have", "advantage", "be", "very", "general", "provide", "accurate", "appearance", "model", "heterogeneous", "object", "complex", "shape", "we", "goal", "very", "different", "we", "seek", "scatter", "material", "parameter", "independent", "geometry", "so", "we", "can", "easily", "edit", "material", "accurately", "predict", "appearance", "when", "sculpt", "any", "geometric", "shape", "ACM", "transaction", "Graphics", "Vol", "32", "no.", "Article", "162", "publication", "date", "November", "2013", "Inverse", "volume", "render", "Material", "Dictionaries", "162:3", "volume", "light", "transport", "scattering", "occur", "light", "propagate", "through", "medium", "interact", "material", "structure", "many", "volume", "event", "cause", "absorption", "change", "propagation", "direction", "process", "have", "be", "model", "radiative", "transfer", "equation", "-lrb-", "rte", "-rrb-", "-lsb-", "Chandrasekhar", "1960", "Ishimaru", "1978", "Mishchenko", "et", "al.", "2006", "-rsb-", "-lrb-", "-rrb-", "-lrb-", "-rrb-", "-lrb-", "-rrb-", "-lrb-", "-rrb-", "-lrb-", "-rrb-", "-lrb-", "-rrb-", "where", "point", "interior", "boundary", "scattering", "medium", "point", "sphere", "direction", "usual", "spherical", "measure", "-lrb-", "-rrb-", "account", "emission", "from", "light", "source", "-lrb-", "-rrb-", "result", "light", "field", "radiance", "every", "spatial", "location", "orientation", "material", "characterize", "triplet", "macroscopic", "bulk", "parameter", "-lcb-", "-lrb-", "-rrb-", "-rcb-", "specifically", "extinction", "coefficient", "control", "spatial", "frequency", "scatter", "event", "scattering", "coefficient", "amount", "light", "scatter", "difference", "know", "absorption", "coefficient", "amount", "light", "absorb", "finally", "phase", "function", "function", "determine", "amount", "light", "get", "scatter", "towards", "each", "direction", "relative", "incident", "direction", "phase", "function", "often", "assume", "invariant", "rotation", "incident", "direction", "cylindrically", "symmetric", "therefore", "function", "only", "arcco", "-lrb-", "-rrb-", "satisfy", "normalization", "constraint", "-lrb-", "-rrb-", "sin", "-lrb-", "-rrb-", "we", "also", "adopt", "assumption", "remain", "paper", "consider", "only", "phase", "function", "type", "-lrb-", "we", "discuss", "some", "technical", "detail", "relate", "assumption", "Supplementary", "appendix", "-rrb-", "complementary", "above", "quantity", "follow", "two", "parameter", "also", "use", "describe", "scattering", "behavior", "mean", "free", "path", "equal", "albedo", "equal", "follow", "we", "use", "parameter", "triplet", "interchangeable", "term", "scatter", "material", "we", "consider", "homogeneous", "material", "which", "scattering", "parameter", "do", "depend", "spatial", "location", "scatter", "parameter", "also", "exhibit", "perceptually", "dominant", "spectral", "dependency", "-lsb-", "Fleming", "B?lthoff", "2005", "Frisvad", "et", "al.", "2007", "-rsb-", "notational", "clarity", "we", "omit", "wavelength", "dependency", "3.1", "operator-theoretic", "formulation", "we", "present", "operator-theoretic", "formulation", "RTE", "we", "use", "setup", "tractable", "optimization", "procedure", "volume", "render", "inversion", "specific", "formulation", "we", "use", "tailor", "toward", "we", "optimization", "algorithm", "approximation", "similar", "nature", "have", "be", "consider", "render", "application", "-lsb-", "rushmeier", "Torrance", "1987", "Bhate", "Tokuta", "1992", "-rsb-", "follow", "we", "consider", "only", "point", "interior", "scattering", "medium", "we", "discuss", "boundary", "condition", "other", "detail", "formulation", "Supplementary", "Appendix", "we", "begin", "consider", "finite", "difference", "approximation", "directional", "derivative", "-lsb-", "LeVeque", "2007", "-rsb-", "-lrb-", "-rrb-", "-lrb-", "-lrb-", "-rrb-", "-lrb-", "-rrb-", "-rrb-", "define", "-lrb-", "-rrb-", "hq", "-lrb-", "-rrb-", "after", "simple", "algebraic", "manipulation", "we", "obtain", "from", "equation", "-lrb-", "-rrb-", "-lrb-", "-rrb-", "-lrb-", "-rrb-", "-lrb-", "-rrb-", "-lrb-", "-rrb-", "-lrb-", "-rrb-", "-lrb-", "-rrb-", "we", "define", "follow", "linear", "operator", "term", "material", "parameter", "-lcb-", "-lrb-", "-rrb-", "-rcb-", "act", "function", "-lrb-", "-rrb-", "-lrb-", "-rrb-", "-lrb-", "-rrb-", "-lrb-", "-rrb-", "-lrb-", "-rrb-", "-lrb-", "-rrb-", "intuitively", "action", "can", "view", "single", "step", "temporal", "propagation", "photon", "inside", "medium", "after", "travel", "distance", "length", "photon", "transit", "one", "follow", "way", "-rrb-", "keep", "same", "direction", "unaffected", "medium", "-lrb-", "probability", "-rrb-", "-rrb-", "scatter", "towards", "new", "direction", "determine", "phase", "function", "-lrb-", "probability", "-rrb-", "-rrb-", "absorb", "-lrb-", "probability", "-lrb-", "-rrb-", "-rrb-", "consecutive", "application", "describe", "timeresolved", "random", "walk", "photon", "perform", "travel", "through", "medium", "use", "operator", "we", "can", "rewrite", "RTE", "-lrb-", "-rrb-", "form", "L.", "solve", "equation", "-lrb-", "-rrb-", "we", "can", "express", "light", "field", "result", "radiative", "transfer", "process", "input", "light", "field", "-lrb-", "-rrb-", "second", "equality", "equation", "-lrb-", "-rrb-", "follow", "apply", "Neumann", "series", "expansion", "apply", "inverse", "-lrb-", "we", "discuss", "invertibility", "Supplementary", "Appendix", "C.", "-rrb-", "imply", "light", "field", "result", "from", "radiative", "transfer", "process", "equation", "-lrb-", "-rrb-", "can", "express", "sum", "all", "order", "consecutive", "application", "input", "light", "field", "correspond", "asymptotic", "density", "photon", "when", "account", "all", "intermediate", "position", "each", "photon", "after", "arbitrary", "number", "random", "walk", "step", "we", "refer", "single-step", "propagation", "operator", "render", "operator", "material", "validity", "above", "formulation", "volume", "light", "transport", "rely", "accuracy", "approximation", "equation", "-lrb-", "-rrb-", "limit", "go", "zero", "operator", "light", "field", "equation", "-lrb-", "-rrb-", "converge", "usual", "volume", "render", "operator", "-lsb-", "Jensen", "2001", "-rsb-", "true", "light", "field", "inside", "volume", "Supplementary", "Appendix", "we", "discuss", "detail", "relationship", "well", "analogy", "between", "operator", "equation", "-lrb-", "-rrb-", "counterpart", "derive", "from", "volume", "render", "equation", "explain", "how", "small", "need", "depend", "extinction", "coefficient", "medium", "we", "experiment", "we", "use", "0.01", "ACM", "transaction", "Graphics", "Vol", "32", "no.", "Article", "162", "publication", "date", "November", "2013", "162:4", "i.", "Gkioulekas", "et", "al.", "invert", "volume", "scattering", "we", "interested", "use", "image", "unknown", "material", "recover", "its", "scattering", "parameter", "-lcb-", "-lrb-", "-rrb-", "-rcb-", "formally", "we", "consider", "known", "3d", "shape", "fill", "unknown", "material", "illuminate", "calibrate", "light", "source", "image", "calibrate", "camera", "produce", "image", "use", "volume", "scattering", "equation", "-lrb-", "-rrb-", "we", "can", "write", "-lrb-", "-rrb-", "where", "sampling", "operator", "describe", "combination", "light", "field", "ray", "measure", "corresponding", "camera", "term", "fold", "complete", "information", "about", "3d", "shape", "material", "volume", "relative", "light", "source", "camera", "position", "well", "light", "interaction", "interface", "between", "material", "volume", "its", "surroundings", "model", "light", "interaction", "involve", "knowledge", "material", "refraction", "index", "assumption", "further", "scattering", "between", "material", "camera", "give", "set", "illuminations", "-lcb-", "...", "-rcb-", "corresponding", "measurement", "...", "we", "cast", "problem", "infer", "material", "property", "appearance", "match", "framework", "find", "material", "parameter", "best", "reproduce", "measurement", "least-square", "sense", "10", "min", "-lrb-", "-rrb-", "where", "any", "permissible", "material", "parameter", "triplet", "-lcb-", "-lrb-", "-rrb-", "-rcb-", "we", "weight", "error", "each", "radiance", "measurement", "max", "-lrb-", "-rrb-", "prevent", "solution", "from", "overfitt", "only", "brightest", "measurement", "we", "select", "0.01", "use", "experiment", "synthetic", "datum", "describe", "section", "rest", "section", "we", "derive", "optimization", "algorithm", "appearance", "matching", "problem", "we", "express", "material", "parameter", "convex", "linear", "combination", "material", "dictionary", "we", "differentiate", "appearance", "match", "error", "respect", "mix", "weight", "derive", "efficient", "optimization", "scheme", "base", "stochastic", "gradient", "descent", "monte-carlo", "rendering", "despite", "highly", "non-linear", "problem", "we", "show", "through", "simulation", "error", "surface", "smooth", "without", "local", "minimum", "allow", "accurate", "reconstruction", "material", "parameter", "4.1", "Dictionary", "representation", "material", "better", "parameterize", "search", "space", "equation", "-lrb-", "10", "-rrb-", "we", "use", "dictionary", "representation", "material", "specifically", "consider", "dictionary", "set", "material", "-lcb-", "...", "-rcb-", "where", "-lcb-", "-lrb-", "-rrb-", "-rcb-", "corresponding", "single-step", "propagation", "operator", "-lcb-", "-rcb-", "any", "weight", "vector", "dimensional", "simplex", "11", "-lsb-", "-rsb-", "...", "we", "can", "represent", "novel", "mixture", "material", "-lrb-", "-rrb-", "-lcb-", "-lrb-", "-rrb-", "-rcb-", "term", "dictionary", "atom", "12", "13", "-lrb-", "-rrb-", "-lrb-", "-rrb-", "easy", "see", "each", "-lrb-", "-rrb-", "satisfy", "normalization", "condition", "equation", "-lrb-", "-rrb-", "so", "do", "-lrb-", "-rrb-", "follow", "we", "denote", "-lrb-", "-rrb-", "-lrb-", "-rrb-", "single-step", "propagation", "-lrb-", "equation", "-lrb-", "-rrb-", "-rrb-", "rendering", "-lrb-", "equation", "-lrb-", "-rrb-", "-rrb-", "operator", "respectively", "material", "-lrb-", "-rrb-", "we", "denote", "appearance", "match", "error", "mix", "weight", "14", "-lrb-", "-rrb-", "-lrb-", "-lrb-", "-rrb-", "-rrb-", "we", "search", "convex", "combination", "material", "atom", "dictionary", "which", "best", "reproduce", "capture", "image", "minimize", "-lrb-", "-rrb-", "over", "justify", "we", "use", "convex", "combination", "mix", "equation", "-lrb-", "12", "-rrb-", "-lrb-", "13", "-rrb-", "we", "present", "follow", "lemma", "Lemma", "any", "vector", "single-step", "propagation", "operator", "-lrb-", "-rrb-", "mixed", "material", "-lrb-", "-rrb-", "define", "equation", "-lrb-", "12", "-rrb-", "-lrb-", "13", "-rrb-", "convex", "combination", "single-step", "propagation", "operator", "individual", "atom", "exact", "same", "mix", "weight", "15", "-lrb-", "-rrb-", "proof", "denote", "-lrb-", "-rrb-", "use", "equation", "-lrb-", "-rrb-", "-lrb-", "-rrb-", "-lrb-", "-rrb-", "-lrb-", "-lrb-", "-rrb-", "-rrb-", "-lrb-", "-rrb-", "-lrb-", "-rrb-", "-lrb-", "16", "-rrb-", "expression", "equation", "-lrb-", "16", "-rrb-", "operator", "form", "equation", "-lrb-", "-rrb-", "we", "express", "integral", "-lrb-", "-rrb-", "-lrb-", "-rrb-", "-lrb-", "-rrb-", "-lrb-", "17", "-rrb-", "from", "equation", "-lrb-", "16", "-rrb-", "-lrb-", "17", "-rrb-", "we", "get", "exactly", "single-step", "propagation", "operator", "material", "-lrb-", "-rrb-", "equation", "-lrb-", "15", "-rrb-", "ACM", "transaction", "Graphics", "Vol", "32", "no.", "Article", "162", "publication", "date", "November", "2013", "Inverse", "volume", "render", "Material", "Dictionaries", "162:5", "light", "camera", "sampling", "-lrb-", "-rrb-", "material", "sample", "full", "render", "-lrb-", "-rrb-", "single-step", "propagation", "figure", "gradient", "computation", "-lrb-", "equation", "-lrb-", "19", "-rrb-", "-rrb-", "dictionary-based", "appearance", "match", "optimization", "problem", "-lrb-", "equation", "-lrb-", "14", "-rrb-", "-rrb-", "each", "pair", "lighting", "view", "direction", "gradient", "respect", "weight", "n-th", "dictionary", "material", "require", "compute", "cascade", "three", "render", "operation", "full", "volume", "render", "use", "mixture", "material", "single-step", "propagation", "use", "corresponding", "atom", "material", "another", "full", "volume", "render", "use", "mixture", "material", "result", "light", "field", "sample", "produce", "image", "use", "algebraically", "equation", "-lrb-", "19", "-rrb-", "Lemma", "show", "convex", "combination", "material", "can", "directly", "identify", "convex", "combination", "single-step", "propagation", "operator", "result", "objective", "function", "optimization", "problem", "equation", "-lrb-", "14", "-rrb-", "have", "much", "simpler", "functional", "dependence", "parameter", "we", "optimize", "over", "allow", "we", "derive", "tractable", "optimization", "strategy", "discuss", "follow", "subsection", "property", "key", "motivator", "we", "use", "finite-difference", "approximation", "operator-theoretic", "formulation", "section", "3.1", "show", "Supplementary", "Appendix", "derive", "analogous", "result", "from", "volume", "render", "formulation", "contrast", "require", "extinction", "coefficient", "know", "beforehand", "fix", "all", "atom", "dictionary", "D.", "4.2", "Optimization", "Algorithm", "minimize", "appearance", "match", "error", "equation", "-lrb-", "14", "-rrb-", "we", "differentiate", "respect", "mix", "weight", "use", "follow", "lemma", "lemma", "operator", "-lrb-", "-rrb-", "define", "equation", "-lrb-", "15", "-rrb-", "follow", "differentiation", "rule", "hold", "18", "??", "-lrb-", "-lrb-", "-rrb-", "-rrb-", "-lrb-", "-lrb-", "-rrb-", "-rrb-", "-lrb-", "-lrb-", "-rrb-", "-rrb-", "well-known", "result", "case", "finite-dimensional", "matrix", "Supplementary", "appendix", "we", "provide", "precise", "statement", "proof", "lemma", "case", "infinite-dimensional", "linear", "operator", "use", "equation", "-lrb-", "15", "-rrb-", "-lrb-", "18", "-rrb-", "we", "can", "write", "gradient", "-lrb-", "-rrb-", "respect", "each", "coordinate", "mixture", "weight", "vector", "-lrb-", "-rrb-", "2w", "-lrb-", "-lrb-", "-rrb-", "-rrb-", "??", "-lrb-", "-lrb-", "-rrb-", "-rrb-", "-lrb-", "-lrb-", "-rrb-", "-rrb-", "-lrb-", "19", "-rrb-", "equation", "-lrb-", "19", "-rrb-", "crucial", "we", "optimization", "show", "gradient", "computation", "simplify", "render", "sampling", "operation", "-lrb-", "-rrb-", "-lrb-", "-rrb-", "full", "render", "-lrb-", "-rrb-", "render", "light", "field", "start", "from", "input", "radiance", "use", "render", "operator", "-lrb-", "-rrb-", "apply", "single-step", "propagation", "operator", "correspond", "n-th", "material", "dictionary", "produce", "light", "field", "render", "light", "field", "apply", "full", "rendering", "operator", "-lrb-", "-rrb-", "apply", "sampling", "operator", "evaluate", "product", "-lrb-", "equation", "-lrb-", "19", "-rrb-", "-rrb-", "gradient", "evaluation", "step", "summarize", "algorithm", "visualize", "figure", "rendering", "fact", "appearance", "error", "gradient", "can", "express", "sequence", "render", "step", "have", "important", "practical", "implication", "allow", "we", "evaluate", "efficiently", "use", "Monte-Carlo", "render", "technique", "-lsb-", "Dutr", "et", "al.", "2006", "-rsb-", "first", "stage", "we", "implementation", "we", "use", "traditional", "volume", "render", "operator", "-lrb-", "describe", "Supplementary", "Appendix", "-rrb-", "small", "enough", "produce", "equivalent", "result", "render", "operator", "-lrb-", "-rrb-", "we", "finite-difference", "formulation", "we", "estimate", "separately", "direct", "illumination", "term", "-lrb-", "which", "depend", "only", "assume", "known", "radiance", "source", "scene", "easy", "compute", "-rrb-", "indirect", "component", "latter", "we", "use", "Monte-Carlo", "particle", "trace", "process", "estimate", "while", "simultaneously", "cache", "all", "intermediate", "particle", "position", "set", "form", "approximation", "process", "describe", "Algorithm", "application", "stochastically", "approximate", "describe", "Algorithm", "particle", "uniformly", "sample", "from", "propagate", "either", "scatter", "absorb", "result", "cache", "set", "approximation", "finally", "sample", "from", "use", "source", "another", "full", "particle", "trace", "process", "directly", "estimate", "without", "further", "caching", "perform", "similar", "algorithm", "initialization", "step", "replace", "initialization", "from", "particle", "draw", "uniformly", "from", "caching", "step", "10", "omit", "we", "discuss", "further", "detail", "about", "algorithm", "we", "use", "render", "include", "handling", "Fresnel", "??", "reflection", "refraction", "Supplementary", "Appendix", "B.", "Stochastic", "gradient", "descent", "availability", "stochastic", "estimate", "gradient", "make", "stochastic", "gradient", "descent", "-lrb-", "sgd", "-rrb-", "algorithm", "attractive", "minimize", "equation", "-lrb-", "14", "-rrb-", "similar", "standard", "gradient", "descent", "SGD", "algorithm", "perform", "iteration", "step", "ACM", "transaction", "Graphics", "Vol", "32", "no.", "Article", "162", "publication", "date", "November", "2013", "162:6", "i.", "Gkioulekas", "et", "al.", "algorithm", "ComputeGradient", "input", "do", "do", "render", "-lrb-", "-rrb-", "apply", "single-step", "propagation", "render", "-lrb-", "-rrb-", "sample", "sample", "2w", "10", "end", "11", "end", "12", "return", "g.", "proportional", "negative", "stochastic", "estimate", "gradient", "algorithm", "only", "require", "estimate", "unbiased", "even", "otherwise", "noisy", "exist", "convergence", "guarantee", "analogous", "those", "standard", "gradient", "descent", "noise", "variance", "only", "affect", "convergence", "speed", "behavior", "have", "important", "practical", "implication", "we", "can", "reduce", "number", "particle", "Monte-Carlo", "evaluation", "gradient", "speed", "computation", "cost", "introduce", "noise", "gradient", "estimate", "long", "render", "algorithm", "unbiased", "noisy", "gradient", "estimate", "valid", "input", "SGD", "noise", "due", "reduce", "number", "particle", "somewhat", "increase", "number", "iteration", "however", "still", "possible", "reduce", "number", "particle", "quite", "drastically", "achieve", "significant", "speedup", "term", "overall", "computation", "time", "-lsb-", "bottou", "Bousquet", "2008", "-rsb-", "vector", "constrain", "lie", "simplex", "we", "use", "project", "stochastic", "gradient", "descent", "-lrb-", "psgd", "-rrb-", "we", "denote", "consecutive", "noisy", "estimate", "gradient", "-lrb-", "-rrb-", "obtain", "through", "Monte-Carlo", "render", "20", "-lrb-", "-rrb-", "-lsb-", "-rsb-", "??", "we", "use", "they", "iterate", "21", "-lrb-", "+1", "-rrb-", "-lrb-", "-rrb-", "-lrb-", "-rrb-", "-lrb-", "-rrb-", "where", "denote", "euclidean", "projection", "operator", "simplex", "-lsb-", "Duchi", "et", "al.", "2008", "-rsb-", "step", "size", "often", "choose", "equal", "-lrb-", "-rrb-", "though", "speed", "convergence", "depend", "proportionality", "constant", "practice", "SGD", "know", "robust", "selection", "cancel", "noise", "individual", "step", "sgd", "return", "its", "final", "output", "average", "all", "iteration", "opt", "-lrb-", "-rrb-", "procedure", "summarize", "algorithm", "optimization", "problem", "we", "solve", "highly", "non-linear", "essentially", "involve", "inversion", "photon", "random", "walk", "process", "despite", "non-linear", "formulation", "we", "simulation", "section", "6.2", "show", "allow", "accurate", "reconstruction", "material", "parameter", "while", "exact", "proof", "property", "subject", "further", "research", "all", "we", "simulation", "indicate", "error", "surface", "very", "smooth", "do", "suffer", "from", "local", "minimum", "explain", "good", "convergence", "we", "able", "achieve", "4.3", "Dictionary", "dictionary-based", "formulation", "appearance", "matching", "problem", "equation", "-lrb-", "14", "-rrb-", "can", "use", "any", "dictionary", "choice", "we", "own", "simple", "dictionary", "describe", "below", "we", "phase", "we", "use", "term", "dictionary", "because", "phase", "function", "set", "we", "use", "can", "underor", "over-complete", "strictly", "basis", "technical", "sense", "algorithm", "Solve", "appearance", "match", "optimization", "problem", "-lrb-", "-rrb-", "initialize", "1/n", "while", "converge", "do", "-lrb-", "-rrb-", "ComputeGradient", "-lrb-", "-rrb-", "-lrb-", "+1", "-rrb-", "-lrb-", "-rrb-", "-lrb-", "-rrb-", "-lrb-", "-rrb-", "end", "while", "return", "opt", "-lrb-", "-rrb-", "algorithm", "Adjoint", "particle", "trace", "compute", "let", "location", "where", "laser", "hit", "S.", "while", "true", "do", "a.", "sample", "from", "pdf", "-lrb-", "-rrb-", "exp", "-lrb-", "??", "-rrb-", "break", "end", "10", "cache", "particle", "location", "-lcb-", "-lrb-", "-rrb-", "-rcb-", "11", "let", "direction", "connect", "camera", "12", "let", "intersection", "ray", "-lrb-", "-rrb-", "image", "sensor", "13", "exp", "-lrb-", "??", "-rrb-", "c/a", "where", "total", "number", "pixel", "sensor", "sensor?s", "surface", "area", "source", "power", "14", "add", "corresponding", "pixel", "image", "sensor", "15", "sample", "direction", "accord", "phase", "function", "p.", "16", "17", "end", "while", "algorithm", "importance", "sampling", "compute", "uniformly", "sample", "pair", "-lrb-", "-rrb-", "sample", "uniformly", "-lrb-", "-rrb-", "-lrb-", "-rrb-", "terminate", "end", "-lrb-", "-rrb-", "10", "sample", "direction", "accord", "phase", "function", "11", "12", "end", "13", "cache", "particle", "location", "-lcb-", "-lrb-", "-rrb-", "-rcb-", "Figure", "phase", "function", "tent", "dictionary", "10", "atom", "-lrb-", "each", "atom", "color", "uniquely", "better", "visualization", "-rrb-", "valid", "probability", "distribution", "sphere", "atom", "normalize", "satisfy", "equation", "thus", "have", "vary", "magnitude", "atom", "center", "show", "crop", "function", "component", "material", "address", "extinction", "scattering", "component", "phase", "function", "allow", "dictionary", "general", "possible", "we", "aim", "able", "express", "any", "phase", "function", "any", "cylindrically", "symmetric", "probability", "distribution", "sphere", "hence", "we", "simply", "model", "phase", "function", "piecewise", "linear", "function", "we", "can", "use", "set", "tent", "-lrb-", "triangular", "-rrb-", "function", "space", "equally", "over", "angular", "domain", "-lsb-", "-rsb-", "approximate", "denote", "bin", "number", "bin", "spacing", "-lrb-", "-rrb-", "we", "use", "tent", "function", "width", "center", "point", "-lrb-", "...", "-rrb-", "each", "tent", "function", "normalize", "satisfy", "constraint", "equation", "-lrb-", "-rrb-", "Figure", "we", "show", "phase", "function", "tent", "dictionary", "10", "we", "experiment", "we", "use", "200", "which", "correspond", "discretization", "step", "0.9", "avoid", "high", "frequency", "artifact", "phase", "function", "solution", "we", "include", "equation", "-lrb-", "14", "-rrb-", "quadratic", "regularization", "its", "derivative", "-lrb-", "+1", "-rrb-", "extinction", "scattering", "coefficient", "definition", "atom", "extinction", "scattering", "coefficient", "should", "ensure", "dictionary", "can", "represent", "material", "wide", "range", "value", "we", "select", "upper", "bind", "max", "desire", "extinction", "coefficient", "note", "each", "scattering", "function", "form", "-lcb-", "-lrb-", "-rrb-", "-rcb-", "max", "lie", "simplex", "span", "-lcb-", "max", "max", "-lrb-", "-rrb-", "-rcb-", "purely", "absorptive", "atom", "-lcb-", "max", "-rcb-", "atom", "form", "-lcb-", "-rcb-", "describe", "scattering-free", "propagation", "vacuum", "we", "use", "symbol", "indicate", "last", "two", "atom", "independent", "phase", "function", "-lrb-", "phase", "function", "undefined", "two", "media", "-rrb-", "therefore", "we", "create", "scattering", "dictionary", "include", "200", "atom", "form", "-lcb-", "max", "max", "-lrb-", "-rrb-", "-rcb-", "-lrb-", "-rrb-", "define", "above", "plus", "two", "purely", "absorptive", "atom", "-lcb-", "max", "-rcb-", "-lcb-", "-rcb-", "we", "experiment", "we", "set", "max", "200", "mm", "base", "result", "from", "section", "6.2", "other", "parameterization", "we", "specific", "choice", "dictionary", "aim", "represent", "any", "general", "phase", "function", "shape", "depend", "application", "other", "dictionary", "may", "more", "appropriate", "some", "example", "include", "zonal", "spherical", "harmonic", "lowfrequency", "phase", "function", "phase", "function", "derive", "from", "Mie", "theory", "-lsb-", "bohren", "Huffman", "1983", "Frisvad", "et", "al.", "2007", "-rsb-", "when", "measure", "dispersion", "compact", "dictionary", "set", "few", "henyey-greenstein", "von", "mises-fisher", "function", "-lsb-", "Gkioulekas", "et", "al.", "2013", "-rsb-", "when", "simple", "phase", "function", "model", "sufficient", "small", "adaptation", "can", "also", "allow", "differentiate", "directly", "respect", "single", "parameter", "henyey-greenstein", "function", "-lrb-", "average", "cosine", "-rrb-", "we", "optimization", "framework", "quite", "attractive", "even", "retrieve", "simpler", "phase", "function", "since", "alleviate", "need", "input", "measurement", "which", "isolate", "single", "scattering", "event", "ACM", "transaction", "Graphics", "Vol", "32", "no.", "Article", "162", "publication", "date", "November", "2013", "Inverse", "volume", "render", "Material", "Dictionaries", "162:7", "Acquisition", "Setup", "Design", "optimization", "strategy", "describe", "above", "general", "enough", "apply", "capture", "datum", "any", "geometry", "long", "we", "can", "calibrate", "3d", "shape", "material", "relative", "position", "camera", "light", "source", "index", "refraction", "scattering", "material", "its", "surroundings", "below", "we", "describe", "physical", "acquisition", "setup", "we", "build", "which", "motivate", "simplicity", "calibration", "process", "some", "consideration", "relate", "stability", "optimization", "problem", "inspiration", "also", "draw", "from", "analogous", "design", "-lsb-", "Jensen", "et", "al.", "2001", "Goesele", "et", "al.", "2004", "Wang", "et", "al.", "2008", "-rsb-", "physics", "-lsb-", "Johnson", "Gabriel", "1994", "-rsb-", "schematic", "photograph", "we", "acquisition", "setup", "show", "Figure", "further", "implementation", "detail", "provide", "Supplementary", "Appendix", "D.", "Geometry", "we", "cast", "material", "we", "interested", "measure", "glass", "cell", "variable", "thickness", "allow", "we", "create", "box-shaped", "material", "sample", "whose", "exact", "shape", "know", "very", "high", "accuracy", "furthermore", "use", "micron-accurate", "smooth", "glass", "surface", "mean", "transition", "refraction", "various", "material", "interface", "-lrb-", "material", "glass", "glass", "air", "-rrb-", "can", "easily", "simulated", "sample", "container", "frontlighting", "hyperspectral", "camera", "backlighting", "rotation", "stage", "projective", "top", "view", "figure", "setup", "scatter", "parameter", "acquisition", "sample", "cell", "illuminate", "collimated", "beam", "image", "camera", "Rotation", "stage", "achieve", "arbitrary", "combination", "lighting", "view", "direction", "top", "schematic", "bottom", "implementation", "use", "Fresnel", "refraction", "reflection", "law", "we", "experiment", "we", "use", "cell", "width", "2.5", "10", "mm", "Imaging", "lighting", "we", "use", "approximately", "orthographic", "camera", "high", "magnification", "macro", "lens", "-lrb-", "4.3", "subtended", "angle", "reproduction", "ratio", "-rrb-", "sample", "light", "field", "produce", "material", "volume", "we", "use", "narrow", "-lrb-", "mm", "diameter", "-rrb-", "collimate", "beam", "illuminate", "sample", "we", "use", "configuration", "allow", "illuminating", "either", "sample", "surface", "image", "camera", "-lrb-", "frontlighting", "-rrb-", "its", "opposite", "-lrb-", "backlighting", "-rrb-", "through", "combination", "two", "motorized", "rotation", "stage", "we", "can", "achieve", "different", "combination", "front", "back", "light", "direction", "view", "direction", "we", "experiment", "we", "use", "all", "possible", "combination", "-lcb-", "15", "25", "-rcb-", "result", "set", "18", "measurement", "per", "sample", "viewing", "direction", "time", "frontlighting", "plus", "backlighting", "direction", "above", "combination", "sample", "shape", "camera", "illumination", "lend", "itself", "accurate", "calibration", "Supplementary", "appendix", "we", "justify", "use", "collimated", "beam", "mathematically", "similar", "brdf", "argument", "Ramamoorthi", "Hanrahan", "-lsb-", "2001", "-rsb-", "we", "argue", "maximize", "angular", "information", "configuration", "should", "have", "broadband", "angular", "frequency", "content", "hence", "close", "possible", "delta", "function", "use", "both", "frontlighting", "backlighting", "motivate", "understanding", "backlighting", "beam", "produce", "measurement", "dominate", "high-order", "scattering", "measurement", "intuitively", "useful", "determine", "optical", "thickness", "material", "conversely", "frontlighting", "result", "measurement", "where", "low-order", "scattering", "significant", "therefore", "informative", "recovery", "material", "phase", "function", "multi-chromatic", "measurement", "scatter", "parameter", "vary", "function", "wavelength", "spectral", "dependency", "can", "create", "perceptually", "important", "effect", "appearance", "-lsb-", "Fleming", "B?lthoff", "2005", "Frisvad", "et", "al.", "2007", "-rsb-", "capture", "spectral", "variation", "we", "use", "monochromatic", "laser", "light", "three", "RGB", "wavelength", "488", "533", "635", "nm", "solve", "optimization", "problem", "equation", "-lrb-", "14", "-rrb-", "independently", "each", "wavelength", "index", "refraction", "calibrate", "unknown", "material?s", "index", "refraction", "we", "use", "set", "additional", "measurement", "backlighting", "-lrb-", "correspond", "direct", "observation", "source", "absence", "medium", "-rrb-", "measure", "shift", "location", "point-spread-function", "peak", "cause", "refraction", "image", "we", "can", "easily", "solve", "material", "index", "refraction", "each", "three", "wavelength", "we", "use", "we", "discuss", "process", "more", "detail", "Supplementary", "appendix", "we", "have", "find", "we", "measurement", "procedure", "adequately", "accurate", "we", "purpose", "necessary", "more", "accurate", "measurement", "material", "index", "refraction", "can", "obtain", "use", "refractometer", "additionally", "experiment", "synthetic", "datum", "we", "find", "small", "perturbation", "index", "refraction", "-lrb-", "0.1", "-rrb-", "do", "affect", "recover", "scatter", "parameter", "considerably", "ACM", "transaction", "Graphics", "Vol", "32", "no.", "Article", "162", "publication", "date", "November", "2013", "162:8", "i.", "Gkioulekas", "et", "al.", "experiment", "we", "now", "demonstrate", "validate", "we", "approach", "acquire", "scattering", "parameter", "we", "begin", "evaluation", "synthetic", "datum", "aim", "understand", "characteristic", "we", "optimization", "problem", "we", "show", "result", "two", "set", "measure", "material", "first", "validation", "set", "carefully-constructed", "nano-dispersion", "whose", "scattering", "parameter", "can", "compute", "use", "Lorenz-Mie", "theory", "set", "provide", "means", "quantitative", "validation", "second", "set", "consist", "everyday", "material", "evaluate", "ability", "produce", "accurate", "render", "image", "novel", "geometry", "6.1", "capture", "computation", "time", "we", "first", "provide", "some", "quantitative", "information", "acquisition", "inversion", "stage", "we", "measurement", "pipeline", "acquisition", "stage", "describe", "section", "single", "material", "we", "take", "measurement", "three", "wavelength", "set", "18", "different", "scene", "configuration", "total", "54", "measurement", "each", "measurement", "high-dynamic", "range", "-lrb-", "hdr", "-rrb-", "image", "composit", "from", "low-dynamic", "range", "image", "capture", "19", "different", "exposure", "addition", "every", "material", "we", "measure", "we", "capture", "set", "lowdynamic", "range", "calibration", "image", "process", "result", "total", "capture", "time", "approximately", "75", "minute", "per", "material", "we", "provide", "more", "detail", "about", "calibration", "high-dynamic", "range", "imaging", "procedure", "Supplementary", "appendix", "inversion", "stage", "we", "solve", "optimization", "problem", "section", "Amazon", "ec2", "cluster", "100", "node", "32", "computational", "core", "least", "20", "gb", "memory", "per", "node", "-lrb-", "require", "caching", "intermediate", "light", "field", "describe", "section", "4.2", "-rrb-", "we", "use", "node", "distribute", "outer", "loop", "algorithm", "gradient", "computation", "each", "dictionary", "atom", "-lrb-", "dictionary", "200", "atom", "each", "node", "responsible", "two", "atom", "-rrb-", "result", "accumulate", "single", "master", "node", "which", "perform", "gradient", "step", "algorithm", "process", "repeat", "number", "iteration", "require", "until", "convergence", "achieve", "we", "find", "process", "one", "set", "measurement", "require", "approximately", "200", "iteration", "SGD", "algorithm", "overall", "fitting", "one", "wavelength", "single", "material", "require", "three", "six", "hour", "depend", "density", "material", "we", "use", "we", "own", "c/c", "implementation", "which", "we", "have", "optimize", "through", "experiment", "synthetic", "datum", "however", "computation", "could", "reduce", "further", "fine-tuning", "various", "parameter", "involve", "dictionary", "camera", "spatial", "resolution", "number", "iteration", "number", "sample", "per", "rendering", "so", "6.2", "experiment", "synthetic", "datum", "optimization", "problem", "section", "involve", "inversion", "random", "walk", "process", "include", "multiple", "scattering", "event", "highly", "non-linear", "despite", "we", "almost", "always", "see", "we", "experiment", "convergence", "solution", "explain", "measure", "datum", "very", "well", "suggest", "error", "surface", "fairly", "smooth", "provide", "more", "insight", "we", "conduct", "series", "simulation", "experiment", "which", "input", "image-set", "generate", "use", "small", "artificial", "three-element", "dictionary", "since", "three", "mix", "weight", "constrain", "simplex", "set", "phase", "function", "span", "three", "element", "2d", "space", "allow", "entire", "cost", "surface", "visualize", "experiment", "we", "parameterize", "2d", "phase", "function", "space", "weight", "first", "two", "atom", "-lrb-", "-rrb-", "each", "experiment", "we", "choose", "ground", "truth", "phase", "function", "-lrb-", "-rrb-", "compute", "each", "-lrb-", "-rrb-", "difference", "between", "input", "image", "render", "phase", "function", "-lcb-", "-lrb-", "-rrb-", "-rcb-", "...", "those", "render", "true", "one", "-lcb-", "-lrb-", "-rrb-", "-rcb-", "...", "result", "from", "six", "representative", "experiment", "show", "Figure", "each", "row", "show", "three", "separate", "experiment", "which", "true", "phase", "function", "same", "while", "optical", "density", "differ", "we", "find", "error", "surface", "have", "clear", "minimum", "true", "value", "all", "2d", "experiment", "while", "exact", "proof", "remain", "subject", "future", "research", "cost", "function", "appear", "very", "smooth", "without", "spurious", "local", "minimum", "least", "2d", "problem", "next", "experiment", "synthetic", "datum", "we", "compare", "accuracy", "absorb", "material", "versus", "scattering", "material", "material", "vary", "optical", "density", "we", "consider", "large", "set", "artificial", "material", "combination", "-lrb-", "-rrb-", "value", "sample", "logarithmically", "interval", "0.01", "...", "200", "mm", "total", "21", "value", "-lrb-", "ii", "-rrb-", "value", "correspond", "each", "21", "albedo", "value", "linearly", "sample", "between", "-lrb-", "purely", "absorptive", "-rrb-", "-lrb-", "purely", "scatter", "-rrb-", "-lrb-", "iii", "-rrb-", "set", "eight", "different", "phase", "function", "span", "wide", "range", "shape", "each", "artificial", "material", "we", "render", "synthetic", "image", "use", "geometry", "match", "we", "setup", "-lrb-", "section", "-rrb-", "sample", "width", "mm", "sensor", "noise", "important", "consideration", "analysis", "so", "we", "simulate", "image", "noise", "use", "photon", "-lrb-", "poisson", "-rrb-", "noise", "parameter", "report", "two", "different", "commercial", "dslr", "camera", "-lsb-", "Hasinoff", "et", "al.", "2010", "-rsb-", "-lrb-", "which", "very", "large", "relative", "Monte", "Carlo", "render", "error", "-rrb-", "noisy", "image", "input", "we", "optimization", "algorithm", "we", "measure", "error", "between", "recover", "parameter", "true", "one", "we", "use", "tent", "dictionary", "200", "atom", "Figure", "provide", "summary", "experiment", "visualize", "separately", "relative", "error", "between", "estimate", "true", "value", "-lrb-", "leave", "right", "-rrb-", "albedo", "extinction", "coefficient", "phase", "function", "-lrb-", "-rrb-", "each", "point", "table", "correspond", "percent", "error?averaged", "over", "eight", "true", "phase", "function", "shape", "distinct", "value", "true", "albedo", "-lrb-", "horizontal", "axis", "-rrb-", "extinction", "coefficient", "-lrb-", "vertical", "axis", "-rrb-", "table", "reveal", "which", "type", "material", "we", "can", "expect", "measure", "accurately", "we", "setup", "travel", "from", "error", "10", "20", "figure", "error", "surface", "2d", "optimization", "problem", "we", "consider", "dictionary", "three", "phase", "function", "whose", "mix", "weight", "lie", "simplex", "simplex", "parameterize", "its", "first", "two", "coordinate", "column", "show", "result", "three", "reference", "row", "show", "two", "different", "point", "correct", "reference", "space", "ACM", "transaction", "Graphics", "Vol", "32", "no.", "Article", "162", "publication", "date", "November", "2013", "Inverse", "volume", "render", "Material", "Dictionaries", "162:9", "albedo", "error", "-lrb-", "-rrb-", "extinction", "coefficient", "error", "-lrb-", "-rrb-", "short", "short", "-lrb-", "log", "-rrb-", "path", "free", "mean", "-lrb-", "log", "-rrb-", "path", "free", "mean", "long", "absorptive", "50", "45", "40", "35", "30", "25", "20", "15", "10", "scattering", "long", "absorptive", "albedo", "albedo", "figure", "Accuracy", "recovery", "material", "parameter", "plot", "show", "recovery", "error", "albedo", "extinction", "coefficient", "mean", "error", "phase", "function", "function", "different", "value", "albedo", "mean", "free", "path", "leave", "right", "table", "make", "gradual", "transition", "from", "purely", "absorb", "material", "purely", "scattering", "one", "travel", "from", "bottom", "top", "move", "through", "material", "increase", "optical", "density", "top", "be", "material", "whose", "mean", "free", "path", "two", "hundred", "time", "smaller", "than", "sample", "width", "w/200", "bottom", "be", "material", "whose", "mean", "free", "path", "one", "hundred", "time", "larger", "than", "sample", "width", "100w", "first", "observation?based", "large", "low-error", "region", "center", "tables?is", "estimation", "accurate", "wide", "range", "optical", "density", "useful", "fact", "because", "mean", "width", "glass", "cell", "need", "choose", "excessive", "care", "we", "expect", "very", "accurate", "result", "long", "sample", "width", "within", "order", "magnitude", "material?s", "mean", "free", "path", "we", "expect", "graceful", "degradation", "when", "width", "extend", "beyond", "either", "direction", "extremely", "optically-thin", "material", "-lrb-", "lower", "row", "table", "-rrb-", "scatter", "event", "become", "very", "rare", "image", "dominate", "noise", "extremely", "optically-thick", "material", "-lrb-", "top", "row", "-rrb-", "diffusion", "approximation", "-lsb-", "Jensen", "et", "al.", "2001", "-rsb-", "become", "applicable", "recover", "both", "phase", "function", "scattering", "coefficient", "become", "ill-posed", "practice", "we", "simply", "choose", "width", "each", "material", "sample", "from", "discrete", "set", "available", "glass", "cell", "-lrb-", "2.5", "10", "mm", "-rrb-", "so", "look", "reasonably", "translucent", "under", "natural", "light", "see", "example", "figure", "error", "induce", "extreme", "optical", "thinness", "thickness", "top", "bottom", "table", "should", "interpret", "differently", "material", "excessively", "thin", "sample", "width", "relatively", "easy", "instead", "use", "glass", "cell", "larger", "less", "true", "material", "excessively", "dense", "however", "since", "physically", "challenge", "cast", "material", "glass", "cell", "too", "small", "-lrb-", "mm", "-rrb-", "thus", "case", "extreme", "optical", "thickness", "we", "setup", "provide", "material", "parameter", "can", "accurately", "predict", "appearance", "arbitrary", "geometry", "only", "novel", "geometry", "least", "wide", "measure", "sample", "expect", "we", "also", "observe", "large", "error", "estimate", "phase", "function", "when", "material", "extremely", "absorptive", "-lrb-", "left", "column", "third", "table", "Figure", "-rrb-", "error", "somewhat", "computational", "artifact", "have", "limited", "impact", "visual", "appearance", "occur", "because", "appearance", "material", "dominate", "attenuation", "due", "absorption", "so", "very", "little", "scattering", "observe", "little", "discernible", "information", "about", "shape", "phase", "function", "error", "do", "impact", "we", "ability", "predict", "material", "appearance", "however", "because", "phase", "function", "make", "little", "difference", "indeed", "purely", "absorptive", "material", "-lrb-", "left-most", "column", "-rrb-", "scattering", "all", "phase", "function", "can", "define", "arbitrarily", "without", "have", "any", "effect", "appearance", "phase", "function", "error", "-lrb-", "-rrb-", "short", "-lrb-", "log", "-rrb-", "path", "free", "mean", "50", "45", "40", "35", "30", "25", "20", "15", "10", "scattering", "long", "absorptive", "100", "90", "80", "70", "60", "50", "40", "30", "20", "10", "scattering", "albedo", "figure", "measured", "material", "glass", "cell", "width", "10", "2.5", "mm", "from", "leave", "right", "necessary", "all", "cell", "fill", "long", "exist", "homogeneous", "region", "size", "comparable", "beam", "diameter", "-lrb-", "e.g.", "hand", "cream", "-rrb-", "6.3", "validation", "material", "common", "graphic", "evaluate", "measure", "scatter", "parameter", "demonstrate", "rendering", "visually", "plausible", "result", "important", "benchmark", "do", "directly", "assess", "accuracy", "recover", "physical", "parameter", "since", "we", "goal", "produce", "parameter", "faithful", "true", "mean", "free", "path", "length", "phase", "function", "absolute", "sense", "be", "able", "directly", "validate", "scattering", "parameter", "crucial", "achieve", "comparison", "ground", "truth", "parameter", "we", "capture", "liquid", "material", "whose", "exact", "physical", "structure", "know", "similar", "material", "use", "calibrate", "instrument", "use", "variety", "domain", "particle", "size", "estimate", "molecular", "weight", "-lsb-", "Johnson", "Gabriel", "1994", "Pine", "et", "al.", "1990", "-rsb-", "create", "disperse", "nano-scale", "spherical", "particle", "known", "chemical", "composition", "homogeneous", "embedding", "medium", "different", "refractive", "index", "use", "procedure", "allow", "very", "precise", "control", "particle", "concentration", "particle", "size", "distribution", "homogeneity", "give", "parameter", "Lorenz-Mie", "theory", "-lsb-", "bohren", "Huffman", "1983", "Frisvad", "et", "al.", "2007", "-rsb-", "provide", "analytic", "expression", "bulk", "material", "scattering", "parameter", "-lcb-", "-lrb-", "-rrb-", "-rcb-", "any", "wavelength", "we", "measure", "nanodispersion", "two", "type", "first", "we", "measure", "dispersion", "polystyrene", "sphere", "water", "almost", "monodisperse", "-lrb-", "single", "particle", "size", "-rrb-", "precise", "enough", "traceable", "NIST", "Standard", "Reference", "Materials", "we", "measure", "three", "dispersion", "each", "have", "-lrb-", "w/v", "-rrb-", "concentration", "particle", "different", "particle", "radius", "200", "500", "800", "nm", "second", "we", "measure", "spherical", "polydispersion", "aluminum", "oxide", "particle", "-lrb-", "Al", "-rrb-", "water", "approximately", "know", "particle", "size", "distribution", "range", "20", "300", "nm", "mean", "radius", "30", "nm", "we", "use", "glass", "cell", "width", "mm", "all", "measurement", "instead", "estimate", "index", "refraction", "from", "image", "datum", "we", "use", "those", "predict", "Lorenz-Mie", "theory", "result", "we", "measurement", "show", "Table", "all", "case", "error", "recover", "parameter", "less", "than", "-lrb-", "note", "material", "purely", "scatter", "so", "-rrb-", "largest", "error", "occur", "aluminum", "oxide", "material", "which", "particle", "size", "distribution", "know", "much", "less", "precisely", "Figure", "leave", "compare", "green-channel", "phase", "function", "recover", "we", "optimization", "-lrb-", "purple", "curve", "-rrb-", "ground", "truth", "phase", "function", "predict", "Lorenz-Mie", "theory", "-lrb-", "dot", "orange", "curve", "-rrb-", "we", "see", "match", "extremely", "close", "reference", "we", "compare", "both", "henyeygreenstein", "phase", "function", "single", "parameter", "HG", "phase", "function", "equal", "its", "average", "cosine", "we", "plot", "-lrb-", "green", "curve", "-rrb-", "HG", "phase", "function", "have", "value", "equal", "average", "cosine", "ground", "truth", "phase", "function", "we", "note", "shape", "deviate", "significantly", "from", "ground-truth", "deviation", "important", "appearance", "particularly", "object", "have", "thin", "geometry", "low-order", "scattering", "where", "phase", "function", "play", "important", "role", "visually", "middle", "column", "demonstrate", "show", "capture", "fit", "-lrb-", "pseudo-colored", "-rrb-", "image", "material", "under", "frontal", "laser", "illumination", "new", "angle", "-lrb-", "which", "use", "optimization", "-rrb-", "rightmost", "column", "show", "cross-section", "image", "intensity", "deviation", "HG", "fit", "from", "ground-truth", "lead", "discernible", "difference", "between", "image", "experiment", "highlight", "fact", "simple", "single-parameter", "phase", "function", "model", "can", "insufficient", "modeling", "appearance", "scattering", "material", "justify", "we", "choice", "fit", "higherdimensional", "phase", "function", "model", "Nanobead", "NIST", "Traceable", "Particle", "size", "Standards", "Polysciences", "Inc.", "NanoArc", "Aluminum", "Oxide", "Nanophase", "Technologies", "Corporation", "ACM", "transaction", "Graphics", "Vol", "32", "no.", "Article", "162", "publication", "date", "November", "2013", "162:10", "i.", "Gkioulekas", "et", "al.", "6.4", "other", "material", "next", "we", "use", "we", "acquisition", "setup", "optimization", "algorithm", "measure", "several", "common", "material", "can", "group", "roughly", "three", "category", "highly", "scatter", "liquid", "vary", "viscosity", "include", "mustard", "shampoo", "hand", "cream", "liquid", "designer", "clay", "different", "type", "milk", "highly", "absorb", "liquid", "limited", "scattering", "include", "coffee", "robitussin", "olive", "oil", "blue", "curacao", "liquor", "red", "wine", "solid", "can", "mold", "glass", "cell", "different", "type", "soap", "eyeball", "each", "sample", "under", "natural", "light", "we", "choose", "glass", "cell", "width", "so", "each", "sample", "look", "reasonably", "translucent", "under", "ambient", "lighting", "result", "we", "report", "be", "capture", "use", "width", "mm", "material", "first", "third", "category", "except", "glycerine", "soap", "10", "mm", "second", "category", "glycerine", "soap", "photograph", "sample", "mm", "2.5", "mm", "10", "mm", "cell", "show", "figure", "each", "sample", "we", "estimate", "index", "refraction", "describe", "section", "range", "from", "value", "1.33", "-lrb-", "milk", "reduce", "milk", "milk", "soap", "water", "soluble", "liquid", "-rrb-", "1.47", "-lrb-", "olive", "oil", "glycerine", "-rrb-", "measure", "parameter", "show", "Table", "we", "quantitatively", "evaluate", "quality", "recover", "scattering", "parameter", "two", "way", "first", "we", "report", "fitting", "error", "which", "average", "image", "difference", "between", "input", "image", "corresponding", "image", "render", "recover", "parameter", "normalize", "norm", "input", "image", "second", "we", "compute", "measure", "generalization", "error", "-rrb-", "use", "recover", "parameter", "render", "laser-illumination", "image", "different", "sample", "width", "lighting", "direction", "ii", "-rrb-", "compare", "simulated", "image", "capture", "photograph", "same", "novel", "configuration", "novel", "configuration", "we", "use", "light", "angle", "-lcb-", "10", "20", "30", "-rcb-", "glass", "cell", "width", "-lcb-", "2.5", "mm", "-rcb-", "generalization", "error", "each", "material", "report", "average", "relative", "image", "difference", "over", "set", "all", "novel", "configuration", "show", "right", "two", "column", "Table", "fitting", "error", "less", "than", "generalization", "error", "below", "Figure", "show", "measure", "phase", "function", "each", "superimpose", "HG", "phase", "function", "whose", "g-value", "equal", "average", "cosine", "phase", "function", "we", "measure", "some", "phase", "function", "well", "approximate", "HG", "model", "other", "include", "hand", "cream", "liquid", "clay", "mixed", "soap", "set", "tabulated", "phase", "function", "available", "project", "website", "qualitative", "evaluation", "Figure", "right", "show", "image", "render", "we", "recover", "material", "parameter", "under", "natural", "lighting", "from", "leave", "right", "milk", "soap", "glycerine", "soap", "-lrb-", "top", "bottom", "respectively", "-rrb-", "olive", "oil", "blue", "curacao", "reduce", "milk", "soap", "geometry", "correspond", "scan", "molded", "cube", "make", "corresponding", "material", "we", "see", "recover", "material", "parameter", "successfully", "reproduce", "color", "variation", "critical", "translucent", "appearance", "material", "most", "notable", "glycerine", "soap", "where", "blue", "wavelength", "scatter", "first", "cause", "reddish", "glow", "middle", "object", "also", "visible", "left", "edge", "milk", "soap", "top-right", "corner", "milk", "high-resotion", "version", "Figure", "visualization", "highlight", "color", "variation", "show", "Supplementary", "Appendix", "scene", "file", "use", "figure", "available", "project", "website", "conclusion", "we", "present", "optimization", "framework", "invert", "effect", "multiple-scattering", "recover", "scattering", "property", "homogeneous", "volume", "from", "handful", "image", "approach", "do", "require", "precise", "isolation", "single", "scattering", "enable", "measurement", "broader", "set", "material", "include", "both", "solid", "liquid", "optimization", "also", "incorporate", "large", "material", "dictionary", "thereby", "avoid", "restriction", "low-parameter", "phase", "function", "model", "we", "analysis", "experiment", "show", "we", "can", "recover", "accurate", "physical", "scattering", "parameter", "variety", "material", "we", "current", "setup", "optimization", "framework", "do", "account", "polarization", "fluorescence", "phenomenon", "polarization", "can", "important", "appearance", "material", "strongly", "polarizationdependent", "scattering", "property", "index", "refraction", "-lrb-", "birefringence", "-rrb-", "crystalline", "material", "experimentally", "we", "optimization", "have", "be", "unable", "find", "scatter", "parameter", "match", "we", "setup?s", "image", "microcrystalline", "wax", "may", "due", "some", "combination", "we", "simulator?s", "ignorance", "polarization", "we", "use", "partially-polarized", "-lrb-", "laser", "plus", "fiber", "-rrb-", "light", "regard", "fluorescence", "we", "have", "verify", "have", "negligible", "impact", "we", "measurement", "material", "list", "section", "we", "setup", "can", "easily", "modify", "measure", "strongly", "fluorescent", "behavior", "other", "material", "include", "addition", "hyperspectral", "camera", "mechanism", "control", "wavelength", "source", "side", "while", "we", "propose", "one", "possible", "scanning", "configuration", "we", "optimization", "could", "use", "infer", "scatter", "parameter", "from", "image", "capture", "from", "variety", "scene", "geometry", "incident", "light", "field", "only", "requirement", "both", "lighting", "geometry", "precisely", "calibrate", "we", "setup", "combine", "benefit", "highfrequency", "angular", "lighting", "-lrb-", "stable", "optimization", "-rrb-", "precise", "stable", "calibration", "-lrb-", "repeatability", "-rrb-", "limit", "measurement", "three", "wavelength", "solid", "can", "cast", "glass", "cell", "thickness", "within", "order", "magnitude", "mean", "free", "path", "principle", "we", "optimization", "could", "apply", "image", "more", "general", "solid", "object", "would", "require", "enhance", "we", "setup", "also", "ACM", "transaction", "Graphics", "Vol", "32", "no.", "Article", "162", "publication", "date", "November", "2013", "Inverse", "volume", "render", "Material", "Dictionaries", "162:11", "predict", "measure", "error", "-lrb-", "-rrb-", "phase", "function", "error", "-lrb-", "-rrb-", "dispersion", "polystyrene", "200", "nm", "17.220", "28.363", "36.517", "17.078", "28.650", "36.823", "0.825", "1.012", "0.838", "3.031", "1.143", "3.672", "polystyrene", "500", "nm", "59.082", "79.557", "88.626", "58.431", "79.023", "88.062", "1.102", "0.671", "0.636", "3.181", "2.676", "1.359", "polystyrene", "800", "nm", "65.757", "70.438", "68.589", "66.976", "71.544", "69.146", "1.853", "1.570", "0.812", "2.623", "2.117", "1.251", "Al", "30", "nm", "47.341", "93.389", "129.870", "48.536", "96.004", "132.695", "2.524", "2.800", "2.175", "3.712", "4.298", "3.108", "predict", "measure", "error", "-lrb-", "-rrb-", "phase", "function", "error", "-lrb-", "-rrb-", "dispersion", "polystyrene", "200", "nm", "17.220", "28.363", "36.517", "17.078", "28.650", "36.823", "0.825", "1.012", "0.838", "3.031", "1.143", "3.672", "polystyrene", "500", "nm", "59.082", "79.557", "88.626", "58.431", "79.023", "88.062", "1.102", "0.671", "0.636", "3.181", "2.676", "1.359", "polystyrene", "800", "nm", "65.757", "70.438", "68.589", "66.976", "71.544", "69.146", "1.853", "1.570", "0.812", "2.623", "2.117", "1.251", "Al", "30", "nm", "47.341", "93.389", "129.870", "48.536", "96.004", "132.695", "2.524", "2.800", "2.175", "3.712", "4.298", "3.108", "Table", "measurement", "validation", "material", "-lrb-", "controlled", "nano-dispersion", "-rrb-", "value", "report", "mm", "phase", "function", "error", "give", "difference", "normalize", "norm", "reference", "phase", "function", "all", "four", "validation", "material", "have", "negligible", "absorption", "result", "both", "predict", "measure", "value", "agree", "those", "we", "report", "third", "decimal", "nm", "200", "polystyrene", "nm", "500", "polystyrene", "nm", "800", "polystyrene", "nm", "30", "Al", "phase", "function", "capture", "dictionary", "fit", "figure", "measurement", "validation", "material", "-lrb-", "controlled", "nano-dispersion", "-rrb-", "leave", "each", "material", "we", "show", "green", "wavelength", "theoretically", "predict", "-lrb-", "dash", "orange", "-rrb-", "recover", "-lrb-", "purple", "-rrb-", "phase", "function", "well", "best", "henyey-greenstein", "-lrb-", "green", "-rrb-", "phase", "function", "fit", "recovered", "phase", "function", "close", "agreement", "correct", "one", "purple", "orange", "curve", "tightly", "overlap", "another", "visualization", "we", "show", "image", "novel", "configuration", "under", "frontal", "collimated", "laser", "illumination", "-lrb-", "25", "-rrb-", "we", "compare", "we", "phase", "function", "best", "henyey-greenstein", "fit", "-lrb-", "image", "color-mapped", "better", "visualization", "-rrb-", "rightmost", "column", "show", "crossection", "through", "capture", "re-rendered", "image", "configuration", "recover", "object", "shape", "its", "surface", "microstructure", "-lrb-", "bsdf", "-rrb-", "addition", "combination", "we", "optimization", "framework", "more", "sophisticated", "imaging", "configuration", "could", "improve", "optimization?s", "stability", "convergence", "rate", "particular", "may", "fruitful", "apply", "we", "optimization", "image", "capture", "high-frequency", "illumination", "-lsb-", "Mukaigawa", "et", "al.", "2010", "-rsb-", "basis", "illumination", "-lsb-", "Ghosh", "et", "al.", "2007", "-rsb-", "adaptive", "illumination", "-lsb-", "o?toole", "Kutulakos", "2010", "-rsb-", "transient", "imaging", "-lsb-", "Wu", "et", "al.", "2012", "-rsb-", "also", "possible", "optimization", "scheme", "like", "ours", "allow", "exploit", "imaging", "modality", "solve", "more", "challenging", "inverse", "problem", "measure", "heterogeneous", "scatter", "media", "HG", "fit", "cross", "section", "Acknowledgments", "Funding", "provide", "National", "Science", "Foundation", "-lrb-", "award", "iis1161564", "iis-1012454", "iis-1212928", "iis-1011919", "-rrb-", "European", "Research", "Council", "Binational", "Science", "Foundation", "Intel", "ICRI-CI", "Amazon", "web", "Services", "Education", "grant", "award", "we", "thank", "Henry", "W.", "Sarkas", "Nanophase", "Technologies", "Corporation", "donate", "material", "sample", "calibration", "datum", "reference", "ntyufeev", "V.", "2000", "Monte", "Carlo", "method", "solve", "inverse", "problem", "radiation", "transfer", "vol", "20", "inverse", "ill-posed", "ACM", "transaction", "Graphics", "Vol", "32", "no.", "Article", "162", "publication", "date", "November", "2013", "162:12", "i.", "Gkioulekas", "et", "al.", "material", "first", "moment", "fitting", "generalization", "error", "-lrb-", "-rrb-", "error", "-lrb-", "-rrb-", "whole", "whole", "milk", "milk", "100.920", "100.920", "105.345", "105.345", "102.768", "102.768", "0.013", "0.013", "0.013", "0.013", "0.041", "0.954", "0.963", "0.946", "2.0460", "3.6344", "reduce", "reduce", "milk", "milk", "57.291", "57.291", "62.460", "62.460", "63.757", "63.757", "0.007", "0.007", "0.007", "0.007", "0.024", "0.954", "0.957", "0.942", "1.346", "2.039", "mustard", "mustard", "16.447", "16.447", "18.536", "18.536", "6.457", "6.457", "0.057", "0.057", "0.061", "0.061", "0.451", "0.155", "0.173", "0.351", "3.377", "4.201", "shampoo", "shampoo", "8.111", "8.111", "9.919", "9.919", "10.575", "10.575", "0.178", "0.178", "0.328", "0.328", "0.439", "0.907", "0.882", "0.874", "3.962", "4.752", "hand", "hand", "cream", "cream", "20.820", "20.820", "32.353", "32.353", "41.798", "41.798", "0.011", "0.011", "0.011", "0.011", "0.012", "0.188", "0.247", "0.265", "2.652", "3.221", "liquid", "liquid", "clay", "clay", "37.544", "37.544", "48.250", "48.250", "67.949", "67.949", "0.004", "0.004", "0.004", "0.004", "0.005", "0.312", "0.442", "0.512", "3.431", "4.532", "milk", "milk", "soap", "soap", "7,625", "7,625", "8.004", "8.004", "8.557", "8.557", "0.003", "0.003", "0.004", "0.004", "0.015", "0.164", "0.167", "0.155", "1.895", "2.956", "mixed", "mixed", "soap", "soap", "3.923", "3.923", "4.018", "4.018", "4.351", "4.351", "0.003", "0.003", "0.005", "0.005", "0.013", "0.330", "0.322", "0.316", "1.474", "3.316", "glycerine", "glycerine", "soap", "soap", "0.201", "0.201", "0.202", "0.202", "0.221", "0.221", "0.001", "0.001", "0.001", "0.001", "0.002", "0.955", "0.949", "0.943", "3.840", "3.920", "robitussin", "robitussin", "0.009", "0.009", "0.001", "0.001", "0.001", "0.001", "0.012", "0.012", "0.197", "0.197", "0.234", "0.906", "0.977", "0.980", "1.379", "3.998", "coffee", "coffee", "0.054", "0.054", "0.051", "0.051", "0.049", "0.049", "0.275", "0.275", "0.309", "0.309", "0.406", "0.911", "0.899", "0.906", "1.957", "2.199", "olive", "olive", "oil", "oil", "0.041", "0.041", "0.039", "0.039", "0.012", "0.012", "0.062", "0.062", "0.047", "0.047", "0.353", "0.946", "0.954", "0.975", "2.287", "3.846", "blue", "blue", "curacao", "curacao", "0.010", "0.010", "0.012", "0.012", "0.021", "0.021", "0.083", "0.083", "0.048", "0.048", "0.011", "0.955", "0.973", "0.979", "2.704", "4.857", "red", "red", "wine", "wine", "0.015", "0.015", "0.013", "0.013", "0.011", "0.011", "0.122", "0.122", "0.351", "0.351", "0.402", "0.947", "0.975", "0.977", "3.034", "3.192", "first", "moment", "fitting", "generalization", "material", "error", "-lrb-", "-rrb-", "error", "-lrb-", "-rrb-", "whole", "milk", "100.920", "105.345", "102.768", "0.013", "0.013", "0.041", "0.954", "0.963", "0.946", "2.0460", "3.6344", "reduce", "milk", "57.291", "62.460", "63.757", "0.007", "0.007", "0.024", "0.954", "0.957", "0.942", "1.346", "2.039", "mustard", "16.447", "18.536", "6.457", "0.057", "0.061", "0.451", "0.155", "0.173", "0.351", "3.377", "4.201", "shampoo", "8.111", "9.919", "10.575", "0.178", "0.328", "0.439", "0.907", "0.882", "0.874", "3.962", "4.752", "hand", "cream", "20.820", "32.353", "41.798", "0.011", "0.011", "0.012", "0.188", "0.247", "0.265", "2.652", "3.221", "liquid", "clay", "37.544", "48.250", "67.949", "0.004", "0.004", "0.005", "0.312", "0.442", "0.512", "3.431", "4.532", "milk", "soap", "7,625", "8.004", "8.557", "0.003", "0.004", "0.015", "0.164", "0.167", "0.155", "1.895", "2.956", "mixed", "soap", "3.923", "4.018", "4.351", "0.003", "0.005", "0.013", "0.330", "0.322", "0.316", "1.474", "3.316", "glycerine", "soap", "0.201", "0.202", "0.221", "0.001", "0.001", "0.002", "0.955", "0.949", "0.943", "3.840", "3.920", "robitussin", "0.009", "0.001", "0.001", "0.012", "0.197", "0.234", "0.906", "0.977", "0.980", "1.379", "3.998", "coffee", "0.054", "0.051", "0.049", "0.275", "0.309", "0.406", "0.911", "0.899", "0.906", "1.957", "2.199", "olive", "oil", "0.041", "0.039", "0.012", "0.062", "0.047", "0.353", "0.946", "0.954", "0.975", "2.287", "3.846", "blue", "curacao", "0.010", "0.012", "0.021", "0.083", "0.048", "0.011", "0.955", "0.973", "0.979", "2.704", "4.857", "red", "wine", "0.015", "0.013", "0.011", "0.122", "0.351", "0.402", "0.947", "0.975", "0.977", "3.034", "3.192", "Table", "scatter", "parameter", "material", "measure", "use", "we", "propose", "acquisition", "setup", "inversion", "algorithm", "value", "report", "mm", "average", "cosine", "measure", "phase", "function", "report", "while", "entire", "phase", "function", "show", "fitting", "novel", "capture", "image", "respectively", "whole", "milk", "reduce", "milk", "mustard", "liquid", "clay", "milk", "soap", "mixed", "soap", "coffee", "olive", "oil", "blue", "curacao", "figure", "phase", "function", "material", "measure", "use", "we", "acquisition", "setup", "-lrb-", "purple", "-rrb-", "contrast", "closest", "HG", "phase", "function", "-lrb-", "dash", "green", "-rrb-", "see", "Table", "numerical", "value", "problem", "Series", "V.S.P.", "International", "Science", "AL", "G.", "2009", "inverse", "transport", "theory", "application", "inverse", "problem", "25", "en", "rtzus", "a.", "GAN", "K.", "URAND", "F.", "AMAMOORTHI", "R.", "2008", "precomputed", "polynomial", "representation", "interactive", "brdf", "editing", "global", "illumination", "ACM", "Trans", "graph", "27", "hate", "N.", "okuta", "a.", "1992", "photorealistic", "volume", "rendering", "media", "directional", "scattering", "Third", "Eurographics", "Workshop", "Rendering", "ohren", "C.", "UFFMAN", "D.", "1983", "absorption", "scattering", "light", "small", "particle", "Wiley-Vch", "ottou", "L.", "OUSQUET", "O.", "2008", "tradeoff", "large", "Scale", "Learning", "nip", "handrasekhar", "S.", "1960", "radiative", "transfer", "Dover", "hen", "C.", "J.", "ING", "H.", "ACOBS", "K.", "Y.", "X.", "ET", "AL", "2006", "primary", "method", "determination", "optical", "pa", "shampoo", "hand", "cream", "glycerine", "soap", "robitussin", "red", "wine", "rameter", "turbid", "sample", "application", "intralipid", "between", "550", "1630", "nm", "Optics", "Express", "14", "16", "ebevec", "P.", "AWKINS", "T.", "CHOU", "C.", "UIKER", "H.", "arokin", "W.", "AGAR", "M.", "2000", "acquire", "reflectance", "field", "human", "face", "Proceedings", "SIGGRAPH", "2000", "annual", "Conference", "Series", "onner", "C.", "ENSEN", "H.", "2005", "light", "diffusion", "multilayered", "translucent", "material", "ACM", "Trans", "graph", "24", "onner", "C.", "EYRICH", "T.", "E.", "AMAMOORTHI", "R.", "usinkiewicz", "S.", "2008", "layered", "heterogeneous", "reflectance", "model", "acquire", "render", "human", "skin", "ACM", "Trans", "graph", "27", "uchus", "J.", "halev", "hwartz", "S.", "inger", "Y.", "HANDRA", "T.", "2008", "efficient", "projection", "onto", "ball", "learn", "high", "dimension", "icml", "utr", "P.", "ALA", "K.", "EKAERT", "P.", "2006", "Advanced", "global", "illumination", "AK", "Peters", "Ltd.", "ACM", "transaction", "Graphics", "Vol", "32", "no.", "Article", "162", "publication", "date", "November", "2013", "Inverse", "volume", "render", "Material", "Dictionaries", "162:13", "leming", "R.", "ULTHOFF", "H.", "2005", "low-level", "image", "cue", "perception", "translucent", "material", "ACM", "transaction", "Applied", "Perception", "-lrb-", "tap", "-rrb-", "risvad", "J.", "HRISTENSEN", "N.", "ENSEN", "H.", "2007", "Computing", "scattering", "property", "participate", "media", "use", "lorenz-mie", "theory", "ACM", "Trans", "graph", "26", "uch", "C.", "HEN", "T.", "OESELE", "M.", "heisel", "H.", "EI", "DEL", "H.", "2007", "density", "estimation", "dynamic", "volume", "Computers", "Graphics", "31", "hosh", "a.", "CHUTHA", "S.", "EIDRICH", "W.", "O?T", "OOLE", "M.", "2007", "brdf", "acquisition", "basis", "illumination", "IEEE", "CVPR", "kiouleka", "i.", "iao", "B.", "HAO", "S.", "DELSON", "E.", "ICKLER", "T.", "ALA", "K.", "2013", "understand", "role", "phase", "function", "translucent", "appearance", "appear", "ACM", "Trans", "graph", "32", "oesele", "M.", "ENSCH", "H.", "ang", "J.", "uch", "C.", "EIDEL", "H.", "2004", "disco", "acquisition", "translucent", "object", "ACM", "Trans", "graph", "23", "J.", "AYAR", "S.", "RINSPUN", "E.", "ELHUMEUR", "P.", "MAMOORTHI", "R.", "2008", "Compressive", "structured", "light", "recover", "inhomogeneous", "participate", "media", "eccv", "upta", "M.", "GRAWAL", "A.", "EERARAGHAVAN", "a.", "arasimhan", "S.", "2011", "structure", "light", "3d", "scanning", "presence", "global", "illumination", "IEEE", "CVPR", "asinoff", "S.", "URAND", "F.", "reeman", "W.", "2010", "noiseoptimal", "capture", "high", "dynamic", "range", "photography", "IEEE", "CVPR", "awkin", "T.", "INARSSON", "P.", "EBEVEC", "P.", "2005", "acquisition", "time-varying", "participate", "media", "ACM", "Trans", "graph", "24", "enyey", "L.", "REENSTEIN", "J.", "1941", "diffuse", "radiation", "galaxy", "Astrophysical", "Journal", "93", "olroyd", "m.", "awrence", "J.", "2011", "analysis", "use", "high-frequency", "sinusoidal", "illumination", "measure", "3d", "shape", "translucent", "object", "IEEE", "CVPR", "ullin", "B.", "uch", "M.", "JDIN", "B.", "hrke", "I.", "eidel", "H.", "ENSCH", "H.", "2008", "direct", "visualization", "real-world", "light", "transport", "Vision", "Modeling", "visualization", "2008", "shimaru", "a.", "1978", "wave", "propagation", "scattering", "random", "media", "wiley-ieee", "ENSEN", "H.", "arschner", "S.", "EVOY", "M.", "ANRAHAN", "P.", "2001", "practical", "model", "subsurface", "light", "transport", "Proceedings", "SIGGRAPH", "2001", "annual", "Conference", "Series", "ENSEN", "H.", "2001", "realistic", "image", "synthesis", "use", "photon", "mapping", "AK", "Peters", "Ltd.", "OHNSON", "C.", "ABRIEL", "D.", "1994", "Laser", "light", "scattering", "Dover", "awrence", "J.", "EN", "rtzus", "a.", "ORO", "C.", "atusik", "W.", "fister", "H.", "AMAMOORTHI", "R.", "usinkiewicz", "S.", "2006", "inverse", "shade", "tree", "non-parametric", "material", "representation", "editing", "ACM", "Trans", "graph", "25", "eque", "R.", "2007", "finite", "difference", "method", "Ordinary", "partial", "differential", "equation", "steady-state", "timedependent", "problem", "SIAM", "ormick", "N.", "ANCHEZ", "R.", "1981", "inverse", "problem", "transport", "calculation", "anisotropic", "scattering", "coefficient", "Journal", "Mathematical", "physics", "22", "199", "ishchenko", "M.", "ravi", "L.", "aci", "a.", "2006", "multiple", "scattering", "light", "particle", "radiative", "transfer", "coherent", "backscattering", "Cambridge", "University", "ukaigawa", "Y.", "agus", "Y.", "askar", "R.", "2010", "analysis", "light", "transport", "scatter", "media", "IEEE", "CVPR", "arasimhan", "S.", "UPTA", "M.", "ONNER", "C.", "AMAMOORTHI", "R.", "AYAR", "S.", "ENSEN", "H.", "2006", "acquire", "scattering", "property", "participate", "media", "dilution", "ACM", "Trans", "graph", "25", "ayar", "S.", "RISHNAN", "G.", "ROSSBERG", "M.", "askar", "R.", "2006", "fast", "separation", "direct", "global", "component", "scene", "use", "high", "frequency", "illumination", "ACM", "Trans", "graph", "25", "O?T", "OOLE", "M.", "UTULAKOS", "K.", "N.", "2010", "Optical", "computing", "fast", "light", "transport", "analysis", "ACM", "Trans", "graph", "29", "eer", "P.", "VOM", "ERGE", "K.", "atusik", "W.", "AMAMOORTHI", "R.", "AWRENCE", "J.", "USINKIEWICZ", "S.", "utr", "P.", "2006", "compact", "factored", "representation", "heterogeneous", "subsurface", "scattering", "ACM", "Trans", "graph", "25", "ine", "D.", "EITZ", "D.", "HU", "J.", "erbolzheimer", "E.", "1990", "diffusing-wave", "spectroscopy", "dynamic", "light", "scattering", "multiple", "scattering", "limit", "Journal", "de", "Physique", "51", "18", "rahl", "S.", "VAN", "EMERT", "M.", "ELCH", "A.", "1993", "determine", "optical", "property", "turbid", "media", "use", "add", "double", "method", "Applied", "optics", "32", "usey", "P.", "1999", "suppression", "multiple", "scattering", "photon", "cross-correlation", "technique", "current", "opinion", "colloid", "interface", "science", "amamoorthus", "R.", "ANRAHAN", "P.", "2001", "signalprocessing", "framework", "inverse", "rendering", "Proceedings", "SIGGRAPH", "2001", "annual", "Conference", "Series", "eynold", "L.", "ormick", "N.", "1980", "approximate", "twoparameter", "phase", "function", "light", "scattering", "josa", "70", "10", "ushmeier", "H.", "orrance", "K.", "1987", "zonal", "method", "calculate", "light", "intensity", "presence", "participate", "medium", "Computer", "Graphics", "vol", "21", "inger", "J.", "UNBAUM", "F.", "OHN", "P.", "UBELLI", "J.", "ET", "AL", "1990", "image", "reconstruction", "interior", "body", "diffuse", "radiation", "Science", "248", "4958", "ong", "X.", "ang", "J.", "S.", "UO", "B.", "HUM", "H.", "2005", "modeling", "rendering", "quasi-homogeneous", "material", "ACM", "Trans", "graph", "24", "ang", "J.", "HAO", "S.", "ong", "X.", "S.", "Z.", "ONG", "Y.", "UO", "B.", "HUM", "H.", "2008", "modeling", "rendering", "heterogeneous", "translucent", "material", "use", "diffusion", "equation", "ACM", "Trans", "graph", "27", "D.", "O?T", "OOLE", "M.", "ELTEN", "a.", "grawal", "a.", "askar", "R.", "2012", "decompose", "global", "light", "transport", "use", "time", "flight", "imaging", "IEEE", "CVPR", "YMAN", "D.", "atterson", "M.", "ILSON", "B.", "1989", "similarity", "relation", "interaction", "parameter", "radiation", "transport", "Applied", "optics", "28", "24", "ACM", "transaction", "Graphics", "Vol", "32", "no.", "Article", "162", "publication", "date", "November", "2013" ],
  "content" : "\n  \n    47cf3c40342b114fc05089051df018ac3ac6d30ecb9410aed71c33eafe2fc243\n    p35\n    10.1145/2508363.2508377\n    Name identification was not possible. \n  \n  \n    \n      \n        Inverse Volume Rendering with Material Dictionaries\n      \n      Ioannis Gkioulekas Shuang Zhao Kavita Bala Harvard University Cornell University Cornell University\n      \n        \n        Figure 1: Acquiring scattering parameters. Left: Samples of two materials (milk, blue curacao) in glass cells used for acquisition. Middle: Samples illuminated by a trichromatic laser beam. The observed scattering pattern is used as input for our optimization. Right: Rendering of materials in natural illumination using our acquired material parameter values.\n      \n      Scattering plays a critical role in the appearance of most materials. Much effort has been devoted to modeling and simulating its visual effects, giving us precise and efficient scattering simulation algorithms. However, these algorithms produce images that are only as accurate as the material parameters given as input. This creates a need for acquisition systems that can faithfully measure the scattering parameters of real-world materials. Collecting accurate and repeatable measurements of scattering is a significant challenge. For homogeneous materials?which is the primary topic of this paper?scattering at any particular wavelength is described by two scalar values and one angular function. The scattering coefficient ? s and absorption coefficient ? a represent the fractions of light that are scattered and absorbed, and the phase function p(?) describes the angular distribution of scattering. Measurement is difficult because a sensor almost always observes the combined effects of many scattering and absorption events, and these three factors cannot be easily separated. Indeed, for deeplyscattering geometries, similarity theory [Wyman et al. 1989] proves that one can analytically derive distinct parameter-sets that nonetheless produce indistinguishable images.\n    \n    \n      Abstract Translucent materials are ubiquitous, and simulating their appearance requires accurate physical parameters. However, physicallyaccurate parameters for scattering materials are difficult to acquire. We introduce an optimization framework for measuring bulk scattering properties of homogeneous materials (phase function, scattering coefficient, and absorption coefficient) that is more accurate, and more applicable to a broad range of materials. The optimization combines stochastic gradient descent with Monte Carlo rendering and a material dictionary to invert the radiative transfer equation. It offers several advantages: (1) it does not require isolating singlescattering events; (2) it allows measuring solids and liquids that are hard to dilute; (3) it returns parameters in physically-meaningful units; and (4) it does not restrict the shape of the phase function using Henyey-Greenstein or any other low-parameter model. We evaluate our approach by creating an acquisition setup that collects images of a material slab under narrow-beam RGB illumination. We validate results by measuring prescribed nano-dispersions and showing that recovered parameters match those predicted by Lorenz-Mie theory. We also provide a table of RGB scattering parameters for some common liquids and solids, which are validated by simulating color images in novel geometric configurations that match the corresponding photographs with less than 5% error. CR Categories: I.3.7 [Computer Graphics]: Three-Dimensional Graphics and Realism?Raytracing; Keywords: scattering, inverse rendering, material dictionaries\n      Links:\n      \n        \n      \n      DL PDF W\n      \n        \n        \n      \n      EB\n      \n        ACM Reference Format\n      \n      Gkioulekas, I., Zhao, S., Bala, K., Zickler, T., Levin, A. 2013. Inverse Volume Rendering with Material Dictionaries. ACM Trans. Graph. 32, 6, Article 162 (November 2013), 13 pages. DOI = 10.1145/2508363.2508377 http://doi.acm.org/10.1145/2508363.2508377.\n      \n        Copyright Notice\n      \n      Permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the fi rst page. Copyrights for components of this work owned by others than ACM must be honored. Abstracting with credit is permitted. To copy otherwise, or republish, to post on servers or to redistribute to lists, requires prior specific permission and/or a fee. Request permissions from permissions@acm.org . Copyright ? ACM 0730-0301/13/11-ART162 $15.00. DOI: http://doi.acm.org/10.1145/2508363.2508377\n      Todd Zickler Anat Levin Harvard University Weizmann Institute\n      \n        1 Introduction\n      \n      Most existing acquisition systems address the measurement challenge using a combination of two strategies (e.g., [Hawkins et al. 2005; Narasimhan et al. 2006; Mukaigawa et al. 2010]). First, they manipulate lighting and/or materials to isolate single-scattering effects; and second, they ?regularize? the recovered scattering parameters by relying on a low-parameter phase function model, such as the Henyey-Greenstein (HG) model. These approaches can provide accurate results, but both of the employed strategies have severe limitations. The single-parameter HG model limits applicability to materials that it represents well; and this excludes some common natural materials [Gkioulekas et al. 2013]. Meanwhile, isolating single scattering relies on either: (a) diluting the sample [Hawkins et al. 2005; Narasimhan et al. 2006], which cannot be easily applied to solids or to liquids that have unknown dispersing media; or, (b) using structured lighting patterns [Mukaigawa et al. 2010], which provide only approximate isolation [Holroyd and Lawrence 2011; Gupta et al. 2011] and therefore induce errors in measured scattering parameters that are difficult to characterize.  We introduce an optimization framework that allows measuring homogeneous scattering parameters without these limitations. Our optimization undoes the effects of low-order scattering by inverting the radiative transfer equation (i.e., by inverting a random walk) using a combination of Monte Carlo rendering and stochastic gradient descent. We evaluate our optimization framework by creating a volumetric scanner that uses a camera and narrow-beam RGB sources to collect a handful of images of a material sample that resides in a box-shaped transparent glass cell ( Figure 1 , left). Once calibrated, this scanner provides images of low-order scattering in which the geometry is precisely known. Using these images we optimize a dictionary-based set of scattering parameters so that they produce re-rendered images that match the acquired ones. We validate our results in two ways: one, we measure prescribed dispersions of nano-scale particles whose scattering parameters can be computed using Lorenz-Mie theory and show that our recovered parameters are in close agreement; two, we re-render color images of these materials in novel lighting configurations and show that they numerically match, within 5%, the new captured images. The benefits of our approach are: (1) We can accurately measure scattering for a broader set of liquids and solids since there is no need for precisely-isolated singlescattering effects. The thickness of the glass cell can be selected appropriately for each material; but it does not need to be chosen with excessive care since our optimization succeeds for a relatively broad range of thicknesses (anywhere between 0.1 to 10 times the mean free path of the material being measured). (2) We can support general phase function measurement, and are not restricted to HG or other low parameter models, because our optimization incorporates a large material dictionary that allows phase functions to be any convex combination of hundreds of dictionary elements. These general phase functions are particularly visually important for accurate visual appearance of objects with thin features. Our contributions include: ? An optimization framework to invert volumetric scattering using MC rendering and stochastic gradient descent. ? An acquisition setup to acquire homogeneous material scattering properties with physically accurate parameters. ? A table of RGB scattering parameters for a variety of common materials, both liquid and solid, as well as a publicly-available collection of tabulated phase functions. The availability of physically-accurate scattering parameters with general phase functions can improve simulations of translucent material appearance to better match that in the real world.\n      ACM Transactions on Graphics, Vol. 32, No. 6, Article 162, Publication Date: November 2013\n      162:2\n      ?\n      I. Gkioulekas et al.\n      \n        2 Related Work\n        Inverse radiative transport is studied in graphics, as well as in geophysical, biomedical, and chemistry domains; Bal [2009] provides a comprehensive review. Problems can be grouped into three categories, according to the ratio of the material?s mean free path?the average distance a photon travels before it is scattered?to the size of the scattering volume. We discuss these three categories in turn, and then we discuss phase function models and surface-based appearance models. Deep scattering and approximation by diffusion. Inverse problems in this category consider media that are optically-thick, so that photons scatter many times before being measured. Radiative transport is then modeled using the diffusion approximation, where the angular variation of the internal radiance is limited and the radiative  transport equation reduces to a partial differential equation [Ishimaru 1978]. The advantage of this approach is that it simplifies the inference problem, allowing efficient acquisition and rendering systems [Jensen et al. 2001; Donner and Jensen 2005] and, as demonstrated by Wang et al. [2008], the estimation of spatially-varying structure within a medium. In physics, the diffusion approximation is employed by diffusing-wave spectroscopy [Pine et al. 1990], which is used for applications such as particle sizing or the measurement of molecular weight. The diffusion approximation applies when high-order scattering is dominant, causing the phase function to be confounded with other scattering parameters [Wyman et al. 1989] and therefore reasonable to ignore. It is not appropriate for our application, where we seek material-specific phase functions that can accurately predict appearance for shapes that have arbitrary thin and thick parts. Single scattering and direct methods. At the other extreme are optically-thin situations, where photons scatter only once before being measured. Scattering parameters can often be measured directly in these cases, using techniques like static or dynamic light scattering [Johnson and Gabriel 1994]. For graphics, Hullin et al. [2008] use fluorescent dyes to make qualitative observations on the scattering parameters of optically thin media exhibiting mostly single scattering. Hawkins et al. [2005] use a laser to measure albedo and a tabulated phase function of a sparse homogeneous aerosol. For liquids, Narasimhan et al. [2006] successively dilute samples with water until they are sparse enough to infer from single-scattering an HG phase function. Single-scattering has also been exploited to capture time-varying and spatially-varying wisps of smoke and sparse mixing liquids [Hawkins et al. 2005; Fuchs et al. 2007; Gu et al. 2008]. All of these techniques rely on manipulating materials so that single-scattering dominates, and while dilution can be used for aerosols and some liquids, it cannot be easily applied to solids, or to liquids whose dispersing medium is unknown and significantly different from water. This limitation motivates methods for suppressing multiple scattering without dilution. Techniques for particle sizing or molecular weight, for example, exploit crosscorrelation properties of multiple temporal measurements [Pusey 1999], but these are specific to those applications and do not easily extend to our problem. For graphics, Mukaigawa et al. [2010] use high frequency lighting patterns to isolate single-scattering effects [Nayar et al. 2006], allowing direct access to the mean free path and a good initialization for an indirect (multi-scattering) optimization over an HG phase function parameter. Such lightingbased isolations of single scattering are potentially quite useful, but as discussed in the context of 3D surface reconstruction [Holroyd and Lawrence 2011; Gupta et al. 2011], they provide only approximate isolation, and there is currently no analysis of how this affects the accuracy of inferred scattering parameters. Low-order scattering and indirect methods. Our approach is in this category, where the goal is use moderately-thick samples to infer scattering parameters by iteratively refining them until they predict measurements that are consistent with the acquired ones (e.g., [Singer et al. 1990; Mukaigawa et al. 2010]). Most of these approaches focus like we do on homogeneous materials, since this is already very challenging. (A notable exception is Antyufeev [2000], who used regularized estimation to infer spatiallyvarying phase functions.) A common strategy in biomedical and physics domains is to simplify calculations by using planar slabs and spatially-uniform lighting that reduces the relevant scene geometry from three dimensions to two (e.g., [Chen et al. 2006; Prahl et al. 1993; McCormick and Sanchez 1981]). But this has the significant disadvantage of limiting access to angular scattering information, thereby increasing reliance on restrictive low-parameter phase function models. In contrast, our optimization applies to any geometrical configuration with any incident light field, as long as both are precisely calibrated. This allows using narrow-beam illumination, which improves access to angular scattering information and allows considering a much richer space of phase function models. Phase function models. Most existing approaches to inverse radiative transfer use the single parameter Henyey-Greenstein [1941] model or other low-parameter models [Reynolds and McCormick 1980], but these can only be accurate for materials they represent well. The shape of the phase function is important for appearance, especially for objects with thin parts, and as recently shown by Gkioulekas et al. [2013], there are common materials that are not well-represented by the HG model. We avoid the restrictions of low-parameter models through the use of a phase function dictionary with hundreds of elements. This is similar in spirit to dictionary-based BRDF representations used to analyze and edit opaque scenes without being restricted to any particular analytic BRDF model (e.g., [Lawrence et al. 2006; Ben-Artzi et al. 2008]). Surface reflectance fields and BSSRDF. There are a number of acquisition systems devoted to recovering surface-based descriptions of light transport through translucent objects [Debevec et al. 2000; Goesele et al. 2004; Tong et al. 2005; Peers et al. 2006; Donner et al. 2008]. These provide mappings between the input and output light fields on a specific object?s surface, and they do so without explicitly estimating all of the internal scattering parameters. They have the advantage of being very general and providing accurate appearance models for heterogeneous objects with complex shapes. Our goal is very different. We seek scattering material parameters that are independent of geometry, so that we can easily edit these materials and accurately predict their appearance when sculpted into any geometric shape.\n        ACM Transactions on Graphics, Vol. 32, No. 6, Article 162, Publication Date: November 2013\n        Inverse Volume Rendering with Material Dictionaries\n        ?\n        162:3\n      \n      \n        3 Volume light transport\n        Scattering occurs as light propagates through a medium and interacts with material structures. There are many volume events that cause absorption or change of propagation direction. This process has been modeled by the radiative transfer equation (RTE) [Chandrasekhar 1960; Ishimaru 1978; Mishchenko et al. 2006]:\n        ? T L (x, ?) = Q (x, ?) ? ? t L (x, ?)\n        \n          1\n          + ? s p (?, ?) L (x, ?) d? (?) , 2 S\n        \n        where x ? R 3 is a point in the interior or boundary of the scattering medium; ?, ? ? S 2 are points in the sphere of directions and ? is the usual spherical measure; Q (x, ?) accounts for emission from light sources; and L (x, ?) is the resulting light field radiance at every spatial location and orientation. The material is characterized by the triplet of macroscopic bulk parameters k = {? t , ? s , p (?)}. Specifically, the extinction coefficient ? t controls the spatial frequency of scattering events, and the scattering coefficient ? s ? ? t the amount of light that is scattered. The difference ? a = ? t ? ? s ? 0 is known as the absorption coefficient and is the amount of light that is absorbed. Finally, the phase function p is a function on S 2 ? S 2 determining the amount of light that gets scattered towards each direction ? relative to the incident direction ?. The phase function is often assumed to be invariant to rotations of the incident direction and cylindrically symmetric; therefore, it is a function of only ? = arccos (? ? ?) satisfying the normalization constraint ?\n        \n          2\n          2? p (?) sin (?) d? = 1. ?=0\n        \n        We also adopt this assumption in the remaining of the paper and consider only phase functions of this type (we discuss some of the technical details related to this assumption in the Supplementary  Appendix C). Complementary to the above quantities, the following two parameters are also used for describing scattering behavior: the mean free path, equal to d = 1/? t , and the albedo, equal to a = ? s /? t . In the following, we will use the parameter triplet k as an interchangeable term for scattering material. We consider homogeneous materials in which scattering parameters do not depend on spatial location. Scattering parameters also exhibit perceptually dominant spectral dependency [Fleming and B?lthoff 2005; Frisvad et al. 2007] but for notational clarity we omit wavelength dependency.\n        \n          3.1 Operator-theoretic formulation\n          We present the operator-theoretic formulation of the RTE that we will use to setup a tractable optimization procedure for volume rendering inversion. The specific formulation we use is tailored toward our optimization algorithm, but approximations of similar nature have been considered for rendering applications [Rushmeier and Torrance 1987; Bhate and Tokuta 1992]. In the following, we consider only points x in the interior of the scattering medium; we discuss boundary conditions and other details for this formulation in the Supplementary Appendix A. We begin by considering a finite difference approximation for the directional derivative [LeVeque 2007]\n          \n            3\n            ? T L (x, ?) ? 1 (L (x + h?, ?) ? L (x, ?)) . h\n          \n          Defining L i (x, ?) = hQ (x ? h?, ?), after simple algebraic manipulation we obtain from Equation (1)\n          \n            4\n            L (x, ?) = L i (x, ?) + (1 ? h? t ) L (x ? h?, ?) + h? s p ? T ? L (x ? h?, ?) d? (?) . 2 S\n          \n          We define the following linear operator in terms of the material parameters k = {? t , ? s , p (?)}, that acts on functions on R 3 ? S 2\n          \n            5\n            K k (L) (x, ?) (1 ? h? t ) L (x ? h?, ?) + h? s p ? T ? L (x ? h?, ?) d? (?) .\n          \n          2 S Intuitively, the action of K k can be viewed as a single step in the temporal propagation of a photon inside the medium. After traveling a distance of length h, the photon will transit in one of the following ways: 1) keep the same direction unaffected by the medium (probability 1?h? t ); 2) scatter towards a new direction determined by the phase function p (probability h? s ); 3) absorbed (probability h (? t ? ? s )). Consecutive applications of K k describe the timeresolved random walk the photon performs as it travels through the medium. Using the K k operator, we can rewrite the RTE (4) in the form\n          \n            6\n            L = L i + K k L.\n          \n          Solving Equation (6) for L, we can express the light field L as the result of a radiative transfer process R k on the input light field L i :\n          \n            7\n            L = R k L i ,\n          \n          with ?\n          \n            8\n            R k (I ? K k ) ?1 = K k j . j=0\n          \n          The second equality in Equation (8) follows by applying the Neumann series expansion, as it applies for the inverse of I ? K k .  (We discuss the invertibility of I ? K k in the Supplementary Appendix C.) It implies that the light field L resulting from the radiative transfer process of Equation (3) can be expressed as the sum of all orders of consecutive applications K k to the input light field L i . That is, L corresponds to the asymptotic density of photons, when accounting for all of the intermediate positions of each photon after an arbitrary number of random walk steps. We refer to K k as the single-step propagation operator and to R k as the rendering operator for material k. The validity of the above formulation for volume light transport relies on the accuracy of the approximation in Equation (3). In the limit that h goes to zero, the operator R k and the light field L of Equation (7) converge to the usual volume rendering operator [Jensen 2001] and the true light field inside the volume. In the Supplementary Appendix A, we discuss in detail this relationship, as well as analogies between operator K k and Equation (8), and their counterparts derived from the volume rendering equation. As explained there, how small h needs to be depends on the extinction coefficient ? t of the medium: h ?/? t . In our experiments, we use ? = 0.01.\n          ACM Transactions on Graphics, Vol. 32, No. 6, Article 162, Publication Date: November 2013\n          162:4\n          ?\n          I. Gkioulekas et al.\n        \n      \n      \n        4 Inverting volume scattering\n        We are interested in using images of an unknown material, to recover its scattering parameters k = {? t , ? s , p (?)}. Formally, we consider a known 3D shape filled with the unknown material, illuminated by calibrated light sources L m i , and imaged by calibrated cameras to produce images I m . Using the volume scattering Equation (6), we can write\n        \n          9\n          I m = S m L = S m (I ? K k ) ?1 L i m ,\n        \n        where the sampling operator S m describes the combination of light field rays measured by the corresponding camera. The terms L i m and S m fold in complete information about the 3D shape of the material volume, the relative light source and camera positions, as well as light interactions at the interface between the material volume and its surroundings. Modeling these light interactions involves a knowledge of the materials? refraction indices, and an assumption there is no further scattering between the material and the camera. Given a set of illuminations {L i m , m = 1, . . . , M } and their corresponding measurements I  ? m , m = 1, . . . , M , we cast the problem of inferring the material properties in an appearance matching framework: find the material parameters k that best reproduce the measurements in the least-squares sense\n        \n          10\n          M min w m S m (I ? K k ) ?1 L m i ? I  ? m 2 . k m=1\n        \n        where k is any permissible material parameter triplet {? t , ? s , p (?)}. We weight the error for each radiance measurement with w m = max c, ( I  ? m ) ? ?1 , c, ? > 0, to prevent the solution from overfitting only the brightest measurements. We selected c = 0.01 and ? = 3 using the experiments on synthetic data described in Section 6. In the rest of this section we derive an optimization algorithm for the appearance matching problem. We express the material parameters as a convex linear combination of the material dictionary. We then differentiate the appearance matching error with respect to the mixing weights and derive an efficient optimization scheme based on stochastic gradient descent and Monte-Carlo rendering. Despite the highly non-linear problem, we show through simulations that the error surface is smooth without local minima and allows accurate reconstruction of material parameters.\n        \n          4.1 Dictionary representation of materials\n          To better parameterize the search space in Equation (10), we use a dictionary representation for the materials. Specifically, consider a dictionary set of materials D = {k n , n = 1, . . . , N }, where k n = {? t,n , ? s,n , p n (?)}, and their corresponding single-step propagation operators {K k n }. Then, for any weight vector ? in the N -dimensional simplex ? N , N\n          \n            11\n            ? = [? n ] ? R N , ? n ? 0, n = 1, . . . , N, ? n = 1,\n          \n          n=1 we can represent a novel mixture material k (?) = {? t,? , ? s,? , p ? (?)}, in terms of the dictionary atoms as:\n          \n            12\n            N N ? t,? ? n ? t,n , ? s,? ? n ? s,n , n=1 n=1\n          \n          \n            13\n            N p ? (?) n=1 N ? n ? s,n p n (?) . n=1 ? n ? s,n\n          \n          It is easy to see that if each p n (?) satisfies the normalization condition of Equation (2), so does p ? (?). In the following, we denote by K (?) and R (?) the single-step propagation (Equation (5)) and rendering (Equation (8)) operators, respectively, for the material k (?). We denote the appearance matching error of the mixing weights ? as M\n          \n            14\n            E (?) = w m S m (I ? K (?)) ?1 L m i ? I  ? m 2 . m=1\n          \n          Then, we search for a convex combination of the material atoms in the dictionary D which best reproduces the captured images, by minimizing E (?) over ? ? ? N . To justify our use of convex combinations ? and the mixing Equations (12)-(13), we present the following lemma. Lemma 1. For any vector ? ? ? N , the single-step propagation operator K(?) for the mixed material k (?) defined by Equations (12)-(13), is a convex combination of the single-step propagation operators of the individual atoms, with the exact same mixing weights, N\n          \n            15\n            K (?) = ? n K k n . n=1\n          \n          .\n          Proof. Denoting f = L (x ? h?, ?), and using Equation (5), N N N (5) ? n K k n (L) = ( ? n ?h ( ? n ? t,? ) )f n=1 n=1 n=1 =1 ? t N T + h ? n ? s,n p n ? ? f (x, ?) d? (?) . 2 S n=1 (16) For the expression of Equation (16) to be an operator of the form of Equation (5), we express the integral as: N ? n ? s,n n=1 N ? N n ? s,n p n ? T ? f (x, ?) d? (?) n=1 S 2 n=1 ? n ? s,n ? s,? p ? (?) (17) From Equations (16) and (17), we get exactly the single-step propagation operator of the material k(?) in Equation (15).\n          ACM Transactions on Graphics, Vol. 32, No. 6, Article 162, Publication Date: November 2013\n          Inverse Volume Rendering with Material Dictionaries\n          ?\n          162:5\n          lighting camera L i m sampling S m p ? (?) ? material sample L i m L 1 m ? ? ? ? S m ?\n          full rendering R (?)\n          \n            \n          \n          single-step propagation\n          I 1 m\n          \n            Figure 2: Gradient computation (Equation (19)) for the dictionary-based appearance matching optimization problem (Equation (14)). For each pair of lighting and viewing directions, the gradient with respect to the weight of the n-th dictionary material requires computing a cascade of three rendering operations: a full volume rendering using the mixture material; then a single-step propagation using the corresponding atom material; then another full volume rendering using the mixture material. The resulting light fields are then sampled to produce the images used algebraically in Equation (19).\n          \n          Lemma 1 shows that a convex combination of materials k n can be directly identified with a convex combination of single-step propagation operators K k n . As a result, the objective function of the optimization problem of Equation (14) has a much simpler functional dependence on the parameters ? we optimize over, allowing us to derive a tractable optimization strategy as discussed in the following subsection. This property is the key motivator for our use of the finite-difference approximation in the operator-theoretic formulation of Section 3.1. As shown in the Supplementary Appendix A deriving an analogous result from a volume rendering formulation, in contrast, requires that the extinction coefficient be known beforehand and fixed for all the atoms in dictionary D.\n        \n        \n          4.2 Optimization Algorithm\n          To minimize the appearance matching error of Equation (14), we differentiate it with respect to the mixing weights ? using the following lemma: Lemma 2. For the operator K (?) defined in Equation (15), the following differentiation rule holds\n          \n            18\n            ?? ? n (I ? K (?)) ?1 = (I ? K (?)) K k n (I ? K (?)) .\n          \n          This is a well-known result in the case of finite-dimensional matrices. In the Supplementary Appendix C, we provide a precise statement and proof of the lemma for the case of infinite-dimensional linear operators. Using Equations (15) and (18), we can write the gradient of E (?) with respect to each coordinate of the mixture weight vector ? as\n          M ?E (?) = 2w m S m (I ? K (?)) ?1 L m i ? I  ? m ?? n m=1 L m 1 L m 2 ?S m (I ? K (?)) ?1 K k n (I ? K (?)) ?1 L m i . L m 1 L m 3 (19)\n          Equation (19) is crucial for our optimization. It shows that the gradient computation simplifies to rendering and sampling operations:\n          p n (?) ? p ? (?) ? L m 2 L m 3 ? ? ? ? S m ?\n          K n full rendering R (?)\n          \n            \n          \n          I 3 m\n          1. Render a light field L m 1 starting from input radiance L i m , and using the rendering operator R (?). 2. Apply the single-step propagation operator K k n , corresponding to the n-th material k n in the dictionary D, on L m 1 , producing a light field L 2 m . 3. Render a light field L 3 m , by applying the full rendering operator R (?) on L 2 m . 4. Apply the sampling operator S m on L 1 m and L m 3 , and evaluate their product (Equation (19)).\n          These gradient evaluation steps are summarized in Algorithm 1, and visualized in Figure 2 . Rendering. The fact that the appearance error gradient can be expressed as a sequence of rendering steps has an important practical implication: it allows us to evaluate it efficiently using Monte-Carlo rendering techniques [Dutr? et al. 2006]. For the first stage, in our implementation we use the traditional volume rendering operator (described in the Supplementary Appendix A), as for small enough h it produces equivalent results to the rendering operator R (?) of our finite-difference formulation. We estimate separately the direct illumination term (which depends only on the assumed known radiance sources in the scene and is easy to compute) and the indirect component. For the latter, we use a Monte-Carlo particle tracing process to estimate I 1 , while simultaneously caching all intermediate particle positions in a set C 1 to form an approximation of L 1 . This process is described in Algorithm 3. Then the application of K k on L 1 is stochastically approximated as described in Algorithm 4: particles are uniformly sampled from C 1 , propagated by h, and then either scattered or absorbed. The results are cached in a set C 2 as an approximation of L 2 . Finally, samples from C 2 are used as sources for another full particle tracing process that directly estimates I 3 , without further caching. This is performed similar to Algorithm 3, but with the initialization of x and ? in Step 2 replaced by an initialization from a particle drawn uniformly from C 2 and with the caching Step 10 omitted. We discuss further details about the algorithm we use to render ?E , including handling of Fresnel ?? n reflection and refraction, in the Supplementary Appendix B. Stochastic gradient descent. The availability of stochastic estimates of the gradient makes stochastic gradient descent (SGD) algorithms attractive for minimizing Equation (14). Similar to standard gradient descent, SGD algorithms perform iterations of steps\n          ACM Transactions on Graphics, Vol. 32, No. 6, Article 162, Publication Date: November 2013\n          162:6\n          ?\n          I. Gkioulekas et al.\n          Algorithm 1 ComputeGradient. Input: ? ? ? N . 1: for n = 1 to N do 2: g n ? 0. 3: for m = 1 to M do 4: Render L m 1 ? R (?) L i m . 5: Apply single-step propagation L m 2 ? K k n L 1 m . 6: Render L m 3 ? R (?) L 1 m . 7: Sample I 1 m ? S m L m 1 . 8: Sample I 3 m ? S m L 3 m . 9: g n ? g n + 2w m I 1 m ? I  ? m I 3 m . 10: end for 11: end for 12: return g.\n          proportional to the negative of the stochastic estimates of the gradient. These algorithms only require that the estimates be unbiased; even if they are otherwise noisy, there exist convergence guarantees analogous to those of standard gradient descent, with the noise variance only affecting convergence speed. This behavior has an important practical implication: we can reduce the number of particles in Monte-Carlo evaluations of the gradient, and speed computation at the cost of introducing noise to the gradient estimate. As long as the rendering algorithm is unbiased such noisy gradient estimates are valid inputs to SGD. The noise due to the reduced number of particles somewhat increases the number of iterations. However, it is still possible to reduce the number of particles quite drastically, and achieve a significant speedup in terms of overall computation time [Bottou and Bousquet 2008]. As the vector ? is constrained to lie on the simplex, we use projected stochastic gradient descent (PSGD). We denote by g ? R N consecutive noisy estimates of the gradient of E (?) obtained through Monte-Carlo rendering such that\n          \n            20\n            ?E (?) E [g n ] = . ?? n\n          \n          We use them to iterate\n          \n            21\n            ? (t+1) = P ? N ? (t) ? ? (t) g (t) ,\n          \n          where P ? N denotes the Euclidean projection operator to the simplex ? N [Duchi et al. 2008]. The step size is often chosen equal to ? (t) = ? c . Though the speed of convergence depends on the t proportionality constant c, in practice SGD is known to be robust to this selection. To cancel noise in individual steps, SGD returns as its final output the average of all T iterations, ? opt = T 1 T t=0 ? (t) . This procedure is summarized in Algorithm 2. The optimization problem we solve is highly non-linear and essentially involves inversion of the photon random walk process. Despite the non-linear formulation, our simulations in Section 6.2 show it allows an accurate reconstruction of material parameters. While an exact proof of this property is a subject for further research, all our simulations indicate that the error surface is very smooth and does not suffer from local minima, explaining the good convergence we are able to achieve.\n        \n        \n          4.3 Dictionary\n          The dictionary-based formulation of the appearance matching problem in Equation (14) can be used with any dictionary choice 1 . Our own simple dictionary is described below. We start with the phase\n          1 We use the term ?dictionary? because the phase function sets we use can be underor over-complete and not strictly ?bases? in the technical sense.\n          Algorithm 2 Solve appearance matching optimization problem. (0) 1: Initialize ? n ? 1/N . 2: while not converged do 3: g (t) ? ComputeGradient ? (t) . 4: ? (t+1) ? P ? N ? (t) ? ? (t) g (t) . 5: end while 6: return ? opt = T 1 t=0 T ? (t) . Algorithm 3 Adjoint particle tracing for computing L 1 and I 1 . 1: Let x 0 be the location where the laser hits ?S. 2: x ? x 0 , ? ? ? L , t ? 1, C 1 ? ?. 3: while true do 4: t ? t ? a. 5: Sample s from pdf p (s) = ? t exp (?? t s). 6: x ? x + s ? ?. 7: if x ? / S then 8: break 9: end if 10: Cache the particle location C 1 ? C 1 ? {(x, ?)}. 11: Let ? 1 be the direction connecting x and the camera. 12: Let y 1 be the intersection of ray (x , ? 1 ) and the image sensor. 13: v 1 ? t ? p ? 1 T ? ? exp (?? t x ? y 1 ) ? P 0 c/A, where c is the total number of pixels on the sensor, A is the sensor?s surface area, and P 0 is the source power. 14: Add v 1 to the corresponding pixel on the image sensor. 15: Sample a direction ? 2 according to the phase function p. 16: x ? x , ? ? ? 2 . 17: end while Algorithm 4 Importance sampling for computing L 2 . 1: C 2 ? ? 2: Uniformly sample a pair (x 0 , ? 0 ) ? C 1 . 3: x ? x 0 , ? ? ? 0 . 4: x ? x + h?. 5: Sample u uniformly in (0, 1). 6: if u < h (? t,k ? ? s,k ) then 7: terminate 8: end if 9: if h (? t,k ? ? s,k ) < u < h? t,k then 10: Sample a direction ? according to the phase function p k . 11: ? ? ?. 12: end if 13: Cache the particle location C 2 ? C 2 ? {(x, ?)}.\n          \n            Figure 3: Phase functions in a tent dictionary with N = 10 atoms (each atom is colored uniquely for better visualization). To be valid probability distributions on the sphere, the atoms are normalized to satisfy Equation 2, and thus have varying magnitudes. The atoms centered at 0 ? and ? ? are shown cropped.\n          \n          function component of the materials and then address the extinction and scattering components. Phase functions. To allow the dictionary to be as general as possible, we aim to be able to express any phase function, that is, any cylindrically symmetric probability distribution on the sphere. Hence, we simply model the phase function as a piecewise linear  function of ?. Then, we can use a set of tent (triangular) functions, spaced equally over angular domain ? ? [0, ?], to approximate it. Denoting the bins number by N and the bin spacing by ? s = ?/ (N ? 1), we use tent functions of width 2? s and centered at points ? n = (0, ? s , 2? s , . . . , ?). Each of the tent functions is normalized to satisfy the constraint of Equation (2). In Figure 3 , we show the phase functions in a tent dictionary with N = 10. In our experiments, we use N = 200, which corresponds to a discretization step of 0.9 ? . To avoid high frequency artifacts in the phase function solution we include in Equation (14) a quadratic regularization on its derivatives n (? n ? ? n+1 ) 2 . Extinction and scattering coefficients. The definition of the atoms? extinction and scattering coefficients should ensure that the dictionary can represent materials with a wide range of ? t , ? s values. We select an upper bound ? t,max on the desired extinction coefficients. Note that each scattering function of the form {? t , ? s , p(?)} with 0 ? ? t ? ? t,max and 0 ? ? s ? ? t , lies on the simplex spanned by {? t,max , ? t,max , p (?)}, the purely absorptive atom {? t,max , 0, ?}, and an atom of the form {0, 0, ?} describing scattering-free propagation in vacuum. We use the symbol ? to indicate that the last two atoms are independent of phase function (the phase function is undefined for these two media). Therefore, we create a scattering dictionary including 200 atoms of the form {? t,max , ? t,max , p n (?)} with the p n (?) defined above, plus the two purely absorptive atoms {? t,max , 0, ?} and {0, 0, ?}. In our experiments we set ? t,max = 200 mm ?1 , based on the results from Section 6.2. Other parameterizations: Our specific choice of dictionary is aimed to represent any general phase function shape. Depending on the application, other dictionaries may be more appropriate, and some examples include: zonal spherical harmonics for lowfrequency phase functions, phase functions derived from Mie theory [Bohren and Huffman 1983; Frisvad et al. 2007] when measuring dispersions, and compact dictionaries such as a set of a few Henyey-Greenstein and von Mises-Fisher functions [Gkioulekas et al. 2013] when a simple phase function model is sufficient. A small adaptation can also allow differentiating directly with respect to the single parameter of a Henyey-Greenstein function (the average cosine). Our optimization framework is quite attractive even for retrieving such simpler phase functions, since it alleviates the need for input measurements which isolate single scattering events.\n          ACM Transactions on Graphics, Vol. 32, No. 6, Article 162, Publication Date: November 2013\n          Inverse Volume Rendering with Material Dictionaries\n          ?\n          162:7\n        \n      \n      \n        5 Acquisition Setup Design\n        The optimization strategy described above is general enough to be applied to captured data with any geometry, as long as we can calibrate the 3D shape of the material, the relative position of the camera and light source, and the indices of refraction of the scattering material and its surroundings. Below we describe the physical acquisition setup we built, which is motivated by the simplicity of this calibration process and by some considerations related to the stability of the optimization problem. Inspiration is also drawn from analogous designs in [Jensen et al. 2001; Goesele et al. 2004; Wang et al. 2008] and physics [Johnson and Gabriel 1994]. A schematic and a photograph of our acquisition setup are shown in Figure 4 . Further implementation details are provided in the Supplementary Appendix D. Geometry. We cast the material we are interested in measuring into glass cells of variable thickness w. This allows us to create box-shaped material samples whose exact shape is known with very high accuracy. Furthermore, using micron-accurate smooth glass surfaces means that transition and refraction at the various material interfaces (material and glass, glass and air) can be easily simulated\n        sample container frontlighting hyperspectral camera backlighting w rotation stages ? f ? o ? b projective top view\n        \n          \n          Figure 4:\n        \n        Setup for scattering parameter acquisition. A sample cell is illuminated by collimated beams and imaged by a camera. Rotation stages to achieve arbitrary combinations of lighting and viewing directions. Top: schematic; bottom: implementation.\n        using Fresnel refraction and reflection laws. In our experiments, we use cells of widths w = 1, 2.5, 5, and 10 mm. Imaging and lighting. We use an approximately orthographic camera with a high magnification macro lens (4.3 ? subtended angle and 1 : 3 reproduction ratio) to sample the light field produced by the material volume. We use narrow (1 mm diameter) collimated beams to illuminate the sample. We use a configuration that allows illuminating either the sample surface imaged by the camera (frontlighting), or its opposite (backlighting). Through a combination of two motorized rotation stages, we can achieve different combinations of front and back lighting directions ? f , ? b and viewing directions ? o . In our experiments, we use all possible combinations of ? f , ? b , ? o ? {5 ? , 15 ? , 25 ? }, resulting in a set of 18 measurements per sample, 3 viewing directions times 3 frontlighting plus 3 backlighting directions. The above combination of sample shape, camera, and illumination lends itself to accurate calibration. In the Supplementary Appendix C we justify the use of collimated beams mathematically. Similar to the BRDF arguments of Ramamoorthi and Hanrahan [2001], we argue that to maximize angular information the configuration should have broadband angular frequency content, and hence be as close as possible to a delta function. The use of both frontlighting and backlighting is motivated by the understanding that a backlighting beam produces measurements dominated by high-order scattering; such measurements are intuitively useful for determining the optical thickness of the material. Conversely, frontlighting results in measurements where low-order scattering is significant, and therefore is informative for the recovery of the material phase function. Multi-chromatic measurements. Scattering parameters vary as functions of wavelength, and this spectral dependency can create perceptually important effects in appearance [Fleming and B?lthoff 2005; Frisvad et al. 2007]. To capture spectral variations we use monochromatic laser light at three RGB wavelengths,  488, 533, 635 nm, and solve the optimization problem of Equation (14) independently for each wavelength. Index of refraction. To calibrate for the unknown material?s index of refraction, we use a set of additional measurements with backlighting such that ? 0 = ? b (corresponding to direct observation of the source in the absence of a medium). By measuring the shift in the location of the point-spread-function peak caused by refraction in these images, we can easily solve for the material index of refraction at each of the three wavelengths we use. We discuss this process in more detail in the Supplementary Appendix D. We have found our measurement procedure to be adequately accurate for our purposes, but if necessary more accurate measurements of the material index of refraction can be obtained using a refractometer. Additionally, in experiments on synthetic data, we found that small perturbations of the index of refraction (?0.1) did not affect recovered scattering parameters considerably.\n        ACM Transactions on Graphics, Vol. 32, No. 6, Article 162, Publication Date: November 2013\n        162:8\n        ?\n        I. Gkioulekas et al.\n      \n      \n        6 Experiments\n        We now demonstrate and validate our approach for acquiring scattering parameters. We begin with evaluations on synthetic data aimed at understanding the characteristics of our optimization problem. We then show results on two sets of measured materials. The first is a ?validation set? of carefully-constructed nano-dispersions whose scattering parameters can be computed using Lorenz-Mie theory; this set provide a means for quantitative validation. The second set consists of everyday materials that are evaluated by their ability to produce accurate rendered images for novel geometries.\n        \n          6.1 Capture and computation time\n          We first provide some quantitative information for the acquisition and inversion stages of our measurement pipeline. At the acquisition stage, as described in Section 5, for a single material we take measurements at three wavelengths and a set of 18 different scene configurations, for a total of 54 measurements. Each of these measurements is a high-dynamic range (HDR) image, composited from low-dynamic range images captured at 19 different exposures. In addition, for every material we measure, we capture a set of lowdynamic range calibration images. This process results in a total capture time of approximately 75 minutes per material. We provide more details about the calibration and high-dynamic range imaging procedures in the Supplementary Appendix D. At the inversion stage, we solve the optimization problem of Section 4 on Amazon EC2 clusters of 100 nodes, with 32 computational cores and at least 20 GB of memory per node (required for the caching of intermediate light fields, as described in Section 4.2). We use the nodes to distribute the outer loop of Algorithm 1, that is, the gradient computation for each dictionary atom (for a dictionary of N = 200 atoms, each node is responsible for two atoms). The results are accumulated at a single master node, which then performs the gradient step of Algorithm 2, and the process is repeated for the number of iterations required until convergence is achieved. We found that processing one set of measurements requires approximately 200 iterations of the SGD algorithm. Overall, fitting one wavelength for a single material requires three to six hours, depending on the density of the material. We use our own C/C++ implementation, which we have optimized through experiments on synthetic data. However, computation could be reduced by further fine-tuning the various parameters involved, such as dictionary, camera spatial resolution, number of iterations, number of samples per rendering, and so on.\n        \n        \n          6.2 Experiments with Synthetic Data\n          The optimization problem of Section 4 involves the inversion of a random walk process that includes multiple scattering events and is  highly non-linear. Despite this, we almost always see in our experiments convergence to a solution that explains the measured data very well. This suggests that the error surface is fairly smooth. To provide more insight, we conduct a series of simulation experiments in which input image-sets are generated using small, artificial three-element dictionaries. Since the three mixing weights are constrained to a simplex, the set of phase functions spanned by three elements is a 2D space, allowing the entire cost surface to be visualized. For these experiments, we parameterize the 2D phase function space by the weights on the first two atoms (? 1 , ? 2 ), and in each experiment we choose a ?ground truth? phase function (? 1 ? , ? 2 ? ) and compute for each (? 1 , ? 2 ) the L 2 -difference between input images rendered with that phase function {I m (? 1 , ? 2 )} m=1...M and those rendered with the true one {I m (? 1 ? , ? 2 ? )} m=1...M . Results from six representative experiments are shown in Figure 5 . Each row shows three separate experiments in which the true phase function is the same while the optical density ? t differs. We find that the error surface has a clear minimum at the true value in all of these 2D experiments, and while an exact proof remains a subject for future research, the cost function appears to be very smooth and without spurious local minima, at least for these 2D problems. In the next experiment with synthetic data, we compare accuracy on absorbing materials versus scattering materials, and on materials with varying optical densities. We consider a large set of artificial materials that are combinations of: (i) ? t values sampled logarithmically in the interval 0.01, . . . , 200 mm ?1 , for a total of 21 values; (ii) ? s values corresponding, for each ? t , to 21 albedo values, linearly sampled between a = 0 (purely absorptive) and a = 1 (purely scattering); and (iii) a set of eight different phase functions spanning a wide range of shapes. For each artificial material we render synthetic images using geometry that matches our setup (Section 5) with a sample width of w = 1 mm. Sensor noise is an important consideration for this analysis, so we simulate image noise using photon (Poisson) noise with the parameters reported for two different commercial DSLR cameras [Hasinoff et al. 2010] (which is very large relative to the Monte Carlo rendering error). The noisy images are input to our optimization algorithm, and we measure error between the recovered parameters and the true ones. We use a tent dictionary with N = 200 atoms. Figure 6 provides a summary of these experiments, by visualizing separately the relative error between the estimated and true values of (left to right): albedo a = ? s /? t , extinction coefficient ? t , and phase function p(?). Each point in these tables corresponds to the percent error?averaged over the eight true phase function shapes? for distinct values of true albedo (horizontal axis) and extinction coefficient (vertical axis). These tables reveal which types of materials we can expect to measure accurately with our setup. Traveling from\n          ? ?error\n          \n            \n            \n            \n            \n          \n          ? t = 5 ? t = 10 ? t = 20\n          \n            Figure 5: The error surface for 2D optimization problems. We consider a dictionary of three phase functions whose mixing weights lie on the simplex. The simplex is parameterized by its first two coordinates. Columns show results for three reference ? t , and the rows show two different points as the correct reference in this space.\n          \n          ACM Transactions on Graphics, Vol. 32, No. 6, Article 162, Publication Date: November 2013\n          Inverse Volume Rendering with Material Dictionaries\n          ?\n          162:9\n          albedo error (%) extinction coefficient error (%)\n          short\n          short\n          (log) path free mean\n          (log) path free mean\n          \n            \n            \n          \n          long absorptive\n          50 45 40 35 30 25 20 15 10 5 0 scattering\n          long absorptive\n          albedo\n          albedo\n          \n            Figure 6: Accuracy in the recovery of material parameters. The plots show recovery errors for albedo, extinction coefficient, and mean error for phase function, as a function of different values of albedo a = ? s /? t and mean free path d = 1/? t .\n          \n          left to right in these tables makes a gradual transition from purely absorbing materials to purely scattering ones. Traveling from bottom to top moves through materials of increasing optical density, with the top being materials whose mean free path is two hundred times smaller than the sample width d = 1/? t = w/200, and the bottom being materials whose mean free path is one hundred times larger than the sample width d = 1/? t = 100w.  The first observation?based on the large, low-error regions in the center of the tables?is that estimation is accurate for a wide range of optical densities. This is a useful fact because it means the width of the glass cell need not be chosen with excessive care. We expect very accurate results as long as the sample width is within an order of magnitude of the material?s mean free path, and we expect graceful degradation when the width extends beyond this in either direction. For extremely optically-thin materials (lower rows in table), scattering events become very rare, and images are dominated by noise. For extremely optically-thick materials (top rows), the diffusion approximation [Jensen et al. 2001] becomes applicable, and recovering both the phase function and the scattering coefficient becomes ill-posed. In practice, we simply choose the width for each material sample from a discrete set of available glass cells (1, 2.5, 5, 10 mm) so that they look reasonably translucent under natural light; see examples in Figure 7 . Errors induced by extreme optical thinness and thickness at the top and bottom of these tables should be interpreted differently. If a material is excessively thin at sample width w, it is relatively easy to instead use a glass cell that is larger. This is less true for materials that are excessively dense, however, since it is physically challenging to cast materials into glass cells that are too small (w < 1 mm). Thus, in cases of extreme optical thickness, our setup will not provide material parameters that can accurately predict appearance on arbitrary geometries, but only for novel geometries at least as wide as the measured sample. As expected, we also observe large errors in the estimated phase function when materials are extremely absorptive (left column of third table in Figure 6 ). These errors are somewhat of a computational artifact and have a limited impact on visual appearance. They occur because the appearance of these materials is dominated by attenuation due to absorption, so very little scattering is observed and there is little discernible information about the shape of the phase function. These errors do not impact our ability to predict material appearance, however, because the phase function makes little difference. Indeed, for purely absorptive materials (left-most column) there is no scattering at all, and the phase function can be defined arbitrarily without having any effect on appearance.\n          phase function error (%)\n          short (log) path free mean\n          \n            \n          \n          50 45 40 35 30 25 20 15 10 5 0 scattering\n          long absorptive\n          100 90 80 70 60 50 40 30 20 10 0 scattering\n          albedo\n          \n            \n            Figure 7:\n          \n          Measured materials in glass cells of width w = 1, 10, and 2.5 mm, from left to right. It is not necessary for all of the cell to be filled, as long as there exists a homogeneous region of size comparable to the beam diameter (e.g., hand cream).\n          6.3 Validation materials It is common in graphics to evaluate measured scattering parameters by demonstrating renderings of visually plausible results. This is an important benchmark, but it does not directly assess the accuracy of the recovered physical parameters. Since our goal is to produce parameters that are faithful to the true mean free path lengths and phase functions in an absolute sense, being able to directly validate the scattering parameters is crucial. To achieve comparison to ?ground truth? parameters, we capture liquid materials whose exact physical structure are known, similar to materials that are used to calibrate instruments used in a variety of domains for particle sizing or estimating molecular weight [Johnson and Gabriel 1994; Pine et al. 1990]. They are created by dispersing nano-scale spherical particles of known chemical composition into a homogeneous embedding medium of a different refractive index, using procedures that allow for very precise control of particle concentration, particle size distribution, and homogeneity. Given these parameters, Lorenz-Mie theory [Bohren and Huffman 1983; Frisvad et al. 2007] provides analytic expressions of the bulk material scattering parameters {? t , ? s , p (?)} at any wavelength. We measure nanodispersions of two types. First, we measure dispersions of polystyrene spheres in water that are almost monodisperse (single particle size) and are precise enough to be traceable to NIST Standard Reference Materials. We measure three such dispersions 2 , each having a 1% (w/v) concentration of particles at a different particle radius: 200, 500, or 800 nm. Second, we measure a spherical polydispersion of aluminum oxide particles (Al 2 O 3 ) in water 3 , with an approximately known particle size distribution in  the range 20 ? 300 nm and mean radius of 30 nm. We use glass cells of width w = 1 mm for all of these measurements, and instead of estimating the indices of refraction from image data, we use those predicted by Lorenz-Mie theory. The results of our measurements are shown in Table 1 . In all cases, the error in the recovered parameters is less than 5%. (Note that these materials are purely scattering, so ? t = ? s .) The largest error occurs for the aluminum oxide material, for which the particle size distribution is known much less precisely. Figure 8 -left compares the green-channel phase functions recovered by our optimization (purple curves) to the ground truth phase functions predicted by Lorenz-Mie theory (dotted orange curves). We see that the matches are extremely close. As a reference, we compare both to HenyeyGreenstein phase functions; as the single parameter g of an HG phase function is equal to its average cosine, we plot (green curves) the HG phase function that have g values that are equal to the average cosine of the ground truth phase function. We note that their shapes deviate significantly from the ground-truth. This deviation is important for appearance, particularly for objects that have thin geometry with low-order scattering, where the phase function plays an important role visually. The middle columns demonstrate this by showing captured and fit (pseudo-colored) images of the materials under frontal laser illumination at a new angle (which was not used in optimization). The rightmost column shows cross-sections of the image intensities. The deviations of the HG fits from ground-truth lead to discernible differences between the images. These experiments highlight the fact that simple, single-parameter phase function models can be insufficient for modeling the appearance of scattering materials, and it justifies our choice to fit higherdimensional phase function models.\n          2 Nanobead NIST Traceable Particle Size Standards, Polysciences, Inc. 3 NanoArc Aluminum Oxide, Nanophase Technologies Corporation.\n          ACM Transactions on Graphics, Vol. 32, No. 6, Article 162, Publication Date: November 2013\n          162:10\n          ?\n          I. Gkioulekas et al.\n        \n        \n          6.4 Other materials\n          Next, we use our acquisition setup and optimization algorithm to measure several common materials. They can be grouped roughly into three categories: ? Highly scattering liquids of varying viscosities; including mustard, shampoo, hand cream, liquid designer clay, and different types of milk. ? Highly absorbing liquids with limited scattering; including coffee, robitussin, olive oil, blue curacao liquor, and red wine. ? Solids that can be molded into the glass cells; such as different types of soap. By ?eyeballing? each sample under natural light, we choose glass cell widths so that each sample looks reasonably translucent under ambient lighting. The results we report were captured using width w = 1 mm for materials in the first and third categories, except for glycerine soap; and w = 10 mm for the second category and glycerine soap. Photographs of samples in 1 mm, 2.5 mm, and 10 mm cells are shown in Figure 7 . For each sample, we estimate the index of refraction as described in Section 5, and these range from values of 1.33 (for milk, reduced milk, milk soap, and the water soluble liquids) to 1.47 (for olive oil and glycerine). The measured parameters are shown in Table 2 . We quantitatively evaluate the quality of the recovered scattering parameters in two ways. First, we report the fitting error, which is the average L 2 image difference between input images and the corresponding images rendered with the recovered parameters, normalized by the L 2 -norms of the input images. Second, we compute a measure of generalization error by: i) using the recovered parameters to render laser-illumination images with different sample widths and lighting directions; and ii) comparing these simulated images to captured photographs in these same novel configurations. For the novel configurations, we use lighting angles ? f , ? b ? {10 ? , 20 ? , 30 ? } and glass cells with widths w ? {2.5, 5 mm}. The generalization error for each material is reported as the average relative L 2 image difference over the set of all novel configurations. As shown in the right two columns of Table 2 , fitting errors are less than 4% and generalization errors below 5%. Figure 9 shows the measured phase functions, each superimposed with an HG phase functions whose g-value is equal to the average cosine of the phase function we measure. Some of these phase functions are well approximated by the HG model but others, including hand cream, liquid clay, and mixed soap, are not. This set of tabulated phase functions is available at the project website. As qualitative evaluation, Figure 1 -right shows an image rendered with our recovered material parameters under natural lighting. From left to right, are milk soap and glycerine soap (top and bottom, respectively), olive oil, blue curacao, and reduced milk. The soap geometry corresponds to scanned molded cubes made of the corresponding materials. We see that the recovered material parameters successfully reproduce the color variations that are critical to the translucent appearance of these materials. This is most notable in the glycerine soap, where blue wavelengths scatter first and cause a reddish glow in the middle of the object, but it is also visible on the left edge of the milk soap and the top-right corner of the milk. A high-resotion version of Figure 1 and a visualization that highlights the color variations are shown in the Supplementary Appendix E. The scene file used for this figure is available at the project website.\n        \n      \n      \n        7 Conclusions\n        We present an optimization framework for inverting the effect of multiple-scattering to recover scattering properties of homogeneous volumes from a handful of images. The approach does not require precise isolation of single scattering, and this enables the measurement of a broader set of materials, including both solids and liquids. The optimization also incorporates a large material dictionary and thereby avoids the restrictions of low-parameter phase function models. Our analysis and experiments show that we can recover accurate physical scattering parameters for a variety of materials. Our current setup and optimization framework do not account for polarization or fluorescence phenomena. Polarization can be important for the appearance of materials with strongly polarizationdependent scattering properties or index of refraction (birefringence), such as crystalline materials. Experimentally, our optimization has been unable to find scattering parameters that match our setup?s images of microcrystalline wax, and this may be due to some combination of our simulator?s ignorance of polarization and our use of partially-polarized (laser plus fiber) light. Regarding fluorescence, we have verified that it has negligible impact on our measurements of the materials listed in Section 6. Our setup can be easily modified to measure the strongly fluorescent behavior of other materials, by including in addition to the hyperspectral camera a mechanism to control wavelength at the source side. While we proposed one possible scanning configuration, our optimization could be used to infer scattering parameters from images captured from a variety of scene geometries and incident light fields. The only requirement is that both lighting and geometry be precisely calibrated. Our setup combines the benefits of highfrequency angular lighting (for stable optimization) and precise, stable calibration (for repeatability), but it limits measurements to three wavelengths and to solids that can be cast into glass cells of thickness within an order of magnitude of the mean free path. In principle, our optimization could be applied to images of more general solid objects, but this would require enhancing our setup to also\n        ACM Transactions on Graphics, Vol. 32, No. 6, Article 162, Publication Date: November 2013\n        Inverse Volume Rendering with Material Dictionaries\n        ?\n        162:11\n        \n          \n             ? s predicted ? s measured ? s error (%) phase function error (%)\n            \n              \n                \n                   dispersion\n                   R\n                   G\n                   B\n                   R\n                   G\n                   B\n                   R\n                   G\n                   B\n                   R\n                   G\n                   B\n                \n              \n              \n                \n                   polystyrene, 200 nm\n                   17.220\n                   28.363\n                   36.517\n                   17.078\n                   28.650\n                   36.823\n                   0.825\n                   1.012\n                   0.838\n                   3.031\n                   1.143\n                   3.672\n                \n                \n                   polystyrene, 500 nm\n                   59.082\n                   79.557\n                   88.626\n                   58.431\n                   79.023\n                   88.062\n                   1.102\n                   0.671\n                   0.636\n                   3.181\n                   2.676\n                   1.359\n                \n                \n                   polystyrene, 800 nm\n                   65.757\n                   70.438\n                   68.589\n                   66.976\n                   71.544\n                   69.146\n                   1.853\n                   1.570\n                   0.812\n                   2.623\n                   2.117\n                   1.251\n                \n                \n                   Al 2 O 3 , 30 nm\n                   47.341\n                   93.389\n                   129.870\n                   48.536\n                   96.004\n                   132.695\n                   2.524\n                   2.800\n                   2.175\n                   3.712\n                   4.298\n                   3.108\n                \n              \n            \n          \n          ? s predicted ? s measured ? s error (%) phase function error (%) dispersion R G B R G B R G B R G B polystyrene, 200 nm 17.220 28.363 36.517 17.078 28.650 36.823 0.825 1.012 0.838 3.031 1.143 3.672 polystyrene, 500 nm 59.082 79.557 88.626 58.431 79.023 88.062 1.102 0.671 0.636 3.181 2.676 1.359 polystyrene, 800 nm 65.757 70.438 68.589 66.976 71.544 69.146 1.853 1.570 0.812 2.623 2.117 1.251 Al 2 O 3 , 30 nm 47.341 93.389 129.870 48.536 96.004 132.695 2.524 2.800 2.175 3.712 4.298 3.108\n          Table 1: Measurements of validation materials (controlled nano-dispersions). Values for ? s are reported in mm ?1 . Phase function error is given as L 2 difference normalized by the L 2 -norm of the reference phase function. All four validation materials have negligible absorption, resulting on both the predicted and measured values for ? t to agree with those we report for ? s to the third decimal.\n        \n        nm 200\n        \n          \n        \n        polystyrene,\n        \n          \n          \n        \n        nm 500\n        \n          \n        \n        polystyrene,\n        \n          \n          \n        \n        nm 800 polystyrene,\n        \n          \n          \n          \n        \n        nm 30 , 3 O 2 Al\n        \n          \n          \n          \n        \n        phase function captured dictionary fit\n        \n          Figure 8: Measurements of validation materials (controlled nano-dispersions). Left: For each material, we show for the green wavelength the theoretically predicted (dashed orange) and recovered (purple) phase functions, as well as the best Henyey-Greenstein (green) phase function fit. The recovered phase functions are in close agreement with the correct ones and the purple and orange curves tightly overlap. As another visualization, we show the images for a novel configuration: under frontal collimated laser illumination (? f = 25 ? , ? o = 0 ? ). We compare our phase function and the best Henyey-Greenstein fit (images are color-mapped for better visualization). The rightmost column shows a crossection through the captured and re-rendered images for this configuration.\n        \n        recover the object shape and its surface microstructure (BSDF).\n        In addition, combinations of our optimization framework with more sophisticated imaging configurations could improve the optimization?s stability and convergence rate. In particular, it may be fruitful to apply our optimization to images captured with high-frequency illumination [Mukaigawa et al. 2010], basis illumination [Ghosh et al. 2007], adaptive illumination [O?Toole and Kutulakos 2010], or transient imaging [Wu et al. 2012]. It is also possible that optimization schemes like ours will allow exploiting such imaging modalities to solve more challenging inverse problems, such as measuring heterogeneous scattering media.\n        \n          \n          \n          \n          \n          \n          \n          \n          \n        \n        HG fit cross section\n      \n      \n        Acknowledgments\n        Funding provided by the National Science Foundation (awards IIS1161564, IIS-1012454, IIS-1212928, and IIS-1011919), the European Research Council, the Binational Science Foundation, Intel ICRI-CI, and Amazon Web Services in Education grant awards. We thank Henry W. Sarkas at Nanophase Technologies Corporation for donating material samples and calibration data.\n      \n      \n        References\n        \n          A NTYUFEEV , V. 2000. Monte Carlo method for solving inverse problems of radiation transfer, vol. 20. Inverse and Ill-Posed\n        \n        ACM Transactions on Graphics, Vol. 32, No. 6, Article 162, Publication Date: November 2013\n        162:12\n        ?\n        I. Gkioulekas et al.\n        \n          \n            \n              \n                \n                   material\n                  \n                   ? ? s s\n                  \n                  \n                   ? ? a a\n                  \n                  \n                   first moment\n                  \n                   fitting\n                   generalization\n                \n              \n              \n                \n                  \n                   R R\n                   G G\n                   B B\n                   R R\n                   G G\n                   B\n                   R\n                   G\n                   B\n                   error (%)\n                   error (%)\n                \n                \n                   whole whole milk milk\n                   100.920 100.920\n                   105.345 105.345\n                   102.768 102.768\n                   0.013 0.013\n                   0.013 0.013\n                   0.041\n                   0.954\n                   0.963\n                   0.946\n                   2.0460\n                   3.6344\n                \n                \n                   reduced reduced milk milk\n                   57.291 57.291\n                   62.460 62.460\n                   63.757 63.757\n                   0.007 0.007\n                   0.007 0.007\n                   0.024\n                   0.954\n                   0.957\n                   0.942\n                   1.346\n                   2.039\n                \n                \n                   mustard mustard\n                   16.447 16.447\n                   18.536 18.536\n                   6.457 6.457\n                   0.057 0.057\n                   0.061 0.061\n                   0.451\n                   0.155\n                   0.173\n                   0.351\n                   3.377\n                   4.201\n                \n                \n                   shampoo shampoo\n                   8.111 8.111\n                   9.919 9.919\n                   10.575 10.575\n                   0.178 0.178\n                   0.328 0.328\n                   0.439\n                   0.907\n                   0.882\n                   0.874\n                   3.962\n                   4.752\n                \n                \n                   hand hand cream cream\n                   20.820 20.820\n                   32.353 32.353\n                   41.798 41.798\n                   0.011 0.011\n                   0.011 0.011\n                   0.012\n                   0.188\n                   0.247\n                   0.265\n                   2.652\n                   3.221\n                \n                \n                   liquid liquid clay clay\n                   37.544 37.544\n                   48.250 48.250\n                   67.949 67.949\n                   0.004 0.004\n                   0.004 0.004\n                   0.005\n                   0.312\n                   0.442\n                   0.512\n                   3.431\n                   4.532\n                \n                \n                   milk milk soap soap\n                   7,625 7,625\n                   8.004 8.004\n                   8.557 8.557\n                   0.003 0.003\n                   0.004 0.004\n                   0.015\n                   0.164\n                   0.167\n                   0.155\n                   1.895\n                   2.956\n                \n                \n                   mixed mixed soap soap\n                   3.923 3.923\n                   4.018 4.018\n                   4.351 4.351\n                   0.003 0.003\n                   0.005 0.005\n                   0.013\n                   0.330\n                   0.322\n                   0.316\n                   1.474\n                   3.316\n                \n                \n                   glycerine glycerine soap soap\n                   0.201 0.201\n                   0.202 0.202\n                   0.221 0.221\n                   0.001 0.001\n                   0.001 0.001\n                   0.002\n                   0.955\n                   0.949\n                   0.943\n                   3.840\n                   3.920\n                \n                \n                   robitussin robitussin\n                   0.009 0.009\n                   0.001 0.001\n                   0.001 0.001\n                   0.012 0.012\n                   0.197 0.197\n                   0.234\n                   0.906\n                   0.977\n                   0.980\n                   1.379\n                   3.998\n                \n                \n                   coffee coffee\n                   0.054 0.054\n                   0.051 0.051\n                   0.049 0.049\n                   0.275 0.275\n                   0.309 0.309\n                   0.406\n                   0.911\n                   0.899\n                   0.906\n                   1.957\n                   2.199\n                \n                \n                   olive olive oil oil\n                   0.041 0.041\n                   0.039 0.039\n                   0.012 0.012\n                   0.062 0.062\n                   0.047 0.047\n                   0.353\n                   0.946\n                   0.954\n                   0.975\n                   2.287\n                   3.846\n                \n                \n                   blue blue curacao curacao\n                   0.010 0.010\n                   0.012 0.012\n                   0.021 0.021\n                   0.083 0.083\n                   0.048 0.048\n                   0.011\n                   0.955\n                   0.973\n                   0.979\n                   2.704\n                   4.857\n                \n                \n                   red red wine wine\n                   0.015 0.015\n                   0.013 0.013\n                   0.011 0.011\n                   0.122 0.122\n                   0.351 0.351\n                   0.402\n                   0.947\n                   0.975\n                   0.977\n                   3.034\n                   3.192\n                \n              \n            \n          \n          ? s ? a first moment fitting generalization material R G B R G B R G B error (%) error (%) whole milk 100.920 105.345 102.768 0.013 0.013 0.041 0.954 0.963 0.946 2.0460 3.6344 reduced milk 57.291 62.460 63.757 0.007 0.007 0.024 0.954 0.957 0.942 1.346 2.039 mustard 16.447 18.536 6.457 0.057 0.061 0.451 0.155 0.173 0.351 3.377 4.201 shampoo 8.111 9.919 10.575 0.178 0.328 0.439 0.907 0.882 0.874 3.962 4.752 hand cream 20.820 32.353 41.798 0.011 0.011 0.012 0.188 0.247 0.265 2.652 3.221 liquid clay 37.544 48.250 67.949 0.004 0.004 0.005 0.312 0.442 0.512 3.431 4.532 milk soap 7,625 8.004 8.557 0.003 0.004 0.015 0.164 0.167 0.155 1.895 2.956 mixed soap 3.923 4.018 4.351 0.003 0.005 0.013 0.330 0.322 0.316 1.474 3.316 glycerine soap 0.201 0.202 0.221 0.001 0.001 0.002 0.955 0.949 0.943 3.840 3.920 robitussin 0.009 0.001 0.001 0.012 0.197 0.234 0.906 0.977 0.980 1.379 3.998 coffee 0.054 0.051 0.049 0.275 0.309 0.406 0.911 0.899 0.906 1.957 2.199 olive oil 0.041 0.039 0.012 0.062 0.047 0.353 0.946 0.954 0.975 2.287 3.846 blue curacao 0.010 0.012 0.021 0.083 0.048 0.011 0.955 0.973 0.979 2.704 4.857 red wine 0.015 0.013 0.011 0.122 0.351 0.402 0.947 0.975 0.977 3.034 3.192\n          Table 2: Scattering parameters of materials measured using our proposed acquisition setup and inversion algorithm. Values for ? s and ? a are reported in mm ?1 . The average cosine of the measured phase functions is reported, while the entire phase functions are shown in\n        \n        the fitting and novel captured images respectively.\n        \n          \n          \n          \n        \n        whole milk reduced milk mustard\n        \n          \n          \n          \n        \n        liquid clay milk soap mixed soap\n        \n          \n          \n          \n        \n        coffee olive oil blue curacao\n        \n          Figure 9: Phase functions of materials measured using our acquisition setup (purple), contrasted with the closest HG phase function (dashed green). See Table 2 for numerical values.\n        \n        Problems Series, V.S.P. International Science. B AL , G. 2009. Inverse transport theory and applications. Inverse Problems 25, 5. B EN -A RTZI , A., E GAN , K., D URAND , F., AND R AMAMOORTHI , R. 2008. A precomputed polynomial representation for interactive BRDF editing with global illumination. ACM Trans. Graph. 27, 2. B HATE , N., AND T OKUTA , A. 1992. Photorealistic volume rendering of media with directional scattering. In Third Eurographics Workshop on Rendering. B OHREN , C., AND H UFFMAN , D. 1983. Absorption and scattering of light by small particles. Wiley-Vch. B OTTOU , L., AND B OUSQUET , O. 2008. The Tradeoffs of Large Scale Learning. NIPS. C HANDRASEKHAR , S. 1960. Radiative transfer. Dover. C HEN , C., L U , J., D ING , H., J ACOBS , K., D U , Y., H U , X., ET AL . 2006. A primary method for determination of optical pa-\n        \n          \n          \n        \n        shampoo hand cream\n        \n          \n          \n        \n        glycerine soap robitussin\n        \n          \n        \n        red wine\n        rameters of turbid samples and application to intralipid between 550 and 1630 nm. Optics Express 14, 16. D EBEVEC , P., H AWKINS , T., T CHOU , C., D UIKER , H., S AROKIN , W., AND S AGAR , M. 2000. Acquiring the reflectance field of a human face. In Proceedings of SIGGRAPH 2000, Annual Conference Series.\n        D ONNER , C., AND J ENSEN , H. 2005. Light diffusion in multilayered translucent materials. ACM Trans. Graph. 24, 3.  D ONNER , C., W EYRICH , T., D ?E ON , E., R AMAMOORTHI , R., AND R USINKIEWICZ , S. 2008. A layered, heterogeneous reflectance model for acquiring and rendering human skin. ACM Trans. Graph. 27, 5.\n        D UCHI , J., S HALEV -S HWARTZ , S., S INGER , Y., AND C HANDRA , T. 2008. Efficient projections onto the l 1 -ball for learning in high dimensions. ICML. D UTR ? , P., B ALA , K., AND B EKAERT , P. 2006. Advanced global illumination. AK Peters, Ltd.\n        ACM Transactions on Graphics, Vol. 32, No. 6, Article 162, Publication Date: November 2013\n        Inverse Volume Rendering with Material Dictionaries\n        ?\n        162:13\n        F LEMING , R., AND B ULTHOFF  ? , H. 2005. Low-level image cues in the perception of translucent materials. ACM Transactions on Applied Perception (TAP) 2, 3. F RISVAD , J., C HRISTENSEN , N., AND J ENSEN , H. 2007. Computing the scattering properties of participating media using lorenz-mie theory. ACM Trans. Graph. 26, 3.\n        F UCHS , C., C HEN , T., G OESELE , M., T HEISEL , H., AND S EI DEL , H. 2007. Density estimation for dynamic volumes. Computers & Graphics 31, 2. G HOSH , A., A CHUTHA , S., H EIDRICH , W., AND O?T OOLE , M. 2007. BRDF acquisition with basis illumination. IEEE CVPR.\n        G KIOULEKAS , I., X IAO , B., Z HAO , S., A DELSON , E., Z ICKLER , T., AND B ALA , K. 2013. Understanding the role of phase function in translucent appearance. To appear in ACM Trans. Graph. 32, 5.\n        G OESELE , M., L ENSCH , H., L ANG , J., F UCHS , C., AND S EIDEL , H. 2004. Disco: acquisition of translucent objects. ACM Trans. Graph. 23, 3.\n        G U , J., N AYAR , S., G RINSPUN , E., B ELHUMEUR , P., AND R A MAMOORTHI , R. 2008. Compressive structured light for recovering inhomogeneous participating media. ECCV. G UPTA , M., A GRAWAL , A., V EERARAGHAVAN , A., AND N ARASIMHAN , S. 2011. Structured light 3D scanning in the presence of global illumination. IEEE CVPR. H ASINOFF , S., D URAND , F., AND F REEMAN , W. 2010. Noiseoptimal capture for high dynamic range photography. IEEE CVPR.\n        H AWKINS , T., E INARSSON , P., AND D EBEVEC , P. 2005. Acquisition of time-varying participating media. ACM Trans. Graph. 24, 3. H ENYEY , L., AND G REENSTEIN , J. 1941. Diffuse radiation in the galaxy. The Astrophysical Journal 93.\n        H OLROYD , M., AND L AWRENCE , J. 2011. An analysis of using high-frequency sinusoidal illumination to measure the 3d shape of translucent objects. IEEE CVPR. H ULLIN , B., F UCHS , M., A JDIN , B., I HRKE , I., S EIDEL , H., AND L ENSCH , H. 2008. Direct visualization of real-world light transport. Vision, Modeling, and Visualization 2008.\n        I SHIMARU , A. 1978. Wave propagation and scattering in random media. Wiley-IEEE. J ENSEN , H., M ARSCHNER , S., L EVOY , M., AND H ANRAHAN , P. 2001. A practical model for subsurface light transport. In Proceedings of SIGGRAPH 2001, Annual Conference Series. J ENSEN , H. 2001. Realistic image synthesis using photon mapping. AK Peters, Ltd. J OHNSON , C., AND G ABRIEL , D. 1994. Laser light scattering. Dover.\n        L AWRENCE , J., B EN -A RTZI , A., D E C ORO , C., M ATUSIK , W., P FISTER , H., R AMAMOORTHI , R., AND R USINKIEWICZ , S. 2006. Inverse shade trees for non-parametric material representation and editing. ACM Trans. Graph. 25, 3.\n        L E V EQUE , R. 2007. Finite Difference Methods for Ordinary and Partial Differential Equations, Steady-State and TimeDependent Problems. SIAM.\n        M C C ORMICK , N., AND S ANCHEZ , R. 1981. Inverse problem transport calculations for anisotropic scattering coefficients. Journal of Mathematical Physics 22, 199. M ISHCHENKO , M., T RAVIS , L., AND L ACIS , A. 2006. Multiple scattering of light by particles: radiative transfer and coherent backscattering. Cambridge University. M UKAIGAWA , Y., Y AGI , Y., AND R ASKAR , R. 2010. Analysis of light transport in scattering media. IEEE CVPR. N ARASIMHAN , S., G UPTA , M., D ONNER , C., R AMAMOORTHI , R., N AYAR , S., AND J ENSEN , H. 2006. Acquiring scattering properties of participating media by dilution. ACM Trans. Graph. 25, 3. N AYAR , S., K RISHNAN , G., G ROSSBERG , M., AND R ASKAR , R. 2006. Fast separation of direct and global components of a scene using high frequency illumination. ACM Trans. Graph. 25, 3. O?T OOLE , M., AND K UTULAKOS , K. N. 2010. Optical computing for fast light transport analysis. ACM Trans. Graph. 29, 6. P EERS , P., VOM B ERGE , K., M ATUSIK , W., R AMAMOORTHI , R., L AWRENCE , J., R USINKIEWICZ , S., AND D UTR ? , P. 2006. A compact factored representation of heterogeneous subsurface scattering. ACM Trans. Graph. 25, 3. P INE , D., W EITZ , D., Z HU , J., AND H ERBOLZHEIMER , E. 1990. Diffusing-wave spectroscopy: dynamic light scattering in the multiple scattering limit. Journal de Physique 51, 18. P RAHL , S., VAN G EMERT , M., AND W ELCH , A. 1993. Determining the optical properties of turbid media by using the adding? doubling method. Applied optics 32, 4. P USEY , P. 1999. Suppression of multiple scattering by photon cross-correlation techniques. Current opinion in colloid & interface science 4, 3. R AMAMOORTHI , R., AND H ANRAHAN , P. 2001. A signalprocessing framework for inverse rendering. In Proceedings of SIGGRAPH 2001, Annual Conference Series. R EYNOLDS , L., AND M C C ORMICK , N. 1980. Approximate twoparameter phase function for light scattering. JOSA 70, 10. R USHMEIER , H., AND T ORRANCE , K. 1987. The zonal method for calculating light intensities in the presence of a participating medium. In Computer Graphics, vol. 21. S INGER , J., G R UNBAUM  ? , F., K OHN , P., Z UBELLI , J., ET AL . 1990. Image reconstruction of the interior of bodies that diffuse radiation. Science 248, 4958. T ONG , X., W ANG , J., L IN , S., G UO , B., AND S HUM , H. 2005. Modeling and rendering of quasi-homogeneous materials. ACM Trans. Graph. 24, 3. W ANG , J., Z HAO , S., T ONG , X., L IN , S., L IN , Z., D ONG , Y., G UO , B., AND S HUM , H. 2008. Modeling and rendering of heterogeneous translucent materials using the diffusion equation. ACM Trans. Graph. 27, 1. W U , D., O?T OOLE , M., V ELTEN , A., A GRAWAL , A., AND R ASKAR , R. 2012. Decomposing global light transport using time of flight imaging. IEEE CVPR. W YMAN , D., P ATTERSON , M., AND W ILSON , B. 1989. Similarity relations for the interaction parameters in radiation transport. Applied optics 28, 24.\n        ACM Transactions on Graphics, Vol. 32, No. 6, Article 162, Publication Date: November 2013\n      \n    \n  ",
  "resources" : [ ]
}